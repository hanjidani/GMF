==========================================
SLURM_JOB_ID = 10925
SLURM_NODELIST = pascal-node10.l3s.intra
==========================================
==========================================
Mixed-Experts Alpha Ablation (Full Eval) Experiment 6: multiplicativeAddition fusion, alpha=0.5
SLURM_JOB_ID = 
SLURM_NODELIST = 
Alpha: 0.5
Augmentation: CutMix (α=1.0) + Label Smoothing (0.1) + Grad Clip (1.0)
No LR schedulers (fixed LR); Full evaluation enabled
==========================================
Starting MIXED EXPERTS multiplicativeAddition fusion training (alpha-ablation, full evaluation, no schedulers)...
Alpha: 0.5
Checkpoint directory: ../../expert_training/scripts/checkpoints_expert_iid
Output directory: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0
Using device: cuda
Loading heterogeneous expert backbones (DenseNet121, ResNet18, WRN-28-10, PreAct-ResNeXt-29 8x64d)...
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:125: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(checkpoint_path, map_location=device)
Successfully loaded 4 heterogeneous experts
Loading baseline DenseNet model from: ../../expert_training/scripts/checkpoints_expert_full_dataset_benchmark_250/best_full_dataset_densenet121_benchmark_250.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_densenet_fusions.py:95: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location=device)
Creating Mixed-Experts MCN fusion model (adapting features to 1024)...
✅ Successfully created Mixed-Experts MCN fusion model
Files already downloaded and verified

============================================================
PRE-TRAINING: Clean Test Evaluation of Each Expert (CIFAR-100)
============================================================
  Expert 0 Clean Test: Acc=74.76% Loss=1.0872
  Expert 1 Clean Test: Acc=71.10% Loss=1.3230
  Expert 2 Clean Test: Acc=78.18% Loss=1.0137
  Expert 3 Clean Test: Acc=76.20% Loss=1.1990

================================================================================
PHASE 1: PRE-TRAINING EVALUATION (α=0.5)
================================================================================

============================================================
PRE-TRAINING: Gaussian Noise Robustness
============================================================

Testing Expert 0 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: σ=0.0: 74.76%, σ=0.05: 68.02%, σ=0.1: 48.66%, σ=0.2: 17.68%, σ=0.3: 7.98%

Testing Expert 1 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: σ=0.0: 71.10%, σ=0.05: 64.46%, σ=0.1: 43.69%, σ=0.2: 13.79%, σ=0.3: 5.72%

Testing Expert 2 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: σ=0.0: 78.18%, σ=0.05: 74.99%, σ=0.1: 62.87%, σ=0.2: 32.09%, σ=0.3: 14.35%

Testing Expert 3 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: σ=0.0: 76.20%, σ=0.05: 72.96%, σ=0.1: 65.20%, σ=0.2: 42.36%, σ=0.3: 23.19%

Testing Baseline DenseNet (PRE-TRAINING) under Gaussian noise...
  Baseline noise results: σ=0.0: 83.69%, σ=0.05: 76.31%, σ=0.1: 56.45%, σ=0.2: 27.45%, σ=0.3: 15.89%

============================================================
PRE-TRAINING: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 30.10% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.26% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 6.26% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 43.55% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 70.43% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 61.42% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 54.26% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 41.59% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 74.65% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 74.52% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.64% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 21.78% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 44.43% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.42% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 43.56% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 15.05% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.42% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.45% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 74.41% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 74.04% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 74.53% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 74.27% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 74.36% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 73.73% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 34.62% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 18.02% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 74.63% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 74.80% accuracy

Testing Expert 1 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 26.26% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 11.78% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 1.34% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 4.41% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 41.66% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 14.24% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 49.71% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 37.21% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 71.38% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 70.75% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 51.81% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 22.25% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 41.42% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 14.78% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 40.92% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 12.61% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.03% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.54% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 71.01% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 70.43% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 70.86% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 70.69% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 69.91% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 67.60% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 24.11% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 11.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 71.16% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 71.28% accuracy

Testing Expert 2 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 46.74% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 26.53% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.35% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 26.82% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 65.96% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 49.30% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 66.25% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 57.10% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 78.38% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 78.27% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 48.34% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.52% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 59.39% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 27.86% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 59.65% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 27.99% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 8.61% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.57% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 78.11% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 77.95% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 78.20% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.92% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 77.75% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.77% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 48.90% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 30.15% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 78.05% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 78.19% accuracy

Testing Expert 3 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 53.79% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 37.21% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.24% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 33.41% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 71.90% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 57.74% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.17% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 61.63% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 76.52% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 76.17% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 41.64% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 15.57% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 62.98% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.83% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 63.52% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 39.73% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 14.86% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.19% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.23% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 75.74% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.03% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 75.67% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 75.51% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 74.65% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 49.79% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 40.57% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 76.04% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.20% accuracy

Testing Baseline DenseNet (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 39.47% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.02% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 10.19% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 52.47% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 79.06% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 69.45% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 61.46% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 50.11% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 83.25% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 82.94% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 60.76% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 25.22% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 51.81% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.20% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 52.52% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 24.13% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 11.10% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.71% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 83.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 83.18% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 83.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 83.32% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 83.15% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 82.38% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 43.60% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.61% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 83.41% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 83.53% accuracy

============================================================
PRE-TRAINING: Out-of-Distribution Detection
============================================================

Testing Expert 0 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 1 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 2 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 3 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Baseline DenseNet (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

✅ PRE-TRAINING evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicativeAddition_alpha_0.5_pre_training_evaluation.csv

================================================================================
PHASE 2: FUSION TRAINING (α=0.5)
================================================================================
Loading data splits for fusion training...
Files already downloaded and verified
Loaded 10000 fusion holdout samples for training.
✅ Using SOTA augmentation: DenseNet with moderate augmentation for stability
Files already downloaded and verified
Files already downloaded and verified
Using 10000 samples from the official test set for validation.
✅ Data splits loaded successfully
CSV logging setup: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicativeAddition_alpha_0.5_training_log.csv
  - Experiment Output: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition

🚀 Starting Mixed-Experts multiplicativeAddition fusion training with alpha=0.5 (no schedulers)...
   Augmentation: CUTMIX, MixUp α=0.2, CutMix α=1.0, Label Smoothing=0.1, Grad Clip=1.0
Total parameters: 92,712,648
Trainable parameters: 92,712,648
Epoch 1/40, Batch 0/79, Loss: 10.8973 (Global: 4.6141, Individual: 12.5665)
Epoch 1/40, Batch 50/79, Loss: 6.1102 (Global: 2.0690, Individual: 8.0823)
  🔸 Saved new best Expert 0 (test acc 74.81%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 70.21%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 2 (test acc 78.07%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
  🔸 Saved new best Expert 3 (test acc 77.21%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_3_best.pth
Epoch 1/40:
  Train Loss: 8.6036, Train Acc: 43.76%
  Val   Loss: 3.2034, Val   Acc: 77.92%
  Test Accuracies: Global: 77.96% | Expert 0: 74.81%, Expert 1: 70.21%, Expert 2: 78.07%, Expert 3: 77.21%
  🔸 Saved new best Fusion Module (test acc 77.96%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 77.96%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 77.96%
Epoch 2/40, Batch 0/79, Loss: 9.2020 (Global: 3.1490, Individual: 12.1060)
Epoch 2/40, Batch 50/79, Loss: 6.2132 (Global: 2.0354, Individual: 8.3556)
  🔸 Saved new best Expert 0 (test acc 75.28%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 71.06%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 2 (test acc 78.42%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
  🔸 Saved new best Expert 3 (test acc 77.48%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_3_best.pth
Epoch 2/40:
  Train Loss: 8.0384, Train Acc: 55.35%
  Val   Loss: 3.0956, Val   Acc: 79.47%
  Test Accuracies: Global: 79.49% | Expert 0: 75.28%, Expert 1: 71.06%, Expert 2: 78.42%, Expert 3: 77.48%
  🔸 Saved new best Fusion Module (test acc 79.49%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 79.49%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 79.49%
Epoch 3/40, Batch 0/79, Loss: 8.3518 (Global: 2.6952, Individual: 11.3132)
Epoch 3/40, Batch 50/79, Loss: 7.4516 (Global: 2.4088, Individual: 10.0858)
  🔸 Saved new best Expert 0 (test acc 75.62%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 71.28%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 2 (test acc 78.50%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
Epoch 3/40:
  Train Loss: 7.8466, Train Acc: 58.26%
  Val   Loss: 3.0444, Val   Acc: 79.55%
  Test Accuracies: Global: 79.53% | Expert 0: 75.62%, Expert 1: 71.28%, Expert 2: 78.50%, Expert 3: 76.90%
  🔸 Saved new best Fusion Module (test acc 79.53%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 79.53%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 79.53%
Epoch 4/40, Batch 0/79, Loss: 8.6932 (Global: 2.8106, Individual: 11.7653)
Epoch 4/40, Batch 50/79, Loss: 8.2633 (Global: 2.6736, Individual: 11.1793)
  🔸 Saved new best Expert 0 (test acc 75.94%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 71.66%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 2 (test acc 78.95%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
Epoch 4/40:
  Train Loss: 7.9612, Train Acc: 54.44%
  Val   Loss: 3.1431, Val   Acc: 79.38%
  Test Accuracies: Global: 79.36% | Expert 0: 75.94%, Expert 1: 71.66%, Expert 2: 78.95%, Expert 3: 76.39%
  📊 Training progress logged to CSV
Epoch 5/40, Batch 0/79, Loss: 9.0002 (Global: 2.9150, Individual: 12.1704)
Epoch 5/40, Batch 50/79, Loss: 8.6911 (Global: 2.8441, Individual: 11.6939)
  🔸 Saved new best Expert 1 (test acc 71.90%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 5/40:
  Train Loss: 7.8568, Train Acc: 54.84%
  Val   Loss: 3.0901, Val   Acc: 79.46%
  Test Accuracies: Global: 79.47% | Expert 0: 75.90%, Expert 1: 71.90%, Expert 2: 78.51%, Expert 3: 76.83%
  📊 Training progress logged to CSV
Epoch 6/40, Batch 0/79, Loss: 6.5176 (Global: 2.0283, Individual: 8.9786)
Epoch 6/40, Batch 50/79, Loss: 6.1875 (Global: 1.9186, Individual: 8.5377)
  🔸 Saved new best Expert 0 (test acc 76.17%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 72.37%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 2 (test acc 79.04%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
Epoch 6/40:
  Train Loss: 7.7572, Train Acc: 58.03%
  Val   Loss: 2.9980, Val   Acc: 79.60%
  Test Accuracies: Global: 79.59% | Expert 0: 76.17%, Expert 1: 72.37%, Expert 2: 79.04%, Expert 3: 76.81%
  🔸 Saved new best Fusion Module (test acc 79.59%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 79.59%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 79.59%
Epoch 7/40, Batch 0/79, Loss: 8.9182 (Global: 2.9034, Individual: 12.0295)
Epoch 7/40, Batch 50/79, Loss: 8.1937 (Global: 2.6098, Individual: 11.1677)
  🔸 Saved new best Expert 0 (test acc 76.22%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
Epoch 7/40:
  Train Loss: 7.5458, Train Acc: 60.63%
  Val   Loss: 3.0508, Val   Acc: 79.98%
  Test Accuracies: Global: 79.97% | Expert 0: 76.22%, Expert 1: 72.25%, Expert 2: 78.67%, Expert 3: 76.58%
  🔸 Saved new best Fusion Module (test acc 79.97%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 79.97%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 79.97%
Epoch 8/40, Batch 0/79, Loss: 8.4001 (Global: 2.7170, Individual: 11.3662)
Epoch 8/40, Batch 50/79, Loss: 7.5600 (Global: 2.3952, Individual: 10.3295)
  🔸 Saved new best Expert 0 (test acc 76.42%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 72.63%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 8/40:
  Train Loss: 7.5339, Train Acc: 60.81%
  Val   Loss: 2.9835, Val   Acc: 79.88%
  Test Accuracies: Global: 79.91% | Expert 0: 76.42%, Expert 1: 72.63%, Expert 2: 78.86%, Expert 3: 76.19%
  📊 Training progress logged to CSV
Epoch 9/40, Batch 0/79, Loss: 6.0965 (Global: 1.8885, Individual: 8.4159)
Epoch 9/40, Batch 50/79, Loss: 6.8678 (Global: 2.1392, Individual: 9.4573)
  🔸 Saved new best Expert 0 (test acc 76.60%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 72.72%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 9/40:
  Train Loss: 7.2687, Train Acc: 63.80%
  Val   Loss: 3.0169, Val   Acc: 79.75%
  Test Accuracies: Global: 79.75% | Expert 0: 76.60%, Expert 1: 72.72%, Expert 2: 78.71%, Expert 3: 75.81%
  📊 Training progress logged to CSV
Epoch 10/40, Batch 0/79, Loss: 5.1588 (Global: 1.5477, Individual: 7.2220)
Epoch 10/40, Batch 50/79, Loss: 6.5838 (Global: 2.0515, Individual: 9.0645)
Epoch 10/40:
  Train Loss: 7.4892, Train Acc: 61.28%
  Val   Loss: 3.0541, Val   Acc: 79.88%
  Test Accuracies: Global: 79.89% | Expert 0: 76.42%, Expert 1: 72.55%, Expert 2: 78.59%, Expert 3: 75.86%
  📊 Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/checkpoint_epoch_10.pth
Epoch 11/40, Batch 0/79, Loss: 7.8904 (Global: 2.4634, Individual: 10.8540)
Epoch 11/40, Batch 50/79, Loss: 8.5348 (Global: 2.6787, Individual: 11.7122)
  🔸 Saved new best Expert 1 (test acc 72.90%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 11/40:
  Train Loss: 7.5152, Train Acc: 60.33%
  Val   Loss: 2.9800, Val   Acc: 80.02%
  Test Accuracies: Global: 80.01% | Expert 0: 76.57%, Expert 1: 72.90%, Expert 2: 78.67%, Expert 3: 75.59%
  🔸 Saved new best Fusion Module (test acc 80.01%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 80.01%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 80.01%
Epoch 12/40, Batch 0/79, Loss: 8.5892 (Global: 2.7342, Individual: 11.7100)
Epoch 12/40, Batch 50/79, Loss: 7.6836 (Global: 2.3319, Individual: 10.7034)
Epoch 12/40:
  Train Loss: 7.3683, Train Acc: 62.30%
  Val   Loss: 3.0884, Val   Acc: 79.38%
  Test Accuracies: Global: 79.34% | Expert 0: 76.33%, Expert 1: 72.86%, Expert 2: 78.40%, Expert 3: 75.22%
  📊 Training progress logged to CSV
Epoch 13/40, Batch 0/79, Loss: 7.6687 (Global: 2.4036, Individual: 10.5302)
Epoch 13/40, Batch 50/79, Loss: 6.9423 (Global: 2.1399, Individual: 9.6046)
  🔸 Saved new best Expert 1 (test acc 73.11%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 13/40:
  Train Loss: 7.2069, Train Acc: 61.24%
  Val   Loss: 3.0538, Val   Acc: 79.42%
  Test Accuracies: Global: 79.44% | Expert 0: 76.58%, Expert 1: 73.11%, Expert 2: 78.39%, Expert 3: 75.45%
  📊 Training progress logged to CSV
Epoch 14/40, Batch 0/79, Loss: 8.2987 (Global: 2.5731, Individual: 11.4511)
Epoch 14/40, Batch 50/79, Loss: 7.2850 (Global: 2.2582, Individual: 10.0535)
  🔸 Saved new best Expert 0 (test acc 76.67%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 73.13%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 14/40:
  Train Loss: 7.3471, Train Acc: 61.76%
  Val   Loss: 3.0817, Val   Acc: 79.55%
  Test Accuracies: Global: 79.57% | Expert 0: 76.67%, Expert 1: 73.13%, Expert 2: 78.58%, Expert 3: 75.39%
  📊 Training progress logged to CSV
Epoch 15/40, Batch 0/79, Loss: 4.7579 (Global: 1.3616, Individual: 6.7927)
Epoch 15/40, Batch 50/79, Loss: 8.4615 (Global: 2.6425, Individual: 11.6380)
  🔸 Saved new best Expert 1 (test acc 73.27%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 15/40:
  Train Loss: 7.0014, Train Acc: 68.04%
  Val   Loss: 3.1065, Val   Acc: 79.26%
  Test Accuracies: Global: 79.28% | Expert 0: 76.67%, Expert 1: 73.27%, Expert 2: 78.04%, Expert 3: 75.22%
  📊 Training progress logged to CSV
Epoch 16/40, Batch 0/79, Loss: 4.7871 (Global: 1.3889, Individual: 6.7965)
Epoch 16/40, Batch 50/79, Loss: 7.3096 (Global: 2.2649, Individual: 10.0895)
  🔸 Saved new best Expert 0 (test acc 76.84%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 73.46%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 16/40:
  Train Loss: 7.0075, Train Acc: 66.63%
  Val   Loss: 3.1174, Val   Acc: 79.57%
  Test Accuracies: Global: 79.57% | Expert 0: 76.84%, Expert 1: 73.46%, Expert 2: 77.87%, Expert 3: 75.11%
  📊 Training progress logged to CSV
Epoch 17/40, Batch 0/79, Loss: 8.1022 (Global: 2.4856, Individual: 11.2332)
Epoch 17/40, Batch 50/79, Loss: 5.1158 (Global: 1.5088, Individual: 7.2141)
Epoch 17/40:
  Train Loss: 7.0833, Train Acc: 63.08%
  Val   Loss: 3.0913, Val   Acc: 79.77%
  Test Accuracies: Global: 79.77% | Expert 0: 76.67%, Expert 1: 73.22%, Expert 2: 78.30%, Expert 3: 75.31%
  📊 Training progress logged to CSV
Epoch 18/40, Batch 0/79, Loss: 7.8603 (Global: 2.4657, Individual: 10.7892)
Epoch 18/40, Batch 50/79, Loss: 6.6770 (Global: 2.0672, Individual: 9.2196)
Epoch 18/40:
  Train Loss: 7.0018, Train Acc: 66.47%
  Val   Loss: 3.1646, Val   Acc: 79.13%
  Test Accuracies: Global: 79.14% | Expert 0: 76.79%, Expert 1: 73.39%, Expert 2: 77.95%, Expert 3: 74.90%
  📊 Training progress logged to CSV
Epoch 19/40, Batch 0/79, Loss: 5.4790 (Global: 1.5909, Individual: 7.7762)
Epoch 19/40, Batch 50/79, Loss: 8.7047 (Global: 2.7702, Individual: 11.8688)
  🔸 Saved new best Expert 0 (test acc 76.89%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 73.66%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 19/40:
  Train Loss: 6.9860, Train Acc: 67.79%
  Val   Loss: 3.1423, Val   Acc: 79.31%
  Test Accuracies: Global: 79.33% | Expert 0: 76.89%, Expert 1: 73.66%, Expert 2: 77.92%, Expert 3: 75.02%
  📊 Training progress logged to CSV
Epoch 20/40, Batch 0/79, Loss: 5.4633 (Global: 1.6512, Individual: 7.6241)
Epoch 20/40, Batch 50/79, Loss: 4.8033 (Global: 1.4260, Individual: 6.7546)
  🔸 Saved new best Expert 0 (test acc 76.91%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
Epoch 20/40:
  Train Loss: 6.9193, Train Acc: 68.06%
  Val   Loss: 3.1229, Val   Acc: 79.47%
  Test Accuracies: Global: 79.48% | Expert 0: 76.91%, Expert 1: 73.58%, Expert 2: 78.11%, Expert 3: 74.61%
  📊 Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/checkpoint_epoch_20.pth

================ STAGE TRANSITION ================
Loading best expert checkpoints (by test acc) and freezing expert backbones...
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:473: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
  🔒 Expert 0 frozen (adapter remains trainable)
  🔒 Expert 1 frozen (adapter remains trainable)
  🔒 Expert 2 frozen (adapter remains trainable)
  🔒 Expert 3 frozen (adapter remains trainable)
Stage 2: Training adapters + fusion + global head only for remaining epochs.
Epoch 21/40, Batch 0/79, Loss: 4.2887 (Global: 1.2607, Individual: 6.0560)
Epoch 21/40, Batch 50/79, Loss: 8.3166 (Global: 2.6415, Individual: 11.3500)
  🔸 Saved new best Expert 0 (test acc 76.96%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
  🔸 Saved new best Expert 1 (test acc 73.72%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
  🔸 Saved new best Expert 3 (test acc 77.60%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_3_best.pth
Epoch 21/40:
  Train Loss: 7.1938, Train Acc: 63.23%
  Val   Loss: 2.8704, Val   Acc: 80.36%
  Test Accuracies: Global: 80.37% | Expert 0: 76.96%, Expert 1: 73.72%, Expert 2: 79.03%, Expert 3: 77.60%
  🔸 Saved new best Fusion Module (test acc 80.37%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 80.37%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 80.37%
Epoch 22/40, Batch 0/79, Loss: 8.1971 (Global: 2.5777, Individual: 11.2389)
Epoch 22/40, Batch 50/79, Loss: 9.2122 (Global: 2.9632, Individual: 12.4981)
Epoch 22/40:
  Train Loss: 7.4825, Train Acc: 57.82%
  Val   Loss: 2.9591, Val   Acc: 80.46%
  Test Accuracies: Global: 80.47% | Expert 0: 76.90%, Expert 1: 73.49%, Expert 2: 78.82%, Expert 3: 77.40%
  🔸 Saved new best Fusion Module (test acc 80.47%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 80.47%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 80.47%
Epoch 23/40, Batch 0/79, Loss: 8.0902 (Global: 2.5130, Individual: 11.1544)
Epoch 23/40, Batch 50/79, Loss: 7.6325 (Global: 2.4278, Individual: 10.4094)
  🔸 Saved new best Expert 2 (test acc 79.19%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
Epoch 23/40:
  Train Loss: 7.5165, Train Acc: 61.01%
  Val   Loss: 2.9589, Val   Acc: 80.29%
  Test Accuracies: Global: 80.30% | Expert 0: 76.93%, Expert 1: 73.47%, Expert 2: 79.19%, Expert 3: 77.34%
  📊 Training progress logged to CSV
Epoch 24/40, Batch 0/79, Loss: 5.9554 (Global: 1.8379, Individual: 8.2350)
Epoch 24/40, Batch 50/79, Loss: 8.2322 (Global: 2.5950, Individual: 11.2745)
Epoch 24/40:
  Train Loss: 7.3967, Train Acc: 60.88%
  Val   Loss: 2.9396, Val   Acc: 80.26%
  Test Accuracies: Global: 80.25% | Expert 0: 76.94%, Expert 1: 73.59%, Expert 2: 78.97%, Expert 3: 77.55%
  📊 Training progress logged to CSV
Epoch 25/40, Batch 0/79, Loss: 6.9015 (Global: 2.1308, Individual: 9.5415)
Epoch 25/40, Batch 50/79, Loss: 5.3518 (Global: 1.5774, Individual: 7.5488)
  🔸 Saved new best Expert 1 (test acc 73.74%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 25/40:
  Train Loss: 7.4209, Train Acc: 54.89%
  Val   Loss: 2.9471, Val   Acc: 80.22%
  Test Accuracies: Global: 80.22% | Expert 0: 76.89%, Expert 1: 73.74%, Expert 2: 78.91%, Expert 3: 77.34%
  📊 Training progress logged to CSV
Epoch 26/40, Batch 0/79, Loss: 9.3763 (Global: 3.0266, Individual: 12.6995)
Epoch 26/40, Batch 50/79, Loss: 6.6530 (Global: 2.0575, Individual: 9.1909)
  🔸 Saved new best Expert 0 (test acc 77.06%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
Epoch 26/40:
  Train Loss: 7.4642, Train Acc: 58.21%
  Val   Loss: 2.9437, Val   Acc: 80.50%
  Test Accuracies: Global: 80.53% | Expert 0: 77.06%, Expert 1: 73.72%, Expert 2: 79.07%, Expert 3: 77.35%
  🔸 Saved new best Fusion Module (test acc 80.53%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 80.53%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 80.53%
Epoch 27/40, Batch 0/79, Loss: 8.6498 (Global: 2.7413, Individual: 11.8171)
Epoch 27/40, Batch 50/79, Loss: 7.9767 (Global: 2.4945, Individual: 10.9644)
Epoch 27/40:
  Train Loss: 7.4754, Train Acc: 58.33%
  Val   Loss: 2.9759, Val   Acc: 80.50%
  Test Accuracies: Global: 80.51% | Expert 0: 76.83%, Expert 1: 73.56%, Expert 2: 79.03%, Expert 3: 77.50%
  📊 Training progress logged to CSV
Epoch 28/40, Batch 0/79, Loss: 8.3721 (Global: 2.6500, Individual: 11.4441)
Epoch 28/40, Batch 50/79, Loss: 5.3440 (Global: 1.6014, Individual: 7.4851)
  🔸 Saved new best Expert 1 (test acc 73.86%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 28/40:
  Train Loss: 7.1600, Train Acc: 64.72%
  Val   Loss: 2.8765, Val   Acc: 80.29%
  Test Accuracies: Global: 80.29% | Expert 0: 76.98%, Expert 1: 73.86%, Expert 2: 78.90%, Expert 3: 77.48%
  📊 Training progress logged to CSV
Epoch 29/40, Batch 0/79, Loss: 7.1925 (Global: 2.2165, Individual: 9.9521)
Epoch 29/40, Batch 50/79, Loss: 7.9737 (Global: 2.5495, Individual: 10.8485)
Epoch 29/40:
  Train Loss: 7.3194, Train Acc: 62.95%
  Val   Loss: 2.9114, Val   Acc: 80.45%
  Test Accuracies: Global: 80.47% | Expert 0: 76.91%, Expert 1: 73.67%, Expert 2: 79.02%, Expert 3: 77.41%
  📊 Training progress logged to CSV
Epoch 30/40, Batch 0/79, Loss: 6.9241 (Global: 2.1627, Individual: 9.5228)
Epoch 30/40, Batch 50/79, Loss: 4.4998 (Global: 1.3177, Individual: 6.3642)
  🔸 Saved new best Expert 1 (test acc 73.87%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
Epoch 30/40:
  Train Loss: 7.1539, Train Acc: 63.88%
  Val   Loss: 2.9231, Val   Acc: 80.21%
  Test Accuracies: Global: 80.21% | Expert 0: 76.80%, Expert 1: 73.87%, Expert 2: 79.02%, Expert 3: 77.33%
  📊 Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/checkpoint_epoch_30.pth
Epoch 31/40, Batch 0/79, Loss: 4.7784 (Global: 1.4503, Individual: 6.6563)
Epoch 31/40, Batch 50/79, Loss: 8.1463 (Global: 2.5594, Individual: 11.1737)
  🔸 Saved new best Expert 3 (test acc 77.63%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_3_best.pth
Epoch 31/40:
  Train Loss: 7.2973, Train Acc: 64.68%
  Val   Loss: 2.9369, Val   Acc: 80.48%
  Test Accuracies: Global: 80.49% | Expert 0: 76.93%, Expert 1: 73.78%, Expert 2: 78.76%, Expert 3: 77.63%
  📊 Training progress logged to CSV
Epoch 32/40, Batch 0/79, Loss: 8.5168 (Global: 2.6885, Individual: 11.6565)
Epoch 32/40, Batch 50/79, Loss: 5.4849 (Global: 1.6727, Individual: 7.6245)
Epoch 32/40:
  Train Loss: 7.4751, Train Acc: 62.37%
  Val   Loss: 2.9683, Val   Acc: 80.38%
  Test Accuracies: Global: 80.35% | Expert 0: 76.94%, Expert 1: 73.52%, Expert 2: 78.94%, Expert 3: 77.30%
  📊 Training progress logged to CSV
Epoch 33/40, Batch 0/79, Loss: 8.8414 (Global: 2.8318, Individual: 12.0192)
Epoch 33/40, Batch 50/79, Loss: 7.9332 (Global: 2.4826, Individual: 10.9013)
Epoch 33/40:
  Train Loss: 7.4402, Train Acc: 60.67%
  Val   Loss: 2.9204, Val   Acc: 80.36%
  Test Accuracies: Global: 80.39% | Expert 0: 76.96%, Expert 1: 73.73%, Expert 2: 79.10%, Expert 3: 77.31%
  📊 Training progress logged to CSV
Epoch 34/40, Batch 0/79, Loss: 7.0072 (Global: 2.2085, Individual: 9.5973)
Epoch 34/40, Batch 50/79, Loss: 8.5134 (Global: 2.7188, Individual: 11.5893)
Epoch 34/40:
  Train Loss: 7.3549, Train Acc: 59.58%
  Val   Loss: 2.9792, Val   Acc: 80.45%
  Test Accuracies: Global: 80.45% | Expert 0: 76.78%, Expert 1: 73.60%, Expert 2: 79.02%, Expert 3: 77.26%
  📊 Training progress logged to CSV
Epoch 35/40, Batch 0/79, Loss: 7.8491 (Global: 2.4145, Individual: 10.8693)
Epoch 35/40, Batch 50/79, Loss: 5.7243 (Global: 1.7134, Individual: 8.0218)
  🔸 Saved new best Expert 2 (test acc 79.28%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
Epoch 35/40:
  Train Loss: 7.4422, Train Acc: 58.75%
  Val   Loss: 2.9116, Val   Acc: 80.69%
  Test Accuracies: Global: 80.68% | Expert 0: 76.98%, Expert 1: 73.48%, Expert 2: 79.28%, Expert 3: 77.40%
  🔸 Saved new best Fusion Module (test acc 80.68%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_best/fusion_module_best.pth
  🔸 Saved new best Global Head (test acc 80.68%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  📊 Training progress logged to CSV
  New best global test accuracy: 80.68%
Epoch 36/40, Batch 0/79, Loss: 7.7406 (Global: 2.4391, Individual: 10.6029)
Epoch 36/40, Batch 50/79, Loss: 7.6940 (Global: 2.4186, Individual: 10.5507)
  🔸 Saved new best Expert 0 (test acc 77.08%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
Epoch 36/40:
  Train Loss: 7.1638, Train Acc: 64.02%
  Val   Loss: 2.8740, Val   Acc: 80.42%
  Test Accuracies: Global: 80.41% | Expert 0: 77.08%, Expert 1: 73.63%, Expert 2: 79.06%, Expert 3: 77.39%
  📊 Training progress logged to CSV
Epoch 37/40, Batch 0/79, Loss: 8.2039 (Global: 2.5508, Individual: 11.3062)
Epoch 37/40, Batch 50/79, Loss: 7.9714 (Global: 2.4642, Individual: 11.0143)
Epoch 37/40:
  Train Loss: 7.3123, Train Acc: 59.96%
  Val   Loss: 2.9278, Val   Acc: 80.58%
  Test Accuracies: Global: 80.58% | Expert 0: 76.92%, Expert 1: 73.52%, Expert 2: 79.12%, Expert 3: 77.49%
  📊 Training progress logged to CSV
Epoch 38/40, Batch 0/79, Loss: 7.6149 (Global: 2.3927, Individual: 10.4445)
Epoch 38/40, Batch 50/79, Loss: 8.8791 (Global: 2.8435, Individual: 12.0712)
Epoch 38/40:
  Train Loss: 7.4232, Train Acc: 60.73%
  Val   Loss: 2.9776, Val   Acc: 80.46%
  Test Accuracies: Global: 80.47% | Expert 0: 76.97%, Expert 1: 73.58%, Expert 2: 78.95%, Expert 3: 77.14%
  📊 Training progress logged to CSV
Epoch 39/40, Batch 0/79, Loss: 8.9080 (Global: 2.8701, Individual: 12.0758)
Epoch 39/40, Batch 50/79, Loss: 6.7294 (Global: 2.0786, Individual: 9.3015)
Epoch 39/40:
  Train Loss: 7.1397, Train Acc: 63.20%
  Val   Loss: 2.9232, Val   Acc: 80.32%
  Test Accuracies: Global: 80.35% | Expert 0: 77.00%, Expert 1: 73.84%, Expert 2: 78.98%, Expert 3: 77.30%
  📊 Training progress logged to CSV
Epoch 40/40, Batch 0/79, Loss: 6.5696 (Global: 2.0292, Individual: 9.0808)
Epoch 40/40, Batch 50/79, Loss: 5.4468 (Global: 1.6687, Individual: 7.5561)
Epoch 40/40:
  Train Loss: 7.2919, Train Acc: 57.99%
  Val   Loss: 2.9162, Val   Acc: 80.42%
  Test Accuracies: Global: 80.43% | Expert 0: 76.85%, Expert 1: 73.68%, Expert 2: 78.96%, Expert 3: 77.46%
  📊 Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/checkpoint_epoch_40.pth
  Saved best model: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/best_model.pth
✅ Training completed! Best validation accuracy: 80.68%

💾 Saving trained model components...
  Saved expert 0: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts/expert_0_alpha_0.5.pth
  Saved expert 1: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts/expert_1_alpha_0.5.pth
  Saved expert 2: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts/expert_2_alpha_0.5.pth
  Saved expert 3: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts/expert_3_alpha_0.5.pth
  Saved fusion module: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_module/fusion_module_alpha_0.5.pth
  Saved global head: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_head/global_head_alpha_0.5.pth
  Saved complete model: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/complete_model/complete_fusion_model_alpha_0.5.pth
✅ All model components saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition
  - Experts: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts
  - Fusion: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/fusion_module
  - Global: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_head
  - Complete: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/complete_model
✅ Model components saved successfully

================================================================================
CLEAN TEST-SET EVALUATION (Best Experts + Best Global Head)
================================================================================
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:878: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
🔄 Loaded best Expert 0 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_0_best.pth
🔄 Loaded best Expert 1 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_1_best.pth
🔄 Loaded best Expert 2 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_2_best.pth
🔄 Loaded best Expert 3 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/experts_best/expert_3_best.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:893: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(best_global_head_path, map_location=device)
🔄 Loaded best Global Head for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_0.5/multiplicativeAddition/global_best/global_head_best.pth
  Clean Test Accuracy (best experts + best head): 80.65% | Loss: 0.8364

================================================================================
PHASE 3: POST-TRAINING EVALUATION (α=0.5)
================================================================================
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:933: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
⚠️  Failed to load best expert checkpoints; using current weights. Error: Error(s) in loading state_dict for DenseNet:
	Missing key(s) in state_dict: "features.0.weight", "features.1.weight", "features.1.bias", "features.1.running_mean", "features.1.running_var", "features.denseblock1.dense_block.0.dense_layer.0.weight", "features.denseblock1.dense_block.0.dense_layer.0.bias", "features.denseblock1.dense_block.0.dense_layer.0.running_mean", "features.denseblock1.dense_block.0.dense_layer.0.running_var", "features.denseblock1.dense_block.0.dense_layer.2.weight", "features.denseblock1.dense_block.0.dense_layer.3.weight", "features.denseblock1.dense_block.0.dense_layer.3.bias", "features.denseblock1.dense_block.0.dense_layer.3.running_mean", "features.denseblock1.dense_block.0.dense_layer.3.running_var", "features.denseblock1.dense_block.0.dense_layer.5.weight", "features.denseblock1.dense_block.1.dense_layer.0.weight", "features.denseblock1.dense_block.1.dense_layer.0.bias", "features.denseblock1.dense_block.1.dense_layer.0.running_mean", "features.denseblock1.dense_block.1.dense_layer.0.running_var", "features.denseblock1.dense_block.1.dense_layer.2.weight", "features.denseblock1.dense_block.1.dense_layer.3.weight", "features.denseblock1.dense_block.1.dense_layer.3.bias", "features.denseblock1.dense_block.1.dense_layer.3.running_mean", "features.denseblock1.dense_block.1.dense_layer.3.running_var", "features.denseblock1.dense_block.1.dense_layer.5.weight", "features.denseblock1.dense_block.2.dense_layer.0.weight", "features.denseblock1.dense_block.2.dense_layer.0.bias", "features.denseblock1.dense_block.2.dense_layer.0.running_mean", "features.denseblock1.dense_block.2.dense_layer.0.running_var", "features.denseblock1.dense_block.2.dense_layer.2.weight", "features.denseblock1.dense_block.2.dense_layer.3.weight", "features.denseblock1.dense_block.2.dense_layer.3.bias", "features.denseblock1.dense_block.2.dense_layer.3.running_mean", "features.denseblock1.dense_block.2.dense_layer.3.running_var", "features.denseblock1.dense_block.2.dense_layer.5.weight", "features.denseblock1.dense_block.3.dense_layer.0.weight", "features.denseblock1.dense_block.3.dense_layer.0.bias", "features.denseblock1.dense_block.3.dense_layer.0.running_mean", "features.denseblock1.dense_block.3.dense_layer.0.running_var", "features.denseblock1.dense_block.3.dense_layer.2.weight", "features.denseblock1.dense_block.3.dense_layer.3.weight", "features.denseblock1.dense_block.3.dense_layer.3.bias", "features.denseblock1.dense_block.3.dense_layer.3.running_mean", "features.denseblock1.dense_block.3.dense_layer.3.running_var", "features.denseblock1.dense_block.3.dense_layer.5.weight", "features.denseblock1.dense_block.4.dense_layer.0.weight", "features.denseblock1.dense_block.4.dense_layer.0.bias", "features.denseblock1.dense_block.4.dense_layer.0.running_mean", "features.denseblock1.dense_block.4.dense_layer.0.running_var", "features.denseblock1.dense_block.4.dense_layer.2.weight", "features.denseblock1.dense_block.4.dense_layer.3.weight", "features.denseblock1.dense_block.4.dense_layer.3.bias", "features.denseblock1.dense_block.4.dense_layer.3.running_mean", "features.denseblock1.dense_block.4.dense_layer.3.running_var", "features.denseblock1.dense_block.4.dense_layer.5.weight", "features.denseblock1.dense_block.5.dense_layer.0.weight", "features.denseblock1.dense_block.5.dense_layer.0.bias", "features.denseblock1.dense_block.5.dense_layer.0.running_mean", "features.denseblock1.dense_block.5.dense_layer.0.running_var", "features.denseblock1.dense_block.5.dense_layer.2.weight", "features.denseblock1.dense_block.5.dense_layer.3.weight", "features.denseblock1.dense_block.5.dense_layer.3.bias", "features.denseblock1.dense_block.5.dense_layer.3.running_mean", "features.denseblock1.dense_block.5.dense_layer.3.running_var", "features.denseblock1.dense_block.5.dense_layer.5.weight", "features.transition1.transition_layer.0.weight", "features.transition1.transition_layer.0.bias", "features.transition1.transition_layer.0.running_mean", "features.transition1.transition_layer.0.running_var", "features.transition1.transition_layer.2.weight", "features.denseblock2.dense_block.0.dense_layer.0.weight", "features.denseblock2.dense_block.0.dense_layer.0.bias", "features.denseblock2.dense_block.0.dense_layer.0.running_mean", "features.denseblock2.dense_block.0.dense_layer.0.running_var", "features.denseblock2.dense_block.0.dense_layer.2.weight", "features.denseblock2.dense_block.0.dense_layer.3.weight", "features.denseblock2.dense_block.0.dense_layer.3.bias", "features.denseblock2.dense_block.0.dense_layer.3.running_mean", "features.denseblock2.dense_block.0.dense_layer.3.running_var", "features.denseblock2.dense_block.0.dense_layer.5.weight", "features.denseblock2.dense_block.1.dense_layer.0.weight", "features.denseblock2.dense_block.1.dense_layer.0.bias", "features.denseblock2.dense_block.1.dense_layer.0.running_mean", "features.denseblock2.dense_block.1.dense_layer.0.running_var", "features.denseblock2.dense_block.1.dense_layer.2.weight", "features.denseblock2.dense_block.1.dense_layer.3.weight", "features.denseblock2.dense_block.1.dense_layer.3.bias", "features.denseblock2.dense_block.1.dense_layer.3.running_mean", "features.denseblock2.dense_block.1.dense_layer.3.running_var", "features.denseblock2.dense_block.1.dense_layer.5.weight", "features.denseblock2.dense_block.2.dense_layer.0.weight", "features.denseblock2.dense_block.2.dense_layer.0.bias", "features.denseblock2.dense_block.2.dense_layer.0.running_mean", "features.denseblock2.dense_block.2.dense_layer.0.running_var", "features.denseblock2.dense_block.2.dense_layer.2.weight", "features.denseblock2.dense_block.2.dense_layer.3.weight", "features.denseblock2.dense_block.2.dense_layer.3.bias", "features.denseblock2.dense_block.2.dense_layer.3.running_mean", "features.denseblock2.dense_block.2.dense_layer.3.running_var", "features.denseblock2.dense_block.2.dense_layer.5.weight", "features.denseblock2.dense_block.3.dense_layer.0.weight", "features.denseblock2.dense_block.3.dense_layer.0.bias", "features.denseblock2.dense_block.3.dense_layer.0.running_mean", "features.denseblock2.dense_block.3.dense_layer.0.running_var", "features.denseblock2.dense_block.3.dense_layer.2.weight", "features.denseblock2.dense_block.3.dense_layer.3.weight", "features.denseblock2.dense_block.3.dense_layer.3.bias", "features.denseblock2.dense_block.3.dense_layer.3.running_mean", "features.denseblock2.dense_block.3.dense_layer.3.running_var", "features.denseblock2.dense_block.3.dense_layer.5.weight", "features.denseblock2.dense_block.4.dense_layer.0.weight", "features.denseblock2.dense_block.4.dense_layer.0.bias", "features.denseblock2.dense_block.4.dense_layer.0.running_mean", "features.denseblock2.dense_block.4.dense_layer.0.running_var", "features.denseblock2.dense_block.4.dense_layer.2.weight", "features.denseblock2.dense_block.4.dense_layer.3.weight", "features.denseblock2.dense_block.4.dense_layer.3.bias", "features.denseblock2.dense_block.4.dense_layer.3.running_mean", "features.denseblock2.dense_block.4.dense_layer.3.running_var", "features.denseblock2.dense_block.4.dense_layer.5.weight", "features.denseblock2.dense_block.5.dense_layer.0.weight", "features.denseblock2.dense_block.5.dense_layer.0.bias", "features.denseblock2.dense_block.5.dense_layer.0.running_mean", "features.denseblock2.dense_block.5.dense_layer.0.running_var", "features.denseblock2.dense_block.5.dense_layer.2.weight", "features.denseblock2.dense_block.5.dense_layer.3.weight", "features.denseblock2.dense_block.5.dense_layer.3.bias", "features.denseblock2.dense_block.5.dense_layer.3.running_mean", "features.denseblock2.dense_block.5.dense_layer.3.running_var", "features.denseblock2.dense_block.5.dense_layer.5.weight", "features.denseblock2.dense_block.6.dense_layer.0.weight", "features.denseblock2.dense_block.6.dense_layer.0.bias", "features.denseblock2.dense_block.6.dense_layer.0.running_mean", "features.denseblock2.dense_block.6.dense_layer.0.running_var", "features.denseblock2.dense_block.6.dense_layer.2.weight", "features.denseblock2.dense_block.6.dense_layer.3.weight", "features.denseblock2.dense_block.6.dense_layer.3.bias", "features.denseblock2.dense_block.6.dense_layer.3.running_mean", "features.denseblock2.dense_block.6.dense_layer.3.running_var", "features.denseblock2.dense_block.6.dense_layer.5.weight", "features.denseblock2.dense_block.7.dense_layer.0.weight", "features.denseblock2.dense_block.7.dense_layer.0.bias", "features.denseblock2.dense_block.7.dense_layer.0.running_mean", "features.denseblock2.dense_block.7.dense_layer.0.running_var", "features.denseblock2.dense_block.7.dense_layer.2.weight", "features.denseblock2.dense_block.7.dense_layer.3.weight", "features.denseblock2.dense_block.7.dense_layer.3.bias", "features.denseblock2.dense_block.7.dense_layer.3.running_mean", "features.denseblock2.dense_block.7.dense_layer.3.running_var", "features.denseblock2.dense_block.7.dense_layer.5.weight", "features.denseblock2.dense_block.8.dense_layer.0.weight", "features.denseblock2.dense_block.8.dense_layer.0.bias", "features.denseblock2.dense_block.8.dense_layer.0.running_mean", "features.denseblock2.dense_block.8.dense_layer.0.running_var", "features.denseblock2.dense_block.8.dense_layer.2.weight", "features.denseblock2.dense_block.8.dense_layer.3.weight", "features.denseblock2.dense_block.8.dense_layer.3.bias", "features.denseblock2.dense_block.8.dense_layer.3.running_mean", "features.denseblock2.dense_block.8.dense_layer.3.running_var", "features.denseblock2.dense_block.8.dense_layer.5.weight", "features.denseblock2.dense_block.9.dense_layer.0.weight", "features.denseblock2.dense_block.9.dense_layer.0.bias", "features.denseblock2.dense_block.9.dense_layer.0.running_mean", "features.denseblock2.dense_block.9.dense_layer.0.running_var", "features.denseblock2.dense_block.9.dense_layer.2.weight", "features.denseblock2.dense_block.9.dense_layer.3.weight", "features.denseblock2.dense_block.9.dense_layer.3.bias", "features.denseblock2.dense_block.9.dense_layer.3.running_mean", "features.denseblock2.dense_block.9.dense_layer.3.running_var", "features.denseblock2.dense_block.9.dense_layer.5.weight", "features.denseblock2.dense_block.10.dense_layer.0.weight", "features.denseblock2.dense_block.10.dense_layer.0.bias", "features.denseblock2.dense_block.10.dense_layer.0.running_mean", "features.denseblock2.dense_block.10.dense_layer.0.running_var", "features.denseblock2.dense_block.10.dense_layer.2.weight", "features.denseblock2.dense_block.10.dense_layer.3.weight", "features.denseblock2.dense_block.10.dense_layer.3.bias", "features.denseblock2.dense_block.10.dense_layer.3.running_mean", "features.denseblock2.dense_block.10.dense_layer.3.running_var", "features.denseblock2.dense_block.10.dense_layer.5.weight", "features.denseblock2.dense_block.11.dense_layer.0.weight", "features.denseblock2.dense_block.11.dense_layer.0.bias", "features.denseblock2.dense_block.11.dense_layer.0.running_mean", "features.denseblock2.dense_block.11.dense_layer.0.running_var", "features.denseblock2.dense_block.11.dense_layer.2.weight", "features.denseblock2.dense_block.11.dense_layer.3.weight", "features.denseblock2.dense_block.11.dense_layer.3.bias", "features.denseblock2.dense_block.11.dense_layer.3.running_mean", "features.denseblock2.dense_block.11.dense_layer.3.running_var", "features.denseblock2.dense_block.11.dense_layer.5.weight", "features.transition2.transition_layer.0.weight", "features.transition2.transition_layer.0.bias", "features.transition2.transition_layer.0.running_mean", "features.transition2.transition_layer.0.running_var", "features.transition2.transition_layer.2.weight", "features.denseblock3.dense_block.0.dense_layer.0.weight", "features.denseblock3.dense_block.0.dense_layer.0.bias", "features.denseblock3.dense_block.0.dense_layer.0.running_mean", "features.denseblock3.dense_block.0.dense_layer.0.running_var", "features.denseblock3.dense_block.0.dense_layer.2.weight", "features.denseblock3.dense_block.0.dense_layer.3.weight", "features.denseblock3.dense_block.0.dense_layer.3.bias", "features.denseblock3.dense_block.0.dense_layer.3.running_mean", "features.denseblock3.dense_block.0.dense_layer.3.running_var", "features.denseblock3.dense_block.0.dense_layer.5.weight", "features.denseblock3.dense_block.1.dense_layer.0.weight", "features.denseblock3.dense_block.1.dense_layer.0.bias", "features.denseblock3.dense_block.1.dense_layer.0.running_mean", "features.denseblock3.dense_block.1.dense_layer.0.running_var", "features.denseblock3.dense_block.1.dense_layer.2.weight", "features.denseblock3.dense_block.1.dense_layer.3.weight", "features.denseblock3.dense_block.1.dense_layer.3.bias", "features.denseblock3.dense_block.1.dense_layer.3.running_mean", "features.denseblock3.dense_block.1.dense_layer.3.running_var", "features.denseblock3.dense_block.1.dense_layer.5.weight", "features.denseblock3.dense_block.2.dense_layer.0.weight", "features.denseblock3.dense_block.2.dense_layer.0.bias", "features.denseblock3.dense_block.2.dense_layer.0.running_mean", "features.denseblock3.dense_block.2.dense_layer.0.running_var", "features.denseblock3.dense_block.2.dense_layer.2.weight", "features.denseblock3.dense_block.2.dense_layer.3.weight", "features.denseblock3.dense_block.2.dense_layer.3.bias", "features.denseblock3.dense_block.2.dense_layer.3.running_mean", "features.denseblock3.dense_block.2.dense_layer.3.running_var", "features.denseblock3.dense_block.2.dense_layer.5.weight", "features.denseblock3.dense_block.3.dense_layer.0.weight", "features.denseblock3.dense_block.3.dense_layer.0.bias", "features.denseblock3.dense_block.3.dense_layer.0.running_mean", "features.denseblock3.dense_block.3.dense_layer.0.running_var", "features.denseblock3.dense_block.3.dense_layer.2.weight", "features.denseblock3.dense_block.3.dense_layer.3.weight", "features.denseblock3.dense_block.3.dense_layer.3.bias", "features.denseblock3.dense_block.3.dense_layer.3.running_mean", "features.denseblock3.dense_block.3.dense_layer.3.running_var", "features.denseblock3.dense_block.3.dense_layer.5.weight", "features.denseblock3.dense_block.4.dense_layer.0.weight", "features.denseblock3.dense_block.4.dense_layer.0.bias", "features.denseblock3.dense_block.4.dense_layer.0.running_mean", "features.denseblock3.dense_block.4.dense_layer.0.running_var", "features.denseblock3.dense_block.4.dense_layer.2.weight", "features.denseblock3.dense_block.4.dense_layer.3.weight", "features.denseblock3.dense_block.4.dense_layer.3.bias", "features.denseblock3.dense_block.4.dense_layer.3.running_mean", "features.denseblock3.dense_block.4.dense_layer.3.running_var", "features.denseblock3.dense_block.4.dense_layer.5.weight", "features.denseblock3.dense_block.5.dense_layer.0.weight", "features.denseblock3.dense_block.5.dense_layer.0.bias", "features.denseblock3.dense_block.5.dense_layer.0.running_mean", "features.denseblock3.dense_block.5.dense_layer.0.running_var", "features.denseblock3.dense_block.5.dense_layer.2.weight", "features.denseblock3.dense_block.5.dense_layer.3.weight", "features.denseblock3.dense_block.5.dense_layer.3.bias", "features.denseblock3.dense_block.5.dense_layer.3.running_mean", "features.denseblock3.dense_block.5.dense_layer.3.running_var", "features.denseblock3.dense_block.5.dense_layer.5.weight", "features.denseblock3.dense_block.6.dense_layer.0.weight", "features.denseblock3.dense_block.6.dense_layer.0.bias", "features.denseblock3.dense_block.6.dense_layer.0.running_mean", "features.denseblock3.dense_block.6.dense_layer.0.running_var", "features.denseblock3.dense_block.6.dense_layer.2.weight", "features.denseblock3.dense_block.6.dense_layer.3.weight", "features.denseblock3.dense_block.6.dense_layer.3.bias", "features.denseblock3.dense_block.6.dense_layer.3.running_mean", "features.denseblock3.dense_block.6.dense_layer.3.running_var", "features.denseblock3.dense_block.6.dense_layer.5.weight", "features.denseblock3.dense_block.7.dense_layer.0.weight", "features.denseblock3.dense_block.7.dense_layer.0.bias", "features.denseblock3.dense_block.7.dense_layer.0.running_mean", "features.denseblock3.dense_block.7.dense_layer.0.running_var", "features.denseblock3.dense_block.7.dense_layer.2.weight", "features.denseblock3.dense_block.7.dense_layer.3.weight", "features.denseblock3.dense_block.7.dense_layer.3.bias", "features.denseblock3.dense_block.7.dense_layer.3.running_mean", "features.denseblock3.dense_block.7.dense_layer.3.running_var", "features.denseblock3.dense_block.7.dense_layer.5.weight", "features.denseblock3.dense_block.8.dense_layer.0.weight", "features.denseblock3.dense_block.8.dense_layer.0.bias", "features.denseblock3.dense_block.8.dense_layer.0.running_mean", "features.denseblock3.dense_block.8.dense_layer.0.running_var", "features.denseblock3.dense_block.8.dense_layer.2.weight", "features.denseblock3.dense_block.8.dense_layer.3.weight", "features.denseblock3.dense_block.8.dense_layer.3.bias", "features.denseblock3.dense_block.8.dense_layer.3.running_mean", "features.denseblock3.dense_block.8.dense_layer.3.running_var", "features.denseblock3.dense_block.8.dense_layer.5.weight", "features.denseblock3.dense_block.9.dense_layer.0.weight", "features.denseblock3.dense_block.9.dense_layer.0.bias", "features.denseblock3.dense_block.9.dense_layer.0.running_mean", "features.denseblock3.dense_block.9.dense_layer.0.running_var", "features.denseblock3.dense_block.9.dense_layer.2.weight", "features.denseblock3.dense_block.9.dense_layer.3.weight", "features.denseblock3.dense_block.9.dense_layer.3.bias", "features.denseblock3.dense_block.9.dense_layer.3.running_mean", "features.denseblock3.dense_block.9.dense_layer.3.running_var", "features.denseblock3.dense_block.9.dense_layer.5.weight", "features.denseblock3.dense_block.10.dense_layer.0.weight", "features.denseblock3.dense_block.10.dense_layer.0.bias", "features.denseblock3.dense_block.10.dense_layer.0.running_mean", "features.denseblock3.dense_block.10.dense_layer.0.running_var", "features.denseblock3.dense_block.10.dense_layer.2.weight", "features.denseblock3.dense_block.10.dense_layer.3.weight", "features.denseblock3.dense_block.10.dense_layer.3.bias", "features.denseblock3.dense_block.10.dense_layer.3.running_mean", "features.denseblock3.dense_block.10.dense_layer.3.running_var", "features.denseblock3.dense_block.10.dense_layer.5.weight", "features.denseblock3.dense_block.11.dense_layer.0.weight", "features.denseblock3.dense_block.11.dense_layer.0.bias", "features.denseblock3.dense_block.11.dense_layer.0.running_mean", "features.denseblock3.dense_block.11.dense_layer.0.running_var", "features.denseblock3.dense_block.11.dense_layer.2.weight", "features.denseblock3.dense_block.11.dense_layer.3.weight", "features.denseblock3.dense_block.11.dense_layer.3.bias", "features.denseblock3.dense_block.11.dense_layer.3.running_mean", "features.denseblock3.dense_block.11.dense_layer.3.running_var", "features.denseblock3.dense_block.11.dense_layer.5.weight", "features.denseblock3.dense_block.12.dense_layer.0.weight", "features.denseblock3.dense_block.12.dense_layer.0.bias", "features.denseblock3.dense_block.12.dense_layer.0.running_mean", "features.denseblock3.dense_block.12.dense_layer.0.running_var", "features.denseblock3.dense_block.12.dense_layer.2.weight", "features.denseblock3.dense_block.12.dense_layer.3.weight", "features.denseblock3.dense_block.12.dense_layer.3.bias", "features.denseblock3.dense_block.12.dense_layer.3.running_mean", "features.denseblock3.dense_block.12.dense_layer.3.running_var", "features.denseblock3.dense_block.12.dense_layer.5.weight", "features.denseblock3.dense_block.13.dense_layer.0.weight", "features.denseblock3.dense_block.13.dense_layer.0.bias", "features.denseblock3.dense_block.13.dense_layer.0.running_mean", "features.denseblock3.dense_block.13.dense_layer.0.running_var", "features.denseblock3.dense_block.13.dense_layer.2.weight", "features.denseblock3.dense_block.13.dense_layer.3.weight", "features.denseblock3.dense_block.13.dense_layer.3.bias", "features.denseblock3.dense_block.13.dense_layer.3.running_mean", "features.denseblock3.dense_block.13.dense_layer.3.running_var", "features.denseblock3.dense_block.13.dense_layer.5.weight", "features.denseblock3.dense_block.14.dense_layer.0.weight", "features.denseblock3.dense_block.14.dense_layer.0.bias", "features.denseblock3.dense_block.14.dense_layer.0.running_mean", "features.denseblock3.dense_block.14.dense_layer.0.running_var", "features.denseblock3.dense_block.14.dense_layer.2.weight", "features.denseblock3.dense_block.14.dense_layer.3.weight", "features.denseblock3.dense_block.14.dense_layer.3.bias", "features.denseblock3.dense_block.14.dense_layer.3.running_mean", "features.denseblock3.dense_block.14.dense_layer.3.running_var", "features.denseblock3.dense_block.14.dense_layer.5.weight", "features.denseblock3.dense_block.15.dense_layer.0.weight", "features.denseblock3.dense_block.15.dense_layer.0.bias", "features.denseblock3.dense_block.15.dense_layer.0.running_mean", "features.denseblock3.dense_block.15.dense_layer.0.running_var", "features.denseblock3.dense_block.15.dense_layer.2.weight", "features.denseblock3.dense_block.15.dense_layer.3.weight", "features.denseblock3.dense_block.15.dense_layer.3.bias", "features.denseblock3.dense_block.15.dense_layer.3.running_mean", "features.denseblock3.dense_block.15.dense_layer.3.running_var", "features.denseblock3.dense_block.15.dense_layer.5.weight", "features.denseblock3.dense_block.16.dense_layer.0.weight", "features.denseblock3.dense_block.16.dense_layer.0.bias", "features.denseblock3.dense_block.16.dense_layer.0.running_mean", "features.denseblock3.dense_block.16.dense_layer.0.running_var", "features.denseblock3.dense_block.16.dense_layer.2.weight", "features.denseblock3.dense_block.16.dense_layer.3.weight", "features.denseblock3.dense_block.16.dense_layer.3.bias", "features.denseblock3.dense_block.16.dense_layer.3.running_mean", "features.denseblock3.dense_block.16.dense_layer.3.running_var", "features.denseblock3.dense_block.16.dense_layer.5.weight", "features.denseblock3.dense_block.17.dense_layer.0.weight", "features.denseblock3.dense_block.17.dense_layer.0.bias", "features.denseblock3.dense_block.17.dense_layer.0.running_mean", "features.denseblock3.dense_block.17.dense_layer.0.running_var", "features.denseblock3.dense_block.17.dense_layer.2.weight", "features.denseblock3.dense_block.17.dense_layer.3.weight", "features.denseblock3.dense_block.17.dense_layer.3.bias", "features.denseblock3.dense_block.17.dense_layer.3.running_mean", "features.denseblock3.dense_block.17.dense_layer.3.running_var", "features.denseblock3.dense_block.17.dense_layer.5.weight", "features.denseblock3.dense_block.18.dense_layer.0.weight", "features.denseblock3.dense_block.18.dense_layer.0.bias", "features.denseblock3.dense_block.18.dense_layer.0.running_mean", "features.denseblock3.dense_block.18.dense_layer.0.running_var", "features.denseblock3.dense_block.18.dense_layer.2.weight", "features.denseblock3.dense_block.18.dense_layer.3.weight", "features.denseblock3.dense_block.18.dense_layer.3.bias", "features.denseblock3.dense_block.18.dense_layer.3.running_mean", "features.denseblock3.dense_block.18.dense_layer.3.running_var", "features.denseblock3.dense_block.18.dense_layer.5.weight", "features.denseblock3.dense_block.19.dense_layer.0.weight", "features.denseblock3.dense_block.19.dense_layer.0.bias", "features.denseblock3.dense_block.19.dense_layer.0.running_mean", "features.denseblock3.dense_block.19.dense_layer.0.running_var", "features.denseblock3.dense_block.19.dense_layer.2.weight", "features.denseblock3.dense_block.19.dense_layer.3.weight", "features.denseblock3.dense_block.19.dense_layer.3.bias", "features.denseblock3.dense_block.19.dense_layer.3.running_mean", "features.denseblock3.dense_block.19.dense_layer.3.running_var", "features.denseblock3.dense_block.19.dense_layer.5.weight", "features.denseblock3.dense_block.20.dense_layer.0.weight", "features.denseblock3.dense_block.20.dense_layer.0.bias", "features.denseblock3.dense_block.20.dense_layer.0.running_mean", "features.denseblock3.dense_block.20.dense_layer.0.running_var", "features.denseblock3.dense_block.20.dense_layer.2.weight", "features.denseblock3.dense_block.20.dense_layer.3.weight", "features.denseblock3.dense_block.20.dense_layer.3.bias", "features.denseblock3.dense_block.20.dense_layer.3.running_mean", "features.denseblock3.dense_block.20.dense_layer.3.running_var", "features.denseblock3.dense_block.20.dense_layer.5.weight", "features.denseblock3.dense_block.21.dense_layer.0.weight", "features.denseblock3.dense_block.21.dense_layer.0.bias", "features.denseblock3.dense_block.21.dense_layer.0.running_mean", "features.denseblock3.dense_block.21.dense_layer.0.running_var", "features.denseblock3.dense_block.21.dense_layer.2.weight", "features.denseblock3.dense_block.21.dense_layer.3.weight", "features.denseblock3.dense_block.21.dense_layer.3.bias", "features.denseblock3.dense_block.21.dense_layer.3.running_mean", "features.denseblock3.dense_block.21.dense_layer.3.running_var", "features.denseblock3.dense_block.21.dense_layer.5.weight", "features.denseblock3.dense_block.22.dense_layer.0.weight", "features.denseblock3.dense_block.22.dense_layer.0.bias", "features.denseblock3.dense_block.22.dense_layer.0.running_mean", "features.denseblock3.dense_block.22.dense_layer.0.running_var", "features.denseblock3.dense_block.22.dense_layer.2.weight", "features.denseblock3.dense_block.22.dense_layer.3.weight", "features.denseblock3.dense_block.22.dense_layer.3.bias", "features.denseblock3.dense_block.22.dense_layer.3.running_mean", "features.denseblock3.dense_block.22.dense_layer.3.running_var", "features.denseblock3.dense_block.22.dense_layer.5.weight", "features.denseblock3.dense_block.23.dense_layer.0.weight", "features.denseblock3.dense_block.23.dense_layer.0.bias", "features.denseblock3.dense_block.23.dense_layer.0.running_mean", "features.denseblock3.dense_block.23.dense_layer.0.running_var", "features.denseblock3.dense_block.23.dense_layer.2.weight", "features.denseblock3.dense_block.23.dense_layer.3.weight", "features.denseblock3.dense_block.23.dense_layer.3.bias", "features.denseblock3.dense_block.23.dense_layer.3.running_mean", "features.denseblock3.dense_block.23.dense_layer.3.running_var", "features.denseblock3.dense_block.23.dense_layer.5.weight", "features.transition3.transition_layer.0.weight", "features.transition3.transition_layer.0.bias", "features.transition3.transition_layer.0.running_mean", "features.transition3.transition_layer.0.running_var", "features.transition3.transition_layer.2.weight", "features.denseblock4.dense_block.0.dense_layer.0.weight", "features.denseblock4.dense_block.0.dense_layer.0.bias", "features.denseblock4.dense_block.0.dense_layer.0.running_mean", "features.denseblock4.dense_block.0.dense_layer.0.running_var", "features.denseblock4.dense_block.0.dense_layer.2.weight", "features.denseblock4.dense_block.0.dense_layer.3.weight", "features.denseblock4.dense_block.0.dense_layer.3.bias", "features.denseblock4.dense_block.0.dense_layer.3.running_mean", "features.denseblock4.dense_block.0.dense_layer.3.running_var", "features.denseblock4.dense_block.0.dense_layer.5.weight", "features.denseblock4.dense_block.1.dense_layer.0.weight", "features.denseblock4.dense_block.1.dense_layer.0.bias", "features.denseblock4.dense_block.1.dense_layer.0.running_mean", "features.denseblock4.dense_block.1.dense_layer.0.running_var", "features.denseblock4.dense_block.1.dense_layer.2.weight", "features.denseblock4.dense_block.1.dense_layer.3.weight", "features.denseblock4.dense_block.1.dense_layer.3.bias", "features.denseblock4.dense_block.1.dense_layer.3.running_mean", "features.denseblock4.dense_block.1.dense_layer.3.running_var", "features.denseblock4.dense_block.1.dense_layer.5.weight", "features.denseblock4.dense_block.2.dense_layer.0.weight", "features.denseblock4.dense_block.2.dense_layer.0.bias", "features.denseblock4.dense_block.2.dense_layer.0.running_mean", "features.denseblock4.dense_block.2.dense_layer.0.running_var", "features.denseblock4.dense_block.2.dense_layer.2.weight", "features.denseblock4.dense_block.2.dense_layer.3.weight", "features.denseblock4.dense_block.2.dense_layer.3.bias", "features.denseblock4.dense_block.2.dense_layer.3.running_mean", "features.denseblock4.dense_block.2.dense_layer.3.running_var", "features.denseblock4.dense_block.2.dense_layer.5.weight", "features.denseblock4.dense_block.3.dense_layer.0.weight", "features.denseblock4.dense_block.3.dense_layer.0.bias", "features.denseblock4.dense_block.3.dense_layer.0.running_mean", "features.denseblock4.dense_block.3.dense_layer.0.running_var", "features.denseblock4.dense_block.3.dense_layer.2.weight", "features.denseblock4.dense_block.3.dense_layer.3.weight", "features.denseblock4.dense_block.3.dense_layer.3.bias", "features.denseblock4.dense_block.3.dense_layer.3.running_mean", "features.denseblock4.dense_block.3.dense_layer.3.running_var", "features.denseblock4.dense_block.3.dense_layer.5.weight", "features.denseblock4.dense_block.4.dense_layer.0.weight", "features.denseblock4.dense_block.4.dense_layer.0.bias", "features.denseblock4.dense_block.4.dense_layer.0.running_mean", "features.denseblock4.dense_block.4.dense_layer.0.running_var", "features.denseblock4.dense_block.4.dense_layer.2.weight", "features.denseblock4.dense_block.4.dense_layer.3.weight", "features.denseblock4.dense_block.4.dense_layer.3.bias", "features.denseblock4.dense_block.4.dense_layer.3.running_mean", "features.denseblock4.dense_block.4.dense_layer.3.running_var", "features.denseblock4.dense_block.4.dense_layer.5.weight", "features.denseblock4.dense_block.5.dense_layer.0.weight", "features.denseblock4.dense_block.5.dense_layer.0.bias", "features.denseblock4.dense_block.5.dense_layer.0.running_mean", "features.denseblock4.dense_block.5.dense_layer.0.running_var", "features.denseblock4.dense_block.5.dense_layer.2.weight", "features.denseblock4.dense_block.5.dense_layer.3.weight", "features.denseblock4.dense_block.5.dense_layer.3.bias", "features.denseblock4.dense_block.5.dense_layer.3.running_mean", "features.denseblock4.dense_block.5.dense_layer.3.running_var", "features.denseblock4.dense_block.5.dense_layer.5.weight", "features.denseblock4.dense_block.6.dense_layer.0.weight", "features.denseblock4.dense_block.6.dense_layer.0.bias", "features.denseblock4.dense_block.6.dense_layer.0.running_mean", "features.denseblock4.dense_block.6.dense_layer.0.running_var", "features.denseblock4.dense_block.6.dense_layer.2.weight", "features.denseblock4.dense_block.6.dense_layer.3.weight", "features.denseblock4.dense_block.6.dense_layer.3.bias", "features.denseblock4.dense_block.6.dense_layer.3.running_mean", "features.denseblock4.dense_block.6.dense_layer.3.running_var", "features.denseblock4.dense_block.6.dense_layer.5.weight", "features.denseblock4.dense_block.7.dense_layer.0.weight", "features.denseblock4.dense_block.7.dense_layer.0.bias", "features.denseblock4.dense_block.7.dense_layer.0.running_mean", "features.denseblock4.dense_block.7.dense_layer.0.running_var", "features.denseblock4.dense_block.7.dense_layer.2.weight", "features.denseblock4.dense_block.7.dense_layer.3.weight", "features.denseblock4.dense_block.7.dense_layer.3.bias", "features.denseblock4.dense_block.7.dense_layer.3.running_mean", "features.denseblock4.dense_block.7.dense_layer.3.running_var", "features.denseblock4.dense_block.7.dense_layer.5.weight", "features.denseblock4.dense_block.8.dense_layer.0.weight", "features.denseblock4.dense_block.8.dense_layer.0.bias", "features.denseblock4.dense_block.8.dense_layer.0.running_mean", "features.denseblock4.dense_block.8.dense_layer.0.running_var", "features.denseblock4.dense_block.8.dense_layer.2.weight", "features.denseblock4.dense_block.8.dense_layer.3.weight", "features.denseblock4.dense_block.8.dense_layer.3.bias", "features.denseblock4.dense_block.8.dense_layer.3.running_mean", "features.denseblock4.dense_block.8.dense_layer.3.running_var", "features.denseblock4.dense_block.8.dense_layer.5.weight", "features.denseblock4.dense_block.9.dense_layer.0.weight", "features.denseblock4.dense_block.9.dense_layer.0.bias", "features.denseblock4.dense_block.9.dense_layer.0.running_mean", "features.denseblock4.dense_block.9.dense_layer.0.running_var", "features.denseblock4.dense_block.9.dense_layer.2.weight", "features.denseblock4.dense_block.9.dense_layer.3.weight", "features.denseblock4.dense_block.9.dense_layer.3.bias", "features.denseblock4.dense_block.9.dense_layer.3.running_mean", "features.denseblock4.dense_block.9.dense_layer.3.running_var", "features.denseblock4.dense_block.9.dense_layer.5.weight", "features.denseblock4.dense_block.10.dense_layer.0.weight", "features.denseblock4.dense_block.10.dense_layer.0.bias", "features.denseblock4.dense_block.10.dense_layer.0.running_mean", "features.denseblock4.dense_block.10.dense_layer.0.running_var", "features.denseblock4.dense_block.10.dense_layer.2.weight", "features.denseblock4.dense_block.10.dense_layer.3.weight", "features.denseblock4.dense_block.10.dense_layer.3.bias", "features.denseblock4.dense_block.10.dense_layer.3.running_mean", "features.denseblock4.dense_block.10.dense_layer.3.running_var", "features.denseblock4.dense_block.10.dense_layer.5.weight", "features.denseblock4.dense_block.11.dense_layer.0.weight", "features.denseblock4.dense_block.11.dense_layer.0.bias", "features.denseblock4.dense_block.11.dense_layer.0.running_mean", "features.denseblock4.dense_block.11.dense_layer.0.running_var", "features.denseblock4.dense_block.11.dense_layer.2.weight", "features.denseblock4.dense_block.11.dense_layer.3.weight", "features.denseblock4.dense_block.11.dense_layer.3.bias", "features.denseblock4.dense_block.11.dense_layer.3.running_mean", "features.denseblock4.dense_block.11.dense_layer.3.running_var", "features.denseblock4.dense_block.11.dense_layer.5.weight", "features.denseblock4.dense_block.12.dense_layer.0.weight", "features.denseblock4.dense_block.12.dense_layer.0.bias", "features.denseblock4.dense_block.12.dense_layer.0.running_mean", "features.denseblock4.dense_block.12.dense_layer.0.running_var", "features.denseblock4.dense_block.12.dense_layer.2.weight", "features.denseblock4.dense_block.12.dense_layer.3.weight", "features.denseblock4.dense_block.12.dense_layer.3.bias", "features.denseblock4.dense_block.12.dense_layer.3.running_mean", "features.denseblock4.dense_block.12.dense_layer.3.running_var", "features.denseblock4.dense_block.12.dense_layer.5.weight", "features.denseblock4.dense_block.13.dense_layer.0.weight", "features.denseblock4.dense_block.13.dense_layer.0.bias", "features.denseblock4.dense_block.13.dense_layer.0.running_mean", "features.denseblock4.dense_block.13.dense_layer.0.running_var", "features.denseblock4.dense_block.13.dense_layer.2.weight", "features.denseblock4.dense_block.13.dense_layer.3.weight", "features.denseblock4.dense_block.13.dense_layer.3.bias", "features.denseblock4.dense_block.13.dense_layer.3.running_mean", "features.denseblock4.dense_block.13.dense_layer.3.running_var", "features.denseblock4.dense_block.13.dense_layer.5.weight", "features.denseblock4.dense_block.14.dense_layer.0.weight", "features.denseblock4.dense_block.14.dense_layer.0.bias", "features.denseblock4.dense_block.14.dense_layer.0.running_mean", "features.denseblock4.dense_block.14.dense_layer.0.running_var", "features.denseblock4.dense_block.14.dense_layer.2.weight", "features.denseblock4.dense_block.14.dense_layer.3.weight", "features.denseblock4.dense_block.14.dense_layer.3.bias", "features.denseblock4.dense_block.14.dense_layer.3.running_mean", "features.denseblock4.dense_block.14.dense_layer.3.running_var", "features.denseblock4.dense_block.14.dense_layer.5.weight", "features.denseblock4.dense_block.15.dense_layer.0.weight", "features.denseblock4.dense_block.15.dense_layer.0.bias", "features.denseblock4.dense_block.15.dense_layer.0.running_mean", "features.denseblock4.dense_block.15.dense_layer.0.running_var", "features.denseblock4.dense_block.15.dense_layer.2.weight", "features.denseblock4.dense_block.15.dense_layer.3.weight", "features.denseblock4.dense_block.15.dense_layer.3.bias", "features.denseblock4.dense_block.15.dense_layer.3.running_mean", "features.denseblock4.dense_block.15.dense_layer.3.running_var", "features.denseblock4.dense_block.15.dense_layer.5.weight", "features.norm_final.weight", "features.norm_final.bias", "features.norm_final.running_mean", "features.norm_final.running_var", "classifier.weight", "classifier.bias". 
	Unexpected key(s) in state_dict: "expert.features.0.weight", "expert.features.1.weight", "expert.features.1.bias", "expert.features.1.running_mean", "expert.features.1.running_var", "expert.features.1.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.0.weight", "expert.features.denseblock1.dense_block.0.dense_layer.0.bias", "expert.features.denseblock1.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.2.weight", "expert.features.denseblock1.dense_block.0.dense_layer.3.weight", "expert.features.denseblock1.dense_block.0.dense_layer.3.bias", "expert.features.denseblock1.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.5.weight", "expert.features.denseblock1.dense_block.1.dense_layer.0.weight", "expert.features.denseblock1.dense_block.1.dense_layer.0.bias", "expert.features.denseblock1.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.1.dense_layer.2.weight", "expert.features.denseblock1.dense_block.1.dense_layer.3.weight", "expert.features.denseblock1.dense_block.1.dense_layer.3.bias", "expert.features.denseblock1.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.1.dense_layer.5.weight", "expert.features.denseblock1.dense_block.2.dense_layer.0.weight", "expert.features.denseblock1.dense_block.2.dense_layer.0.bias", "expert.features.denseblock1.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.2.dense_layer.2.weight", "expert.features.denseblock1.dense_block.2.dense_layer.3.weight", "expert.features.denseblock1.dense_block.2.dense_layer.3.bias", "expert.features.denseblock1.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.2.dense_layer.5.weight", "expert.features.denseblock1.dense_block.3.dense_layer.0.weight", "expert.features.denseblock1.dense_block.3.dense_layer.0.bias", "expert.features.denseblock1.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.3.dense_layer.2.weight", "expert.features.denseblock1.dense_block.3.dense_layer.3.weight", "expert.features.denseblock1.dense_block.3.dense_layer.3.bias", "expert.features.denseblock1.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.3.dense_layer.5.weight", "expert.features.denseblock1.dense_block.4.dense_layer.0.weight", "expert.features.denseblock1.dense_block.4.dense_layer.0.bias", "expert.features.denseblock1.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.4.dense_layer.2.weight", "expert.features.denseblock1.dense_block.4.dense_layer.3.weight", "expert.features.denseblock1.dense_block.4.dense_layer.3.bias", "expert.features.denseblock1.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.4.dense_layer.5.weight", "expert.features.denseblock1.dense_block.5.dense_layer.0.weight", "expert.features.denseblock1.dense_block.5.dense_layer.0.bias", "expert.features.denseblock1.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.5.dense_layer.2.weight", "expert.features.denseblock1.dense_block.5.dense_layer.3.weight", "expert.features.denseblock1.dense_block.5.dense_layer.3.bias", "expert.features.denseblock1.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.5.dense_layer.5.weight", "expert.features.transition1.transition_layer.0.weight", "expert.features.transition1.transition_layer.0.bias", "expert.features.transition1.transition_layer.0.running_mean", "expert.features.transition1.transition_layer.0.running_var", "expert.features.transition1.transition_layer.0.num_batches_tracked", "expert.features.transition1.transition_layer.2.weight", "expert.features.denseblock2.dense_block.0.dense_layer.0.weight", "expert.features.denseblock2.dense_block.0.dense_layer.0.bias", "expert.features.denseblock2.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.0.dense_layer.2.weight", "expert.features.denseblock2.dense_block.0.dense_layer.3.weight", "expert.features.denseblock2.dense_block.0.dense_layer.3.bias", "expert.features.denseblock2.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.0.dense_layer.5.weight", "expert.features.denseblock2.dense_block.1.dense_layer.0.weight", "expert.features.denseblock2.dense_block.1.dense_layer.0.bias", "expert.features.denseblock2.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.1.dense_layer.2.weight", "expert.features.denseblock2.dense_block.1.dense_layer.3.weight", "expert.features.denseblock2.dense_block.1.dense_layer.3.bias", "expert.features.denseblock2.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.1.dense_layer.5.weight", "expert.features.denseblock2.dense_block.2.dense_layer.0.weight", "expert.features.denseblock2.dense_block.2.dense_layer.0.bias", "expert.features.denseblock2.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.2.dense_layer.2.weight", "expert.features.denseblock2.dense_block.2.dense_layer.3.weight", "expert.features.denseblock2.dense_block.2.dense_layer.3.bias", "expert.features.denseblock2.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.2.dense_layer.5.weight", "expert.features.denseblock2.dense_block.3.dense_layer.0.weight", "expert.features.denseblock2.dense_block.3.dense_layer.0.bias", "expert.features.denseblock2.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.3.dense_layer.2.weight", "expert.features.denseblock2.dense_block.3.dense_layer.3.weight", "expert.features.denseblock2.dense_block.3.dense_layer.3.bias", "expert.features.denseblock2.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.3.dense_layer.5.weight", "expert.features.denseblock2.dense_block.4.dense_layer.0.weight", "expert.features.denseblock2.dense_block.4.dense_layer.0.bias", "expert.features.denseblock2.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.4.dense_layer.2.weight", "expert.features.denseblock2.dense_block.4.dense_layer.3.weight", "expert.features.denseblock2.dense_block.4.dense_layer.3.bias", "expert.features.denseblock2.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.4.dense_layer.5.weight", "expert.features.denseblock2.dense_block.5.dense_layer.0.weight", "expert.features.denseblock2.dense_block.5.dense_layer.0.bias", "expert.features.denseblock2.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.5.dense_layer.2.weight", "expert.features.denseblock2.dense_block.5.dense_layer.3.weight", "expert.features.denseblock2.dense_block.5.dense_layer.3.bias", "expert.features.denseblock2.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.5.dense_layer.5.weight", "expert.features.denseblock2.dense_block.6.dense_layer.0.weight", "expert.features.denseblock2.dense_block.6.dense_layer.0.bias", "expert.features.denseblock2.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.6.dense_layer.2.weight", "expert.features.denseblock2.dense_block.6.dense_layer.3.weight", "expert.features.denseblock2.dense_block.6.dense_layer.3.bias", "expert.features.denseblock2.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.6.dense_layer.5.weight", "expert.features.denseblock2.dense_block.7.dense_layer.0.weight", "expert.features.denseblock2.dense_block.7.dense_layer.0.bias", "expert.features.denseblock2.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.7.dense_layer.2.weight", "expert.features.denseblock2.dense_block.7.dense_layer.3.weight", "expert.features.denseblock2.dense_block.7.dense_layer.3.bias", "expert.features.denseblock2.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.7.dense_layer.5.weight", "expert.features.denseblock2.dense_block.8.dense_layer.0.weight", "expert.features.denseblock2.dense_block.8.dense_layer.0.bias", "expert.features.denseblock2.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.8.dense_layer.2.weight", "expert.features.denseblock2.dense_block.8.dense_layer.3.weight", "expert.features.denseblock2.dense_block.8.dense_layer.3.bias", "expert.features.denseblock2.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.8.dense_layer.5.weight", "expert.features.denseblock2.dense_block.9.dense_layer.0.weight", "expert.features.denseblock2.dense_block.9.dense_layer.0.bias", "expert.features.denseblock2.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.9.dense_layer.2.weight", "expert.features.denseblock2.dense_block.9.dense_layer.3.weight", "expert.features.denseblock2.dense_block.9.dense_layer.3.bias", "expert.features.denseblock2.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.9.dense_layer.5.weight", "expert.features.denseblock2.dense_block.10.dense_layer.0.weight", "expert.features.denseblock2.dense_block.10.dense_layer.0.bias", "expert.features.denseblock2.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.10.dense_layer.2.weight", "expert.features.denseblock2.dense_block.10.dense_layer.3.weight", "expert.features.denseblock2.dense_block.10.dense_layer.3.bias", "expert.features.denseblock2.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.10.dense_layer.5.weight", "expert.features.denseblock2.dense_block.11.dense_layer.0.weight", "expert.features.denseblock2.dense_block.11.dense_layer.0.bias", "expert.features.denseblock2.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.11.dense_layer.2.weight", "expert.features.denseblock2.dense_block.11.dense_layer.3.weight", "expert.features.denseblock2.dense_block.11.dense_layer.3.bias", "expert.features.denseblock2.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.11.dense_layer.5.weight", "expert.features.transition2.transition_layer.0.weight", "expert.features.transition2.transition_layer.0.bias", "expert.features.transition2.transition_layer.0.running_mean", "expert.features.transition2.transition_layer.0.running_var", "expert.features.transition2.transition_layer.0.num_batches_tracked", "expert.features.transition2.transition_layer.2.weight", "expert.features.denseblock3.dense_block.0.dense_layer.0.weight", "expert.features.denseblock3.dense_block.0.dense_layer.0.bias", "expert.features.denseblock3.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.0.dense_layer.2.weight", "expert.features.denseblock3.dense_block.0.dense_layer.3.weight", "expert.features.denseblock3.dense_block.0.dense_layer.3.bias", "expert.features.denseblock3.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.0.dense_layer.5.weight", "expert.features.denseblock3.dense_block.1.dense_layer.0.weight", "expert.features.denseblock3.dense_block.1.dense_layer.0.bias", "expert.features.denseblock3.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.1.dense_layer.2.weight", "expert.features.denseblock3.dense_block.1.dense_layer.3.weight", "expert.features.denseblock3.dense_block.1.dense_layer.3.bias", "expert.features.denseblock3.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.1.dense_layer.5.weight", "expert.features.denseblock3.dense_block.2.dense_layer.0.weight", "expert.features.denseblock3.dense_block.2.dense_layer.0.bias", "expert.features.denseblock3.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.2.dense_layer.2.weight", "expert.features.denseblock3.dense_block.2.dense_layer.3.weight", "expert.features.denseblock3.dense_block.2.dense_layer.3.bias", "expert.features.denseblock3.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.2.dense_layer.5.weight", "expert.features.denseblock3.dense_block.3.dense_layer.0.weight", "expert.features.denseblock3.dense_block.3.dense_layer.0.bias", "expert.features.denseblock3.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.3.dense_layer.2.weight", "expert.features.denseblock3.dense_block.3.dense_layer.3.weight", "expert.features.denseblock3.dense_block.3.dense_layer.3.bias", "expert.features.denseblock3.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.3.dense_layer.5.weight", "expert.features.denseblock3.dense_block.4.dense_layer.0.weight", "expert.features.denseblock3.dense_block.4.dense_layer.0.bias", "expert.features.denseblock3.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.4.dense_layer.2.weight", "expert.features.denseblock3.dense_block.4.dense_layer.3.weight", "expert.features.denseblock3.dense_block.4.dense_layer.3.bias", "expert.features.denseblock3.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.4.dense_layer.5.weight", "expert.features.denseblock3.dense_block.5.dense_layer.0.weight", "expert.features.denseblock3.dense_block.5.dense_layer.0.bias", "expert.features.denseblock3.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.5.dense_layer.2.weight", "expert.features.denseblock3.dense_block.5.dense_layer.3.weight", "expert.features.denseblock3.dense_block.5.dense_layer.3.bias", "expert.features.denseblock3.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.5.dense_layer.5.weight", "expert.features.denseblock3.dense_block.6.dense_layer.0.weight", "expert.features.denseblock3.dense_block.6.dense_layer.0.bias", "expert.features.denseblock3.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.6.dense_layer.2.weight", "expert.features.denseblock3.dense_block.6.dense_layer.3.weight", "expert.features.denseblock3.dense_block.6.dense_layer.3.bias", "expert.features.denseblock3.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.6.dense_layer.5.weight", "expert.features.denseblock3.dense_block.7.dense_layer.0.weight", "expert.features.denseblock3.dense_block.7.dense_layer.0.bias", "expert.features.denseblock3.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.7.dense_layer.2.weight", "expert.features.denseblock3.dense_block.7.dense_layer.3.weight", "expert.features.denseblock3.dense_block.7.dense_layer.3.bias", "expert.features.denseblock3.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.7.dense_layer.5.weight", "expert.features.denseblock3.dense_block.8.dense_layer.0.weight", "expert.features.denseblock3.dense_block.8.dense_layer.0.bias", "expert.features.denseblock3.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.8.dense_layer.2.weight", "expert.features.denseblock3.dense_block.8.dense_layer.3.weight", "expert.features.denseblock3.dense_block.8.dense_layer.3.bias", "expert.features.denseblock3.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.8.dense_layer.5.weight", "expert.features.denseblock3.dense_block.9.dense_layer.0.weight", "expert.features.denseblock3.dense_block.9.dense_layer.0.bias", "expert.features.denseblock3.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.9.dense_layer.2.weight", "expert.features.denseblock3.dense_block.9.dense_layer.3.weight", "expert.features.denseblock3.dense_block.9.dense_layer.3.bias", "expert.features.denseblock3.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.9.dense_layer.5.weight", "expert.features.denseblock3.dense_block.10.dense_layer.0.weight", "expert.features.denseblock3.dense_block.10.dense_layer.0.bias", "expert.features.denseblock3.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.10.dense_layer.2.weight", "expert.features.denseblock3.dense_block.10.dense_layer.3.weight", "expert.features.denseblock3.dense_block.10.dense_layer.3.bias", "expert.features.denseblock3.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.10.dense_layer.5.weight", "expert.features.denseblock3.dense_block.11.dense_layer.0.weight", "expert.features.denseblock3.dense_block.11.dense_layer.0.bias", "expert.features.denseblock3.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.11.dense_layer.2.weight", "expert.features.denseblock3.dense_block.11.dense_layer.3.weight", "expert.features.denseblock3.dense_block.11.dense_layer.3.bias", "expert.features.denseblock3.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.11.dense_layer.5.weight", "expert.features.denseblock3.dense_block.12.dense_layer.0.weight", "expert.features.denseblock3.dense_block.12.dense_layer.0.bias", "expert.features.denseblock3.dense_block.12.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.12.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.12.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.12.dense_layer.2.weight", "expert.features.denseblock3.dense_block.12.dense_layer.3.weight", "expert.features.denseblock3.dense_block.12.dense_layer.3.bias", "expert.features.denseblock3.dense_block.12.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.12.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.12.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.12.dense_layer.5.weight", "expert.features.denseblock3.dense_block.13.dense_layer.0.weight", "expert.features.denseblock3.dense_block.13.dense_layer.0.bias", "expert.features.denseblock3.dense_block.13.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.13.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.13.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.13.dense_layer.2.weight", "expert.features.denseblock3.dense_block.13.dense_layer.3.weight", "expert.features.denseblock3.dense_block.13.dense_layer.3.bias", "expert.features.denseblock3.dense_block.13.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.13.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.13.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.13.dense_layer.5.weight", "expert.features.denseblock3.dense_block.14.dense_layer.0.weight", "expert.features.denseblock3.dense_block.14.dense_layer.0.bias", "expert.features.denseblock3.dense_block.14.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.14.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.14.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.14.dense_layer.2.weight", "expert.features.denseblock3.dense_block.14.dense_layer.3.weight", "expert.features.denseblock3.dense_block.14.dense_layer.3.bias", "expert.features.denseblock3.dense_block.14.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.14.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.14.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.14.dense_layer.5.weight", "expert.features.denseblock3.dense_block.15.dense_layer.0.weight", "expert.features.denseblock3.dense_block.15.dense_layer.0.bias", "expert.features.denseblock3.dense_block.15.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.15.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.15.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.15.dense_layer.2.weight", "expert.features.denseblock3.dense_block.15.dense_layer.3.weight", "expert.features.denseblock3.dense_block.15.dense_layer.3.bias", "expert.features.denseblock3.dense_block.15.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.15.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.15.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.15.dense_layer.5.weight", "expert.features.denseblock3.dense_block.16.dense_layer.0.weight", "expert.features.denseblock3.dense_block.16.dense_layer.0.bias", "expert.features.denseblock3.dense_block.16.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.16.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.16.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.16.dense_layer.2.weight", "expert.features.denseblock3.dense_block.16.dense_layer.3.weight", "expert.features.denseblock3.dense_block.16.dense_layer.3.bias", "expert.features.denseblock3.dense_block.16.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.16.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.16.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.16.dense_layer.5.weight", "expert.features.denseblock3.dense_block.17.dense_layer.0.weight", "expert.features.denseblock3.dense_block.17.dense_layer.0.bias", "expert.features.denseblock3.dense_block.17.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.17.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.17.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.17.dense_layer.2.weight", "expert.features.denseblock3.dense_block.17.dense_layer.3.weight", "expert.features.denseblock3.dense_block.17.dense_layer.3.bias", "expert.features.denseblock3.dense_block.17.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.17.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.17.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.17.dense_layer.5.weight", "expert.features.denseblock3.dense_block.18.dense_layer.0.weight", "expert.features.denseblock3.dense_block.18.dense_layer.0.bias", "expert.features.denseblock3.dense_block.18.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.18.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.18.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.18.dense_layer.2.weight", "expert.features.denseblock3.dense_block.18.dense_layer.3.weight", "expert.features.denseblock3.dense_block.18.dense_layer.3.bias", "expert.features.denseblock3.dense_block.18.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.18.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.18.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.18.dense_layer.5.weight", "expert.features.denseblock3.dense_block.19.dense_layer.0.weight", "expert.features.denseblock3.dense_block.19.dense_layer.0.bias", "expert.features.denseblock3.dense_block.19.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.19.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.19.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.19.dense_layer.2.weight", "expert.features.denseblock3.dense_block.19.dense_layer.3.weight", "expert.features.denseblock3.dense_block.19.dense_layer.3.bias", "expert.features.denseblock3.dense_block.19.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.19.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.19.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.19.dense_layer.5.weight", "expert.features.denseblock3.dense_block.20.dense_layer.0.weight", "expert.features.denseblock3.dense_block.20.dense_layer.0.bias", "expert.features.denseblock3.dense_block.20.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.20.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.20.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.20.dense_layer.2.weight", "expert.features.denseblock3.dense_block.20.dense_layer.3.weight", "expert.features.denseblock3.dense_block.20.dense_layer.3.bias", "expert.features.denseblock3.dense_block.20.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.20.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.20.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.20.dense_layer.5.weight", "expert.features.denseblock3.dense_block.21.dense_layer.0.weight", "expert.features.denseblock3.dense_block.21.dense_layer.0.bias", "expert.features.denseblock3.dense_block.21.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.21.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.21.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.21.dense_layer.2.weight", "expert.features.denseblock3.dense_block.21.dense_layer.3.weight", "expert.features.denseblock3.dense_block.21.dense_layer.3.bias", "expert.features.denseblock3.dense_block.21.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.21.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.21.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.21.dense_layer.5.weight", "expert.features.denseblock3.dense_block.22.dense_layer.0.weight", "expert.features.denseblock3.dense_block.22.dense_layer.0.bias", "expert.features.denseblock3.dense_block.22.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.22.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.22.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.22.dense_layer.2.weight", "expert.features.denseblock3.dense_block.22.dense_layer.3.weight", "expert.features.denseblock3.dense_block.22.dense_layer.3.bias", "expert.features.denseblock3.dense_block.22.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.22.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.22.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.22.dense_layer.5.weight", "expert.features.denseblock3.dense_block.23.dense_layer.0.weight", "expert.features.denseblock3.dense_block.23.dense_layer.0.bias", "expert.features.denseblock3.dense_block.23.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.23.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.23.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.23.dense_layer.2.weight", "expert.features.denseblock3.dense_block.23.dense_layer.3.weight", "expert.features.denseblock3.dense_block.23.dense_layer.3.bias", "expert.features.denseblock3.dense_block.23.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.23.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.23.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.23.dense_layer.5.weight", "expert.features.transition3.transition_layer.0.weight", "expert.features.transition3.transition_layer.0.bias", "expert.features.transition3.transition_layer.0.running_mean", "expert.features.transition3.transition_layer.0.running_var", "expert.features.transition3.transition_layer.0.num_batches_tracked", "expert.features.transition3.transition_layer.2.weight", "expert.features.denseblock4.dense_block.0.dense_layer.0.weight", "expert.features.denseblock4.dense_block.0.dense_layer.0.bias", "expert.features.denseblock4.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.0.dense_layer.2.weight", "expert.features.denseblock4.dense_block.0.dense_layer.3.weight", "expert.features.denseblock4.dense_block.0.dense_layer.3.bias", "expert.features.denseblock4.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.0.dense_layer.5.weight", "expert.features.denseblock4.dense_block.1.dense_layer.0.weight", "expert.features.denseblock4.dense_block.1.dense_layer.0.bias", "expert.features.denseblock4.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.1.dense_layer.2.weight", "expert.features.denseblock4.dense_block.1.dense_layer.3.weight", "expert.features.denseblock4.dense_block.1.dense_layer.3.bias", "expert.features.denseblock4.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.1.dense_layer.5.weight", "expert.features.denseblock4.dense_block.2.dense_layer.0.weight", "expert.features.denseblock4.dense_block.2.dense_layer.0.bias", "expert.features.denseblock4.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.2.dense_layer.2.weight", "expert.features.denseblock4.dense_block.2.dense_layer.3.weight", "expert.features.denseblock4.dense_block.2.dense_layer.3.bias", "expert.features.denseblock4.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.2.dense_layer.5.weight", "expert.features.denseblock4.dense_block.3.dense_layer.0.weight", "expert.features.denseblock4.dense_block.3.dense_layer.0.bias", "expert.features.denseblock4.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.3.dense_layer.2.weight", "expert.features.denseblock4.dense_block.3.dense_layer.3.weight", "expert.features.denseblock4.dense_block.3.dense_layer.3.bias", "expert.features.denseblock4.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.3.dense_layer.5.weight", "expert.features.denseblock4.dense_block.4.dense_layer.0.weight", "expert.features.denseblock4.dense_block.4.dense_layer.0.bias", "expert.features.denseblock4.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.4.dense_layer.2.weight", "expert.features.denseblock4.dense_block.4.dense_layer.3.weight", "expert.features.denseblock4.dense_block.4.dense_layer.3.bias", "expert.features.denseblock4.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.4.dense_layer.5.weight", "expert.features.denseblock4.dense_block.5.dense_layer.0.weight", "expert.features.denseblock4.dense_block.5.dense_layer.0.bias", "expert.features.denseblock4.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.5.dense_layer.2.weight", "expert.features.denseblock4.dense_block.5.dense_layer.3.weight", "expert.features.denseblock4.dense_block.5.dense_layer.3.bias", "expert.features.denseblock4.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.5.dense_layer.5.weight", "expert.features.denseblock4.dense_block.6.dense_layer.0.weight", "expert.features.denseblock4.dense_block.6.dense_layer.0.bias", "expert.features.denseblock4.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.6.dense_layer.2.weight", "expert.features.denseblock4.dense_block.6.dense_layer.3.weight", "expert.features.denseblock4.dense_block.6.dense_layer.3.bias", "expert.features.denseblock4.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.6.dense_layer.5.weight", "expert.features.denseblock4.dense_block.7.dense_layer.0.weight", "expert.features.denseblock4.dense_block.7.dense_layer.0.bias", "expert.features.denseblock4.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.7.dense_layer.2.weight", "expert.features.denseblock4.dense_block.7.dense_layer.3.weight", "expert.features.denseblock4.dense_block.7.dense_layer.3.bias", "expert.features.denseblock4.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.7.dense_layer.5.weight", "expert.features.denseblock4.dense_block.8.dense_layer.0.weight", "expert.features.denseblock4.dense_block.8.dense_layer.0.bias", "expert.features.denseblock4.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.8.dense_layer.2.weight", "expert.features.denseblock4.dense_block.8.dense_layer.3.weight", "expert.features.denseblock4.dense_block.8.dense_layer.3.bias", "expert.features.denseblock4.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.8.dense_layer.5.weight", "expert.features.denseblock4.dense_block.9.dense_layer.0.weight", "expert.features.denseblock4.dense_block.9.dense_layer.0.bias", "expert.features.denseblock4.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.9.dense_layer.2.weight", "expert.features.denseblock4.dense_block.9.dense_layer.3.weight", "expert.features.denseblock4.dense_block.9.dense_layer.3.bias", "expert.features.denseblock4.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.9.dense_layer.5.weight", "expert.features.denseblock4.dense_block.10.dense_layer.0.weight", "expert.features.denseblock4.dense_block.10.dense_layer.0.bias", "expert.features.denseblock4.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.10.dense_layer.2.weight", "expert.features.denseblock4.dense_block.10.dense_layer.3.weight", "expert.features.denseblock4.dense_block.10.dense_layer.3.bias", "expert.features.denseblock4.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.10.dense_layer.5.weight", "expert.features.denseblock4.dense_block.11.dense_layer.0.weight", "expert.features.denseblock4.dense_block.11.dense_layer.0.bias", "expert.features.denseblock4.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.11.dense_layer.2.weight", "expert.features.denseblock4.dense_block.11.dense_layer.3.weight", "expert.features.denseblock4.dense_block.11.dense_layer.3.bias", "expert.features.denseblock4.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.11.dense_layer.5.weight", "expert.features.denseblock4.dense_block.12.dense_layer.0.weight", "expert.features.denseblock4.dense_block.12.dense_layer.0.bias", "expert.features.denseblock4.dense_block.12.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.12.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.12.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.12.dense_layer.2.weight", "expert.features.denseblock4.dense_block.12.dense_layer.3.weight", "expert.features.denseblock4.dense_block.12.dense_layer.3.bias", "expert.features.denseblock4.dense_block.12.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.12.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.12.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.12.dense_layer.5.weight", "expert.features.denseblock4.dense_block.13.dense_layer.0.weight", "expert.features.denseblock4.dense_block.13.dense_layer.0.bias", "expert.features.denseblock4.dense_block.13.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.13.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.13.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.13.dense_layer.2.weight", "expert.features.denseblock4.dense_block.13.dense_layer.3.weight", "expert.features.denseblock4.dense_block.13.dense_layer.3.bias", "expert.features.denseblock4.dense_block.13.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.13.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.13.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.13.dense_layer.5.weight", "expert.features.denseblock4.dense_block.14.dense_layer.0.weight", "expert.features.denseblock4.dense_block.14.dense_layer.0.bias", "expert.features.denseblock4.dense_block.14.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.14.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.14.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.14.dense_layer.2.weight", "expert.features.denseblock4.dense_block.14.dense_layer.3.weight", "expert.features.denseblock4.dense_block.14.dense_layer.3.bias", "expert.features.denseblock4.dense_block.14.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.14.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.14.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.14.dense_layer.5.weight", "expert.features.denseblock4.dense_block.15.dense_layer.0.weight", "expert.features.denseblock4.dense_block.15.dense_layer.0.bias", "expert.features.denseblock4.dense_block.15.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.15.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.15.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.15.dense_layer.2.weight", "expert.features.denseblock4.dense_block.15.dense_layer.3.weight", "expert.features.denseblock4.dense_block.15.dense_layer.3.bias", "expert.features.denseblock4.dense_block.15.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.15.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.15.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.15.dense_layer.5.weight", "expert.features.norm_final.weight", "expert.features.norm_final.bias", "expert.features.norm_final.running_mean", "expert.features.norm_final.running_var", "expert.features.norm_final.num_batches_tracked", "expert.classifier.weight", "expert.classifier.bias". 

============================================================
POST-TRAINING: Gaussian Noise Robustness
============================================================

Testing Expert 0 (POST-TRAINING) under Gaussian noise...

Testing Expert 1 (POST-TRAINING) under Gaussian noise...

Testing Expert 2 (POST-TRAINING) under Gaussian noise...

Testing Expert 3 (POST-TRAINING) under Gaussian noise...

Testing Trained Fusion Model under Gaussian noise...

============================================================
POST-TRAINING: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 29.64% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.60% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.13% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 43.43% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.77% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 62.63% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 54.32% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 41.55% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.41% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.15% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.14% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.30% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 44.54% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.57% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 44.66% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 15.16% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.83% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.69% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.92% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.36% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.81% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 76.65% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 76.61% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.07% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 33.76% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 17.33% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 76.98% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.71% accuracy

Testing Expert 1 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 35.99% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 18.31% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.12% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 13.14% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 59.05% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 35.45% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 57.87% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 46.93% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 73.53% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 73.25% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.85% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 22.01% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 50.36% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 21.82% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 49.95% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 20.17% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.58% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.10% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 73.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 72.83% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 73.55% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 73.09% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 72.73% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 70.89% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 28.52% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 14.28% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 73.60% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 73.64% accuracy

Testing Expert 2 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 42.68% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 23.85% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.59% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 28.74% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 70.47% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 53.91% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 64.27% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 54.06% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 79.34% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 78.92% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.30% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.43% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 56.20% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.76% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 56.64% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 25.39% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 8.53% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.73% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 79.16% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 78.74% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 79.09% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 78.70% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 78.23% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 77.55% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 41.55% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.05% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 79.02% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 79.08% accuracy

Testing Expert 3 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 52.34% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 35.80% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.50% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 36.69% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.59% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 60.90% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 66.52% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 60.25% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.54% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 76.85% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 39.40% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 14.37% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 62.07% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.22% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 62.27% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 37.62% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 15.00% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 4.08% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 77.28% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.67% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 77.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.12% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 76.88% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.27% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 48.11% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 37.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 77.46% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 77.10% accuracy

Testing Trained Fusion Model on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 44.46% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.25% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.17% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 42.55% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 76.11% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 65.01% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 65.23% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 55.68% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 81.17% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 80.81% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.56% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.67% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 57.60% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 25.44% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 58.48% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 25.54% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 7.51% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.52% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 80.48% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 80.45% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 80.63% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 80.49% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 80.26% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 79.83% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 44.12% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 24.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 80.64% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 80.57% accuracy

============================================================
POST-TRAINING: Out-of-Distribution Detection
============================================================

Testing Expert 0 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 1 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 2 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 3 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Trained Fusion Model on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

✅ POST-TRAINING evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicativeAddition_alpha_0.5_post_training_evaluation.csv

================================================================================
PHASE 4: COMPREHENSIVE ROBUSTNESS EVALUATION (α=0.5)
================================================================================

🔍 Running comprehensive robustness evaluation...

================================================================================
Starting Phase 1, 2 & 3 Robustness Evaluation for DenseNet multiplicativeAddition (α=0.5)
================================================================================
📊 OOD evaluation CSV created: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/ood_evaluation_multiplicativeAddition_alpha_0.5_20250902_181204.csv

Loading baseline DenseNet model from: ../../expert_training/scripts/checkpoints_expert_full_dataset_benchmark_250/best_full_dataset_densenet121_benchmark_250.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_densenet_fusions.py:95: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location=device)
Files already downloaded and verified

============================================================
GAUSSIAN NOISE ROBUSTNESS
============================================================
Evaluating sigmas: [0.0, 0.05, 0.1, 0.2, 0.3]

Testing Expert 0 under Gaussian noise...
  Expert 0 noise results: σ=0.0: 77.08%, σ=0.05: 69.56%, σ=0.1: 48.83%, σ=0.2: 17.53%, σ=0.3: 7.48%

Testing Expert 1 under Gaussian noise...
  Expert 1 noise results: σ=0.0: 73.87%, σ=0.05: 68.50%, σ=0.1: 52.76%, σ=0.2: 21.81%, σ=0.3: 8.60%

Testing Expert 2 under Gaussian noise...
  Expert 2 noise results: σ=0.0: 79.28%, σ=0.05: 74.27%, σ=0.1: 59.64%, σ=0.2: 28.55%, σ=0.3: 13.32%

Testing Expert 3 under Gaussian noise...
  Expert 3 noise results: σ=0.0: 77.63%, σ=0.05: 73.39%, σ=0.1: 64.11%, σ=0.2: 40.83%, σ=0.3: 23.14%

Testing Baseline DenseNet under Gaussian noise...
  Baseline noise results: σ=0.0: 83.69%, σ=0.05: 76.60%, σ=0.1: 56.68%, σ=0.2: 28.13%, σ=0.3: 16.19%

Testing Global Fusion Model under Gaussian noise...
  Fusion noise results: σ=0.0: 80.65%, σ=0.05: 75.79%, σ=0.1: 61.60%, σ=0.2: 29.30%, σ=0.3: 12.57%

============================================================
PHASE 1: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 30.01% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.55% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.10% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 44.28% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.12% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 61.94% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 54.50% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 41.36% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.41% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.15% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.14% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.30% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 45.12% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.68% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 44.54% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 14.90% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.87% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.69% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.92% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.36% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.81% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 76.65% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 76.53% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 75.92% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 33.76% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 17.33% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 76.82% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.73% accuracy
  Expert 0 Average Corruption Accuracy: 47.77%

Testing Expert 1 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 36.13% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 19.28% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.26% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 13.01% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 59.14% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 36.06% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 57.52% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 46.98% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 73.53% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 73.25% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.85% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 22.01% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 50.30% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 21.84% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 50.36% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 20.09% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.79% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.94% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 73.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 72.83% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 73.55% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 73.09% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 72.45% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 71.07% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 28.52% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 14.28% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 73.77% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 73.67% accuracy
  Expert 1 Average Corruption Accuracy: 45.36%

Testing Expert 2 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 43.14% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 23.64% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.55% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 29.03% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 70.02% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 53.23% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 63.72% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 53.90% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 79.34% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 78.92% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.30% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.43% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 56.13% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.90% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 56.81% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 25.50% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 8.48% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.97% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 79.16% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 78.74% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 79.09% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 78.70% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 78.31% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.89% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 41.55% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.05% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 79.13% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 79.07% accuracy
  Expert 2 Average Corruption Accuracy: 51.17%

Testing Expert 3 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 52.47% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 36.50% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.66% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 37.07% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.30% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 60.19% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 66.49% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 60.35% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.54% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 76.85% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 39.40% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 14.37% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 62.25% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.46% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 62.76% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 37.98% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 15.34% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 4.16% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 77.28% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.67% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 77.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.12% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 77.33% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 75.74% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 48.11% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 37.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 77.34% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 77.40% accuracy
  Expert 3 Average Corruption Accuracy: 54.34%

Testing Baseline DenseNet on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 39.55% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.39% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 10.21% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 51.89% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 78.72% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 69.04% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 61.51% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 50.04% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 83.25% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 82.94% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 60.76% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 25.22% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 51.94% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.15% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 52.47% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 24.28% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 11.41% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.49% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 83.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 83.18% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 83.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 83.32% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 83.19% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 82.54% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 43.60% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.61% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 83.55% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 83.61% accuracy
  Baseline DenseNet Average Corruption Accuracy: 54.88%

Testing Global Fusion Model on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 44.60% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.32% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.18% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 42.64% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 75.47% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 64.78% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 65.23% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 55.59% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 81.17% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 80.81% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.56% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.67% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 57.82% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 25.72% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 58.39% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 25.51% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 7.64% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.64% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 80.48% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 80.45% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 80.63% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 80.49% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 80.32% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 79.62% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 44.12% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 24.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 80.73% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 80.70% accuracy
  Global Fusion Model Average Corruption Accuracy: 53.47%

============================================================
PHASE 3: Out-of-Distribution Detection
============================================================

4. OOD Detection Evaluation
------------------------------------------------------------

Testing Expert 0 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 0 OOD Results:
    Expert 0 OOD (cifar10): AUROC=0.7218, AUPR=0.7021, FPR95=0.8417
    Expert 0 OOD (svhn): AUROC=0.8127, AUPR=0.9014, FPR95=0.6371
    Expert 0 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 0 OOD (synthetic_gaussian): AUROC=0.9424, AUPR=0.9269, FPR95=0.2054
    Expert 0 OOD (synthetic_uniform): AUROC=0.9235, AUPR=0.8929, FPR95=0.2248

Testing Expert 1 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 1 OOD Results:
    Expert 1 OOD (cifar10): AUROC=0.7149, AUPR=0.6871, FPR95=0.7999
    Expert 1 OOD (svhn): AUROC=0.8081, AUPR=0.9017, FPR95=0.5867
    Expert 1 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 1 OOD (synthetic_gaussian): AUROC=0.9960, AUPR=0.9954, FPR95=0.0192
    Expert 1 OOD (synthetic_uniform): AUROC=0.9958, AUPR=0.9953, FPR95=0.0195

Testing Expert 2 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 2 OOD Results:
    Expert 2 OOD (cifar10): AUROC=0.6684, AUPR=0.6717, FPR95=0.9058
    Expert 2 OOD (svhn): AUROC=0.5885, AUPR=0.8033, FPR95=0.9400
    Expert 2 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 2 OOD (synthetic_gaussian): AUROC=0.7862, AUPR=0.6919, FPR95=0.5316
    Expert 2 OOD (synthetic_uniform): AUROC=0.7833, AUPR=0.6832, FPR95=0.5263

Testing Expert 3 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 3 OOD Results:
    Expert 3 OOD (cifar10): AUROC=0.7785, AUPR=0.7409, FPR95=0.6420
    Expert 3 OOD (svhn): AUROC=0.8180, AUPR=0.8931, FPR95=0.5228
    Expert 3 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 3 OOD (synthetic_gaussian): AUROC=0.8422, AUPR=0.7317, FPR95=0.3182
    Expert 3 OOD (synthetic_uniform): AUROC=0.9050, AUPR=0.7991, FPR95=0.1742

Testing Baseline DenseNet on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Baseline DenseNet OOD Results:
    Baseline DenseNet OOD (cifar10): AUROC=0.6751, AUPR=0.7001, FPR95=0.9430
    Baseline DenseNet OOD (svhn): AUROC=0.8385, AUPR=0.9338, FPR95=0.7609
    Baseline DenseNet OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Baseline DenseNet OOD (synthetic_gaussian): AUROC=0.8120, AUPR=0.7160, FPR95=0.4964
    Baseline DenseNet OOD (synthetic_uniform): AUROC=0.6909, AUPR=0.6073, FPR95=0.7263

Testing Global Fusion Model on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Global Fusion Model OOD Results:
    Fusion Model OOD (cifar10): AUROC=0.7515, AUPR=0.7298, FPR95=0.7335
    Fusion Model OOD (svhn): AUROC=0.8466, AUPR=0.9253, FPR95=0.5782
    Fusion Model OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Fusion Model OOD (synthetic_gaussian): AUROC=0.9570, AUPR=0.9211, FPR95=0.1105
    Fusion Model OOD (synthetic_uniform): AUROC=0.8727, AUPR=0.7623, FPR95=0.2555

✅ Robustness evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicativeAddition_alpha_0.5_robustness_evaluation.csv
   OOD results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/ood_evaluation_multiplicativeAddition_alpha_0.5_20250902_181204.csv
   Model types tested: Experts, Baseline, Global Fusion Model
   Test types: CIFAR-100-C corruptions + OOD detection + Gaussian noise
✅ Experiment 6 completed: MIXED multiplicativeAddition fusion, alpha=0.5 (Alpha Ablation Full Eval)
