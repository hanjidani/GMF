==========================================
SLURM_JOB_ID = 10922
SLURM_NODELIST = pascal-node09.l3s.intra
==========================================
==========================================
Mixed-Experts Alpha Ablation (Full Eval) Experiment 3: multiplicative fusion, alpha=5.0
SLURM_JOB_ID = 
SLURM_NODELIST = 
Alpha: 5.0
Augmentation: CutMix (Î±=1.0) + Label Smoothing (0.1) + Grad Clip (1.0)
No LR schedulers (fixed LR); Full evaluation enabled
==========================================
Starting MIXED EXPERTS multiplicative fusion training (alpha-ablation, full evaluation, no schedulers)...
Alpha: 5.0
Checkpoint directory: ../../expert_training/scripts/checkpoints_expert_iid
Output directory: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0
Using device: cuda
Loading heterogeneous expert backbones (DenseNet121, ResNet18, WRN-28-10, PreAct-ResNeXt-29 8x64d)...
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:125: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(checkpoint_path, map_location=device)
Successfully loaded 4 heterogeneous experts
Loading baseline DenseNet model from: ../../expert_training/scripts/checkpoints_expert_full_dataset_benchmark_250/best_full_dataset_densenet121_benchmark_250.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_densenet_fusions.py:95: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location=device)
Creating Mixed-Experts MCN fusion model (adapting features to 1024)...
âœ… Successfully created Mixed-Experts MCN fusion model
Files already downloaded and verified

============================================================
PRE-TRAINING: Clean Test Evaluation of Each Expert (CIFAR-100)
============================================================
  Expert 0 Clean Test: Acc=74.76% Loss=1.0872
  Expert 1 Clean Test: Acc=71.10% Loss=1.3230
  Expert 2 Clean Test: Acc=78.18% Loss=1.0137
  Expert 3 Clean Test: Acc=76.20% Loss=1.1990

================================================================================
PHASE 1: PRE-TRAINING EVALUATION (Î±=5.0)
================================================================================

============================================================
PRE-TRAINING: Gaussian Noise Robustness
============================================================

Testing Expert 0 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: Ïƒ=0.0: 74.76%, Ïƒ=0.05: 68.02%, Ïƒ=0.1: 48.66%, Ïƒ=0.2: 17.68%, Ïƒ=0.3: 7.98%

Testing Expert 1 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: Ïƒ=0.0: 71.10%, Ïƒ=0.05: 64.46%, Ïƒ=0.1: 43.69%, Ïƒ=0.2: 13.79%, Ïƒ=0.3: 5.72%

Testing Expert 2 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: Ïƒ=0.0: 78.18%, Ïƒ=0.05: 74.99%, Ïƒ=0.1: 62.87%, Ïƒ=0.2: 32.09%, Ïƒ=0.3: 14.35%

Testing Expert 3 (PRE-TRAINING) under Gaussian noise...
  Expert noise results: Ïƒ=0.0: 76.20%, Ïƒ=0.05: 72.96%, Ïƒ=0.1: 65.20%, Ïƒ=0.2: 42.36%, Ïƒ=0.3: 23.19%

Testing Baseline DenseNet (PRE-TRAINING) under Gaussian noise...
  Baseline noise results: Ïƒ=0.0: 83.69%, Ïƒ=0.05: 76.31%, Ïƒ=0.1: 56.45%, Ïƒ=0.2: 27.45%, Ïƒ=0.3: 15.89%

============================================================
PRE-TRAINING: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 30.10% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.26% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 6.26% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 43.55% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 70.43% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 61.42% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 54.26% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 41.59% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 74.65% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 74.52% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.64% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 21.78% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 44.43% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.42% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 43.56% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 15.05% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.42% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.45% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 74.41% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 74.04% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 74.53% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 74.27% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 74.36% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 73.73% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 34.62% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 18.02% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 74.63% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 74.80% accuracy

Testing Expert 1 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 26.26% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 11.78% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 1.34% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 4.41% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 41.66% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 14.24% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 49.71% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 37.21% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 71.38% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 70.75% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 51.81% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 22.25% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 41.42% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 14.78% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 40.92% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 12.61% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.03% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.54% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 71.01% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 70.43% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 70.86% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 70.69% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 69.91% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 67.60% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 24.11% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 11.86% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 71.16% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 71.28% accuracy

Testing Expert 2 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 46.74% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 26.53% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.35% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 26.82% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 65.96% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 49.30% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 66.25% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 57.10% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 78.38% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 78.27% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 48.34% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.52% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 59.39% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 27.86% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 59.65% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 27.99% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 8.61% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.57% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 78.11% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 77.95% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 78.20% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.92% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 77.75% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.77% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 48.90% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 30.15% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 78.05% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 78.19% accuracy

Testing Expert 3 (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 53.79% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 37.21% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.24% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 33.41% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 71.90% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 57.74% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.17% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 61.63% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 76.52% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 76.17% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 41.64% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 15.57% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 62.98% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.83% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 63.52% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 39.73% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 14.86% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.19% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.23% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 75.74% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.03% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 75.67% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 75.51% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 74.65% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 49.79% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 40.57% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 76.04% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.20% accuracy

Testing Baseline DenseNet (PRE-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 39.47% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.02% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 10.19% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 52.47% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 79.06% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 69.45% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 61.46% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 50.11% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 83.25% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 82.94% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 60.76% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 25.22% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 51.81% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.20% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 52.52% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 24.13% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 11.10% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.71% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 83.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 83.18% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 83.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 83.32% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 83.15% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 82.38% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 43.60% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.61% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 83.41% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 83.53% accuracy

============================================================
PRE-TRAINING: Out-of-Distribution Detection
============================================================

Testing Expert 0 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 1 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 2 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 3 (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Baseline DenseNet (PRE-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

âœ… PRE-TRAINING evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicative_alpha_5.0_pre_training_evaluation.csv

================================================================================
PHASE 2: FUSION TRAINING (Î±=5.0)
================================================================================
Loading data splits for fusion training...
Files already downloaded and verified
Loaded 10000 fusion holdout samples for training.
âœ… Using SOTA augmentation: DenseNet with moderate augmentation for stability
Files already downloaded and verified
Files already downloaded and verified
Using 10000 samples from the official test set for validation.
âœ… Data splits loaded successfully
CSV logging setup: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicative_alpha_5.0_training_log.csv
  - Experiment Output: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative

ðŸš€ Starting Mixed-Experts multiplicative fusion training with alpha=5.0 (no schedulers)...
   Augmentation: CUTMIX, MixUp Î±=0.2, CutMix Î±=1.0, Label Smoothing=0.1, Grad Clip=1.0
Total parameters: 92,712,644
Trainable parameters: 92,712,644
Epoch 1/40, Batch 0/79, Loss: 67.4455 (Global: 4.6128, Individual: 12.5665)
Epoch 1/40, Batch 50/79, Loss: 42.3672 (Global: 2.3284, Individual: 8.0077)
  ðŸ”¸ Saved new best Expert 0 (test acc 74.99%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 70.46%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
  ðŸ”¸ Saved new best Expert 2 (test acc 78.34%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
  ðŸ”¸ Saved new best Expert 3 (test acc 77.80%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_3_best.pth
Epoch 1/40:
  Train Loss: 57.8389, Train Acc: 36.97%
  Val   Loss: 22.9395, Val   Acc: 74.33%
  Test Accuracies: Global: 74.34% | Expert 0: 74.99%, Expert 1: 70.46%, Expert 2: 78.34%, Expert 3: 77.80%
  ðŸ”¸ Saved new best Fusion Module (test acc 74.34%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 74.34%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 74.34%
Epoch 2/40, Batch 0/79, Loss: 63.6427 (Global: 3.4789, Individual: 12.0328)
Epoch 2/40, Batch 50/79, Loss: 43.5830 (Global: 2.1221, Individual: 8.2922)
  ðŸ”¸ Saved new best Expert 0 (test acc 75.35%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 71.49%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
  ðŸ”¸ Saved new best Expert 2 (test acc 78.77%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 2/40:
  Train Loss: 56.1553, Train Acc: 53.40%
  Val   Loss: 22.2706, Val   Acc: 77.54%
  Test Accuracies: Global: 77.56% | Expert 0: 75.35%, Expert 1: 71.49%, Expert 2: 78.77%, Expert 3: 77.75%
  ðŸ”¸ Saved new best Fusion Module (test acc 77.56%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 77.56%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 77.56%
Epoch 3/40, Batch 0/79, Loss: 58.9486 (Global: 2.8569, Individual: 11.2183)
Epoch 3/40, Batch 50/79, Loss: 52.4828 (Global: 2.4752, Individual: 10.0015)
  ðŸ”¸ Saved new best Expert 0 (test acc 75.72%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 71.61%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
  ðŸ”¸ Saved new best Expert 2 (test acc 78.91%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 3/40:
  Train Loss: 55.1044, Train Acc: 57.10%
  Val   Loss: 21.8821, Val   Acc: 78.48%
  Test Accuracies: Global: 78.43% | Expert 0: 75.72%, Expert 1: 71.61%, Expert 2: 78.91%, Expert 3: 77.67%
  ðŸ”¸ Saved new best Fusion Module (test acc 78.43%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 78.43%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 78.43%
Epoch 4/40, Batch 0/79, Loss: 61.4650 (Global: 2.9647, Individual: 11.7000)
Epoch 4/40, Batch 50/79, Loss: 58.1040 (Global: 2.8031, Individual: 11.0602)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.04%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 71.87%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
  ðŸ”¸ Saved new best Expert 2 (test acc 79.14%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 4/40:
  Train Loss: 56.0333, Train Acc: 53.45%
  Val   Loss: 22.2275, Val   Acc: 78.43%
  Test Accuracies: Global: 78.43% | Expert 0: 76.04%, Expert 1: 71.87%, Expert 2: 79.14%, Expert 3: 77.04%
  ðŸ“Š Training progress logged to CSV
Epoch 5/40, Batch 0/79, Loss: 63.2716 (Global: 3.0256, Individual: 12.0492)
Epoch 5/40, Batch 50/79, Loss: 61.0225 (Global: 2.9577, Individual: 11.6130)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.16%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 72.25%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 5/40:
  Train Loss: 55.3907, Train Acc: 54.17%
  Val   Loss: 22.0415, Val   Acc: 78.76%
  Test Accuracies: Global: 78.80% | Expert 0: 76.16%, Expert 1: 72.25%, Expert 2: 78.75%, Expert 3: 77.02%
  ðŸ”¸ Saved new best Fusion Module (test acc 78.80%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 78.80%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 78.80%
Epoch 6/40, Batch 0/79, Loss: 46.3518 (Global: 2.0833, Individual: 8.8537)
Epoch 6/40, Batch 50/79, Loss: 44.2299 (Global: 1.9664, Individual: 8.4527)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.27%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 72.73%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
  ðŸ”¸ Saved new best Expert 2 (test acc 79.40%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 6/40:
  Train Loss: 54.7403, Train Acc: 57.44%
  Val   Loss: 21.6379, Val   Acc: 79.64%
  Test Accuracies: Global: 79.64% | Expert 0: 76.27%, Expert 1: 72.73%, Expert 2: 79.40%, Expert 3: 77.77%
  ðŸ”¸ Saved new best Fusion Module (test acc 79.64%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 79.64%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 79.64%
Epoch 7/40, Batch 0/79, Loss: 62.5290 (Global: 2.9850, Individual: 11.9088)
Epoch 7/40, Batch 50/79, Loss: 57.9037 (Global: 2.7234, Individual: 11.0361)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.36%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
Epoch 7/40:
  Train Loss: 53.3469, Train Acc: 60.44%
  Val   Loss: 21.8935, Val   Acc: 79.26%
  Test Accuracies: Global: 79.28% | Expert 0: 76.36%, Expert 1: 72.58%, Expert 2: 78.91%, Expert 3: 76.90%
  ðŸ“Š Training progress logged to CSV
Epoch 8/40, Batch 0/79, Loss: 59.2386 (Global: 2.9325, Individual: 11.2612)
Epoch 8/40, Batch 50/79, Loss: 53.3124 (Global: 2.4507, Individual: 10.1723)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.72%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 72.94%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 8/40:
  Train Loss: 53.3766, Train Acc: 60.02%
  Val   Loss: 21.4140, Val   Acc: 79.39%
  Test Accuracies: Global: 79.39% | Expert 0: 76.72%, Expert 1: 72.94%, Expert 2: 79.31%, Expert 3: 76.87%
  ðŸ“Š Training progress logged to CSV
Epoch 9/40, Batch 0/79, Loss: 43.5303 (Global: 1.9590, Individual: 8.3143)
Epoch 9/40, Batch 50/79, Loss: 48.7985 (Global: 2.2124, Individual: 9.3172)
Epoch 9/40:
  Train Loss: 51.5941, Train Acc: 63.08%
  Val   Loss: 21.5872, Val   Acc: 78.96%
  Test Accuracies: Global: 78.96% | Expert 0: 76.59%, Expert 1: 72.85%, Expert 2: 78.99%, Expert 3: 76.40%
  ðŸ“Š Training progress logged to CSV
Epoch 10/40, Batch 0/79, Loss: 37.1467 (Global: 1.6219, Individual: 7.1050)
Epoch 10/40, Batch 50/79, Loss: 46.7851 (Global: 2.1567, Individual: 8.9257)
Epoch 10/40:
  Train Loss: 53.1721, Train Acc: 60.29%
  Val   Loss: 21.8397, Val   Acc: 79.65%
  Test Accuracies: Global: 79.65% | Expert 0: 76.69%, Expert 1: 72.81%, Expert 2: 79.15%, Expert 3: 76.34%
  ðŸ”¸ Saved new best Fusion Module (test acc 79.65%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 79.65%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 79.65%
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/checkpoint_epoch_10.pth
Epoch 11/40, Batch 0/79, Loss: 56.1676 (Global: 2.5885, Individual: 10.7158)
Epoch 11/40, Batch 50/79, Loss: 60.7119 (Global: 2.8053, Individual: 11.5813)
  ðŸ”¸ Saved new best Expert 1 (test acc 73.07%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 11/40:
  Train Loss: 53.3200, Train Acc: 59.69%
  Val   Loss: 21.6354, Val   Acc: 79.13%
  Test Accuracies: Global: 79.15% | Expert 0: 76.54%, Expert 1: 73.07%, Expert 2: 79.01%, Expert 3: 76.43%
  ðŸ“Š Training progress logged to CSV
Epoch 12/40, Batch 0/79, Loss: 60.5822 (Global: 2.8647, Individual: 11.5435)
Epoch 12/40, Batch 50/79, Loss: 55.1658 (Global: 2.4038, Individual: 10.5524)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.76%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
Epoch 12/40:
  Train Loss: 52.4309, Train Acc: 61.22%
  Val   Loss: 22.0335, Val   Acc: 78.90%
  Test Accuracies: Global: 78.87% | Expert 0: 76.76%, Expert 1: 72.98%, Expert 2: 78.79%, Expert 3: 75.89%
  ðŸ“Š Training progress logged to CSV
Epoch 13/40, Batch 0/79, Loss: 54.4804 (Global: 2.4894, Individual: 10.3982)
Epoch 13/40, Batch 50/79, Loss: 49.5347 (Global: 2.1753, Individual: 9.4719)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.88%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 73.37%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 13/40:
  Train Loss: 51.2888, Train Acc: 59.99%
  Val   Loss: 21.7566, Val   Acc: 79.42%
  Test Accuracies: Global: 79.43% | Expert 0: 76.88%, Expert 1: 73.37%, Expert 2: 79.06%, Expert 3: 76.71%
  ðŸ“Š Training progress logged to CSV
Epoch 14/40, Batch 0/79, Loss: 59.0204 (Global: 2.6462, Individual: 11.2749)
Epoch 14/40, Batch 50/79, Loss: 51.7816 (Global: 2.3254, Individual: 9.8912)
  ðŸ”¸ Saved new best Expert 0 (test acc 76.96%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
  ðŸ”¸ Saved new best Expert 1 (test acc 73.55%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 14/40:
  Train Loss: 52.2514, Train Acc: 61.43%
  Val   Loss: 22.2803, Val   Acc: 79.02%
  Test Accuracies: Global: 78.99% | Expert 0: 76.96%, Expert 1: 73.55%, Expert 2: 78.70%, Expert 3: 76.29%
  ðŸ“Š Training progress logged to CSV
Epoch 15/40, Batch 0/79, Loss: 34.6792 (Global: 1.4073, Individual: 6.6544)
Epoch 15/40, Batch 50/79, Loss: 60.1197 (Global: 2.7394, Individual: 11.4761)
  ðŸ”¸ Saved new best Expert 0 (test acc 77.00%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
Epoch 15/40:
  Train Loss: 49.9285, Train Acc: 67.09%
  Val   Loss: 22.1103, Val   Acc: 78.96%
  Test Accuracies: Global: 78.97% | Expert 0: 77.00%, Expert 1: 73.43%, Expert 2: 78.50%, Expert 3: 76.28%
  ðŸ“Š Training progress logged to CSV
Epoch 16/40, Batch 0/79, Loss: 34.5132 (Global: 1.4267, Individual: 6.6173)
Epoch 16/40, Batch 50/79, Loss: 51.8645 (Global: 2.3271, Individual: 9.9075)
  ðŸ”¸ Saved new best Expert 0 (test acc 77.17%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
Epoch 16/40:
  Train Loss: 49.9977, Train Acc: 65.92%
  Val   Loss: 22.0000, Val   Acc: 78.75%
  Test Accuracies: Global: 78.77% | Expert 0: 77.17%, Expert 1: 73.51%, Expert 2: 78.27%, Expert 3: 76.12%
  ðŸ“Š Training progress logged to CSV
Epoch 17/40, Batch 0/79, Loss: 57.9390 (Global: 2.6255, Individual: 11.0627)
Epoch 17/40, Batch 50/79, Loss: 36.9181 (Global: 1.5206, Individual: 7.0795)
Epoch 17/40:
  Train Loss: 50.5878, Train Acc: 62.94%
  Val   Loss: 22.0756, Val   Acc: 78.73%
  Test Accuracies: Global: 78.71% | Expert 0: 76.85%, Expert 1: 73.47%, Expert 2: 78.53%, Expert 3: 76.07%
  ðŸ“Š Training progress logged to CSV
Epoch 18/40, Batch 0/79, Loss: 55.6279 (Global: 2.4885, Individual: 10.6279)
Epoch 18/40, Batch 50/79, Loss: 47.5149 (Global: 2.1109, Individual: 9.0808)
  ðŸ”¸ Saved new best Expert 1 (test acc 73.71%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 18/40:
  Train Loss: 50.0152, Train Acc: 66.41%
  Val   Loss: 22.5644, Val   Acc: 79.06%
  Test Accuracies: Global: 79.06% | Expert 0: 77.14%, Expert 1: 73.71%, Expert 2: 78.67%, Expert 3: 75.81%
  ðŸ“Š Training progress logged to CSV
Epoch 19/40, Batch 0/79, Loss: 39.9400 (Global: 1.6210, Individual: 7.6638)
Epoch 19/40, Batch 50/79, Loss: 61.6124 (Global: 2.8585, Individual: 11.7508)
  ðŸ”¸ Saved new best Expert 1 (test acc 73.75%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 19/40:
  Train Loss: 49.9855, Train Acc: 66.64%
  Val   Loss: 22.5883, Val   Acc: 78.87%
  Test Accuracies: Global: 78.88% | Expert 0: 77.17%, Expert 1: 73.75%, Expert 2: 78.23%, Expert 3: 75.63%
  ðŸ“Š Training progress logged to CSV
Epoch 20/40, Batch 0/79, Loss: 39.2997 (Global: 1.7201, Individual: 7.5159)
Epoch 20/40, Batch 50/79, Loss: 34.5973 (Global: 1.4447, Individual: 6.6305)
Epoch 20/40:
  Train Loss: 49.5072, Train Acc: 67.09%
  Val   Loss: 22.3011, Val   Acc: 78.99%
  Test Accuracies: Global: 79.03% | Expert 0: 77.01%, Expert 1: 73.66%, Expert 2: 78.82%, Expert 3: 75.54%
  ðŸ“Š Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/checkpoint_epoch_20.pth

================ STAGE TRANSITION ================
Loading best expert checkpoints (by test acc) and freezing expert backbones...
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:473: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
  ðŸ”’ Expert 0 frozen (adapter remains trainable)
  ðŸ”’ Expert 1 frozen (adapter remains trainable)
  ðŸ”’ Expert 2 frozen (adapter remains trainable)
  ðŸ”’ Expert 3 frozen (adapter remains trainable)
Stage 2: Training adapters + fusion + global head only for remaining epochs.
Epoch 21/40, Batch 0/79, Loss: 31.8942 (Global: 1.3734, Individual: 6.1042)
Epoch 21/40, Batch 50/79, Loss: 59.3070 (Global: 2.8385, Individual: 11.2937)
Epoch 21/40:
  Train Loss: 51.3402, Train Acc: 62.17%
  Val   Loss: 20.6188, Val   Acc: 80.27%
  Test Accuracies: Global: 80.28% | Expert 0: 76.98%, Expert 1: 73.65%, Expert 2: 79.40%, Expert 3: 77.76%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.28%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.28%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.28%
Epoch 22/40, Batch 0/79, Loss: 58.9242 (Global: 2.6706, Individual: 11.2507)
Epoch 22/40, Batch 50/79, Loss: 65.6481 (Global: 3.1107, Individual: 12.5075)
Epoch 22/40:
  Train Loss: 53.5490, Train Acc: 56.76%
  Val   Loss: 21.3286, Val   Acc: 79.67%
  Test Accuracies: Global: 79.69% | Expert 0: 77.06%, Expert 1: 73.66%, Expert 2: 79.25%, Expert 3: 77.57%
  ðŸ“Š Training progress logged to CSV
Epoch 23/40, Batch 0/79, Loss: 58.2911 (Global: 2.6384, Individual: 11.1305)
Epoch 23/40, Batch 50/79, Loss: 54.3195 (Global: 2.5353, Individual: 10.3568)
  ðŸ”¸ Saved new best Expert 2 (test acc 79.45%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
  ðŸ”¸ Saved new best Expert 3 (test acc 77.84%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_3_best.pth
Epoch 23/40:
  Train Loss: 53.8318, Train Acc: 59.99%
  Val   Loss: 21.0530, Val   Acc: 80.17%
  Test Accuracies: Global: 80.19% | Expert 0: 77.06%, Expert 1: 73.55%, Expert 2: 79.45%, Expert 3: 77.84%
  ðŸ“Š Training progress logged to CSV
Epoch 24/40, Batch 0/79, Loss: 42.8649 (Global: 1.8432, Individual: 8.2043)
Epoch 24/40, Batch 50/79, Loss: 59.1014 (Global: 2.7842, Individual: 11.2634)
Epoch 24/40:
  Train Loss: 52.9865, Train Acc: 59.44%
  Val   Loss: 21.0850, Val   Acc: 80.43%
  Test Accuracies: Global: 80.42% | Expert 0: 77.01%, Expert 1: 73.70%, Expert 2: 79.39%, Expert 3: 77.76%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.42%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.42%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.42%
Epoch 25/40, Batch 0/79, Loss: 49.8835 (Global: 2.1837, Individual: 9.5400)
Epoch 25/40, Batch 50/79, Loss: 39.2351 (Global: 1.7044, Individual: 7.5062)
  ðŸ”¸ Saved new best Expert 1 (test acc 73.90%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 25/40:
  Train Loss: 53.1921, Train Acc: 53.65%
  Val   Loss: 21.2281, Val   Acc: 80.35%
  Test Accuracies: Global: 80.36% | Expert 0: 77.02%, Expert 1: 73.90%, Expert 2: 79.43%, Expert 3: 77.60%
  ðŸ“Š Training progress logged to CSV
Epoch 26/40, Batch 0/79, Loss: 66.4791 (Global: 3.0673, Individual: 12.6824)
Epoch 26/40, Batch 50/79, Loss: 48.0873 (Global: 2.1248, Individual: 9.1925)
  ðŸ”¸ Saved new best Expert 1 (test acc 73.98%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
Epoch 26/40:
  Train Loss: 53.4723, Train Acc: 57.04%
  Val   Loss: 20.9893, Val   Acc: 80.35%
  Test Accuracies: Global: 80.37% | Expert 0: 77.05%, Expert 1: 73.98%, Expert 2: 79.40%, Expert 3: 77.73%
  ðŸ“Š Training progress logged to CSV
Epoch 27/40, Batch 0/79, Loss: 61.7317 (Global: 2.8248, Individual: 11.7814)
Epoch 27/40, Batch 50/79, Loss: 57.6023 (Global: 2.6498, Individual: 10.9905)
Epoch 27/40:
  Train Loss: 53.6107, Train Acc: 56.59%
  Val   Loss: 21.1701, Val   Acc: 80.48%
  Test Accuracies: Global: 80.48% | Expert 0: 76.85%, Expert 1: 73.63%, Expert 2: 79.42%, Expert 3: 77.65%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.48%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.48%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.48%
Epoch 28/40, Batch 0/79, Loss: 59.7060 (Global: 2.7835, Individual: 11.3845)
Epoch 28/40, Batch 50/79, Loss: 39.2128 (Global: 1.6174, Individual: 7.5191)
Epoch 28/40:
  Train Loss: 51.4323, Train Acc: 63.58%
  Val   Loss: 20.8109, Val   Acc: 80.27%
  Test Accuracies: Global: 80.26% | Expert 0: 77.14%, Expert 1: 73.78%, Expert 2: 79.27%, Expert 3: 77.66%
  ðŸ“Š Training progress logged to CSV
Epoch 29/40, Batch 0/79, Loss: 52.2098 (Global: 2.2937, Individual: 9.9832)
Epoch 29/40, Batch 50/79, Loss: 56.9358 (Global: 2.6133, Individual: 10.8645)
  ðŸ”¸ Saved new best Expert 2 (test acc 79.49%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 29/40:
  Train Loss: 52.5290, Train Acc: 61.90%
  Val   Loss: 21.0632, Val   Acc: 80.29%
  Test Accuracies: Global: 80.28% | Expert 0: 76.91%, Expert 1: 73.68%, Expert 2: 79.49%, Expert 3: 77.73%
  ðŸ“Š Training progress logged to CSV
Epoch 30/40, Batch 0/79, Loss: 49.9315 (Global: 2.2580, Individual: 9.5347)
Epoch 30/40, Batch 50/79, Loss: 33.3761 (Global: 1.3485, Individual: 6.4055)
Epoch 30/40:
  Train Loss: 51.3968, Train Acc: 62.69%
  Val   Loss: 21.0706, Val   Acc: 80.26%
  Test Accuracies: Global: 80.25% | Expert 0: 77.05%, Expert 1: 73.81%, Expert 2: 79.38%, Expert 3: 77.84%
  ðŸ“Š Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/checkpoint_epoch_30.pth
Epoch 31/40, Batch 0/79, Loss: 34.8340 (Global: 1.4343, Individual: 6.6799)
Epoch 31/40, Batch 50/79, Loss: 58.2830 (Global: 2.6798, Individual: 11.1206)
Epoch 31/40:
  Train Loss: 52.4110, Train Acc: 63.72%
  Val   Loss: 20.9285, Val   Acc: 80.27%
  Test Accuracies: Global: 80.28% | Expert 0: 77.09%, Expert 1: 73.79%, Expert 2: 79.34%, Expert 3: 77.49%
  ðŸ“Š Training progress logged to CSV
Epoch 32/40, Batch 0/79, Loss: 61.1893 (Global: 2.7436, Individual: 11.6891)
Epoch 32/40, Batch 50/79, Loss: 40.0402 (Global: 1.7258, Individual: 7.6629)
Epoch 32/40:
  Train Loss: 53.6417, Train Acc: 61.35%
  Val   Loss: 21.3354, Val   Acc: 80.20%
  Test Accuracies: Global: 80.20% | Expert 0: 76.80%, Expert 1: 73.63%, Expert 2: 79.48%, Expert 3: 77.59%
  ðŸ“Š Training progress logged to CSV
Epoch 33/40, Batch 0/79, Loss: 63.0741 (Global: 2.9596, Individual: 12.0229)
Epoch 33/40, Batch 50/79, Loss: 56.8931 (Global: 2.5735, Individual: 10.8639)
  ðŸ”¸ Saved new best Expert 3 (test acc 77.86%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_3_best.pth
Epoch 33/40:
  Train Loss: 53.3951, Train Acc: 59.42%
  Val   Loss: 21.0520, Val   Acc: 80.20%
  Test Accuracies: Global: 80.17% | Expert 0: 77.09%, Expert 1: 73.86%, Expert 2: 79.31%, Expert 3: 77.86%
  ðŸ“Š Training progress logged to CSV
Epoch 34/40, Batch 0/79, Loss: 50.0499 (Global: 2.2097, Individual: 9.5680)
Epoch 34/40, Batch 50/79, Loss: 60.6734 (Global: 2.8067, Individual: 11.5733)
Epoch 34/40:
  Train Loss: 52.7828, Train Acc: 58.57%
  Val   Loss: 21.3715, Val   Acc: 80.50%
  Test Accuracies: Global: 80.52% | Expert 0: 76.81%, Expert 1: 73.60%, Expert 2: 79.33%, Expert 3: 77.65%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.52%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.52%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.52%
Epoch 35/40, Batch 0/79, Loss: 56.8541 (Global: 2.5862, Individual: 10.8536)
Epoch 35/40, Batch 50/79, Loss: 42.0286 (Global: 1.8008, Individual: 8.0456)
  ðŸ”¸ Saved new best Expert 2 (test acc 79.53%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
Epoch 35/40:
  Train Loss: 53.4051, Train Acc: 57.52%
  Val   Loss: 20.9382, Val   Acc: 80.69%
  Test Accuracies: Global: 80.68% | Expert 0: 77.09%, Expert 1: 73.55%, Expert 2: 79.53%, Expert 3: 77.80%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.68%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.68%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.68%
Epoch 36/40, Batch 0/79, Loss: 55.8100 (Global: 2.4993, Individual: 10.6621)
Epoch 36/40, Batch 50/79, Loss: 54.9378 (Global: 2.5451, Individual: 10.4786)
  ðŸ”¸ Saved new best Expert 3 (test acc 77.98%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_3_best.pth
Epoch 36/40:
  Train Loss: 51.6136, Train Acc: 62.67%
  Val   Loss: 20.7941, Val   Acc: 80.87%
  Test Accuracies: Global: 80.87% | Expert 0: 76.88%, Expert 1: 73.83%, Expert 2: 79.36%, Expert 3: 77.98%
  ðŸ”¸ Saved new best Fusion Module (test acc 80.87%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_best/fusion_module_best.pth
  ðŸ”¸ Saved new best Global Head (test acc 80.87%) to ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  ðŸ“Š Training progress logged to CSV
  New best global test accuracy: 80.87%
Epoch 37/40, Batch 0/79, Loss: 59.0788 (Global: 2.6213, Individual: 11.2915)
Epoch 37/40, Batch 50/79, Loss: 57.3717 (Global: 2.5533, Individual: 10.9637)
Epoch 37/40:
  Train Loss: 52.6259, Train Acc: 59.35%
  Val   Loss: 21.0202, Val   Acc: 80.62%
  Test Accuracies: Global: 80.62% | Expert 0: 77.11%, Expert 1: 73.78%, Expert 2: 79.46%, Expert 3: 77.88%
  ðŸ“Š Training progress logged to CSV
Epoch 38/40, Batch 0/79, Loss: 54.7456 (Global: 2.4620, Individual: 10.4567)
Epoch 38/40, Batch 50/79, Loss: 63.2379 (Global: 2.8229, Individual: 12.0830)
Epoch 38/40:
  Train Loss: 53.3399, Train Acc: 59.64%
  Val   Loss: 21.3435, Val   Acc: 80.35%
  Test Accuracies: Global: 80.34% | Expert 0: 77.04%, Expert 1: 73.63%, Expert 2: 79.27%, Expert 3: 77.71%
  ðŸ“Š Training progress logged to CSV
Epoch 39/40, Batch 0/79, Loss: 63.3935 (Global: 2.8649, Individual: 12.1057)
Epoch 39/40, Batch 50/79, Loss: 48.5782 (Global: 2.0988, Individual: 9.2959)
Epoch 39/40:
  Train Loss: 51.4066, Train Acc: 62.34%
  Val   Loss: 20.9003, Val   Acc: 79.90%
  Test Accuracies: Global: 79.91% | Expert 0: 77.02%, Expert 1: 73.83%, Expert 2: 79.39%, Expert 3: 77.79%
  ðŸ“Š Training progress logged to CSV
Epoch 40/40, Batch 0/79, Loss: 47.3021 (Global: 2.0207, Individual: 9.0563)
Epoch 40/40, Batch 50/79, Loss: 39.5599 (Global: 1.6753, Individual: 7.5769)
Epoch 40/40:
  Train Loss: 52.4149, Train Acc: 56.98%
  Val   Loss: 21.0502, Val   Acc: 80.39%
  Test Accuracies: Global: 80.37% | Expert 0: 77.06%, Expert 1: 73.63%, Expert 2: 79.27%, Expert 3: 77.96%
  ðŸ“Š Training progress logged to CSV
  Saved checkpoint: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/checkpoint_epoch_40.pth
  Saved best model: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/best_model.pth
âœ… Training completed! Best validation accuracy: 80.87%

ðŸ’¾ Saving trained model components...
  Saved expert 0: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts/expert_0_alpha_5.0.pth
  Saved expert 1: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts/expert_1_alpha_5.0.pth
  Saved expert 2: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts/expert_2_alpha_5.0.pth
  Saved expert 3: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts/expert_3_alpha_5.0.pth
  Saved fusion module: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_module/fusion_module_alpha_5.0.pth
  Saved global head: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_head/global_head_alpha_5.0.pth
  Saved complete model: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/complete_model/complete_fusion_model_alpha_5.0.pth
âœ… All model components saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative
  - Experts: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts
  - Fusion: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/fusion_module
  - Global: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_head
  - Complete: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/complete_model
âœ… Model components saved successfully

================================================================================
CLEAN TEST-SET EVALUATION (Best Experts + Best Global Head)
================================================================================
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:878: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
ðŸ”„ Loaded best Expert 0 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_0_best.pth
ðŸ”„ Loaded best Expert 1 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_1_best.pth
ðŸ”„ Loaded best Expert 2 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_2_best.pth
ðŸ”„ Loaded best Expert 3 weights for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/experts_best/expert_3_best.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:893: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(best_global_head_path, map_location=device)
ðŸ”„ Loaded best Global Head for clean eval from ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/mixed_experts_alpha_5.0/multiplicative/global_best/global_head_best.pth
  Clean Test Accuracy (best experts + best head): 80.45% | Loss: 1.0190

================================================================================
PHASE 3: POST-TRAINING EVALUATION (Î±=5.0)
================================================================================
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_mixed_experts_fusions_alpha_ablation_full_eval.py:933: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  ckpt = torch.load(path, map_location=device)
âš ï¸  Failed to load best expert checkpoints; using current weights. Error: Error(s) in loading state_dict for DenseNet:
	Missing key(s) in state_dict: "features.0.weight", "features.1.weight", "features.1.bias", "features.1.running_mean", "features.1.running_var", "features.denseblock1.dense_block.0.dense_layer.0.weight", "features.denseblock1.dense_block.0.dense_layer.0.bias", "features.denseblock1.dense_block.0.dense_layer.0.running_mean", "features.denseblock1.dense_block.0.dense_layer.0.running_var", "features.denseblock1.dense_block.0.dense_layer.2.weight", "features.denseblock1.dense_block.0.dense_layer.3.weight", "features.denseblock1.dense_block.0.dense_layer.3.bias", "features.denseblock1.dense_block.0.dense_layer.3.running_mean", "features.denseblock1.dense_block.0.dense_layer.3.running_var", "features.denseblock1.dense_block.0.dense_layer.5.weight", "features.denseblock1.dense_block.1.dense_layer.0.weight", "features.denseblock1.dense_block.1.dense_layer.0.bias", "features.denseblock1.dense_block.1.dense_layer.0.running_mean", "features.denseblock1.dense_block.1.dense_layer.0.running_var", "features.denseblock1.dense_block.1.dense_layer.2.weight", "features.denseblock1.dense_block.1.dense_layer.3.weight", "features.denseblock1.dense_block.1.dense_layer.3.bias", "features.denseblock1.dense_block.1.dense_layer.3.running_mean", "features.denseblock1.dense_block.1.dense_layer.3.running_var", "features.denseblock1.dense_block.1.dense_layer.5.weight", "features.denseblock1.dense_block.2.dense_layer.0.weight", "features.denseblock1.dense_block.2.dense_layer.0.bias", "features.denseblock1.dense_block.2.dense_layer.0.running_mean", "features.denseblock1.dense_block.2.dense_layer.0.running_var", "features.denseblock1.dense_block.2.dense_layer.2.weight", "features.denseblock1.dense_block.2.dense_layer.3.weight", "features.denseblock1.dense_block.2.dense_layer.3.bias", "features.denseblock1.dense_block.2.dense_layer.3.running_mean", "features.denseblock1.dense_block.2.dense_layer.3.running_var", "features.denseblock1.dense_block.2.dense_layer.5.weight", "features.denseblock1.dense_block.3.dense_layer.0.weight", "features.denseblock1.dense_block.3.dense_layer.0.bias", "features.denseblock1.dense_block.3.dense_layer.0.running_mean", "features.denseblock1.dense_block.3.dense_layer.0.running_var", "features.denseblock1.dense_block.3.dense_layer.2.weight", "features.denseblock1.dense_block.3.dense_layer.3.weight", "features.denseblock1.dense_block.3.dense_layer.3.bias", "features.denseblock1.dense_block.3.dense_layer.3.running_mean", "features.denseblock1.dense_block.3.dense_layer.3.running_var", "features.denseblock1.dense_block.3.dense_layer.5.weight", "features.denseblock1.dense_block.4.dense_layer.0.weight", "features.denseblock1.dense_block.4.dense_layer.0.bias", "features.denseblock1.dense_block.4.dense_layer.0.running_mean", "features.denseblock1.dense_block.4.dense_layer.0.running_var", "features.denseblock1.dense_block.4.dense_layer.2.weight", "features.denseblock1.dense_block.4.dense_layer.3.weight", "features.denseblock1.dense_block.4.dense_layer.3.bias", "features.denseblock1.dense_block.4.dense_layer.3.running_mean", "features.denseblock1.dense_block.4.dense_layer.3.running_var", "features.denseblock1.dense_block.4.dense_layer.5.weight", "features.denseblock1.dense_block.5.dense_layer.0.weight", "features.denseblock1.dense_block.5.dense_layer.0.bias", "features.denseblock1.dense_block.5.dense_layer.0.running_mean", "features.denseblock1.dense_block.5.dense_layer.0.running_var", "features.denseblock1.dense_block.5.dense_layer.2.weight", "features.denseblock1.dense_block.5.dense_layer.3.weight", "features.denseblock1.dense_block.5.dense_layer.3.bias", "features.denseblock1.dense_block.5.dense_layer.3.running_mean", "features.denseblock1.dense_block.5.dense_layer.3.running_var", "features.denseblock1.dense_block.5.dense_layer.5.weight", "features.transition1.transition_layer.0.weight", "features.transition1.transition_layer.0.bias", "features.transition1.transition_layer.0.running_mean", "features.transition1.transition_layer.0.running_var", "features.transition1.transition_layer.2.weight", "features.denseblock2.dense_block.0.dense_layer.0.weight", "features.denseblock2.dense_block.0.dense_layer.0.bias", "features.denseblock2.dense_block.0.dense_layer.0.running_mean", "features.denseblock2.dense_block.0.dense_layer.0.running_var", "features.denseblock2.dense_block.0.dense_layer.2.weight", "features.denseblock2.dense_block.0.dense_layer.3.weight", "features.denseblock2.dense_block.0.dense_layer.3.bias", "features.denseblock2.dense_block.0.dense_layer.3.running_mean", "features.denseblock2.dense_block.0.dense_layer.3.running_var", "features.denseblock2.dense_block.0.dense_layer.5.weight", "features.denseblock2.dense_block.1.dense_layer.0.weight", "features.denseblock2.dense_block.1.dense_layer.0.bias", "features.denseblock2.dense_block.1.dense_layer.0.running_mean", "features.denseblock2.dense_block.1.dense_layer.0.running_var", "features.denseblock2.dense_block.1.dense_layer.2.weight", "features.denseblock2.dense_block.1.dense_layer.3.weight", "features.denseblock2.dense_block.1.dense_layer.3.bias", "features.denseblock2.dense_block.1.dense_layer.3.running_mean", "features.denseblock2.dense_block.1.dense_layer.3.running_var", "features.denseblock2.dense_block.1.dense_layer.5.weight", "features.denseblock2.dense_block.2.dense_layer.0.weight", "features.denseblock2.dense_block.2.dense_layer.0.bias", "features.denseblock2.dense_block.2.dense_layer.0.running_mean", "features.denseblock2.dense_block.2.dense_layer.0.running_var", "features.denseblock2.dense_block.2.dense_layer.2.weight", "features.denseblock2.dense_block.2.dense_layer.3.weight", "features.denseblock2.dense_block.2.dense_layer.3.bias", "features.denseblock2.dense_block.2.dense_layer.3.running_mean", "features.denseblock2.dense_block.2.dense_layer.3.running_var", "features.denseblock2.dense_block.2.dense_layer.5.weight", "features.denseblock2.dense_block.3.dense_layer.0.weight", "features.denseblock2.dense_block.3.dense_layer.0.bias", "features.denseblock2.dense_block.3.dense_layer.0.running_mean", "features.denseblock2.dense_block.3.dense_layer.0.running_var", "features.denseblock2.dense_block.3.dense_layer.2.weight", "features.denseblock2.dense_block.3.dense_layer.3.weight", "features.denseblock2.dense_block.3.dense_layer.3.bias", "features.denseblock2.dense_block.3.dense_layer.3.running_mean", "features.denseblock2.dense_block.3.dense_layer.3.running_var", "features.denseblock2.dense_block.3.dense_layer.5.weight", "features.denseblock2.dense_block.4.dense_layer.0.weight", "features.denseblock2.dense_block.4.dense_layer.0.bias", "features.denseblock2.dense_block.4.dense_layer.0.running_mean", "features.denseblock2.dense_block.4.dense_layer.0.running_var", "features.denseblock2.dense_block.4.dense_layer.2.weight", "features.denseblock2.dense_block.4.dense_layer.3.weight", "features.denseblock2.dense_block.4.dense_layer.3.bias", "features.denseblock2.dense_block.4.dense_layer.3.running_mean", "features.denseblock2.dense_block.4.dense_layer.3.running_var", "features.denseblock2.dense_block.4.dense_layer.5.weight", "features.denseblock2.dense_block.5.dense_layer.0.weight", "features.denseblock2.dense_block.5.dense_layer.0.bias", "features.denseblock2.dense_block.5.dense_layer.0.running_mean", "features.denseblock2.dense_block.5.dense_layer.0.running_var", "features.denseblock2.dense_block.5.dense_layer.2.weight", "features.denseblock2.dense_block.5.dense_layer.3.weight", "features.denseblock2.dense_block.5.dense_layer.3.bias", "features.denseblock2.dense_block.5.dense_layer.3.running_mean", "features.denseblock2.dense_block.5.dense_layer.3.running_var", "features.denseblock2.dense_block.5.dense_layer.5.weight", "features.denseblock2.dense_block.6.dense_layer.0.weight", "features.denseblock2.dense_block.6.dense_layer.0.bias", "features.denseblock2.dense_block.6.dense_layer.0.running_mean", "features.denseblock2.dense_block.6.dense_layer.0.running_var", "features.denseblock2.dense_block.6.dense_layer.2.weight", "features.denseblock2.dense_block.6.dense_layer.3.weight", "features.denseblock2.dense_block.6.dense_layer.3.bias", "features.denseblock2.dense_block.6.dense_layer.3.running_mean", "features.denseblock2.dense_block.6.dense_layer.3.running_var", "features.denseblock2.dense_block.6.dense_layer.5.weight", "features.denseblock2.dense_block.7.dense_layer.0.weight", "features.denseblock2.dense_block.7.dense_layer.0.bias", "features.denseblock2.dense_block.7.dense_layer.0.running_mean", "features.denseblock2.dense_block.7.dense_layer.0.running_var", "features.denseblock2.dense_block.7.dense_layer.2.weight", "features.denseblock2.dense_block.7.dense_layer.3.weight", "features.denseblock2.dense_block.7.dense_layer.3.bias", "features.denseblock2.dense_block.7.dense_layer.3.running_mean", "features.denseblock2.dense_block.7.dense_layer.3.running_var", "features.denseblock2.dense_block.7.dense_layer.5.weight", "features.denseblock2.dense_block.8.dense_layer.0.weight", "features.denseblock2.dense_block.8.dense_layer.0.bias", "features.denseblock2.dense_block.8.dense_layer.0.running_mean", "features.denseblock2.dense_block.8.dense_layer.0.running_var", "features.denseblock2.dense_block.8.dense_layer.2.weight", "features.denseblock2.dense_block.8.dense_layer.3.weight", "features.denseblock2.dense_block.8.dense_layer.3.bias", "features.denseblock2.dense_block.8.dense_layer.3.running_mean", "features.denseblock2.dense_block.8.dense_layer.3.running_var", "features.denseblock2.dense_block.8.dense_layer.5.weight", "features.denseblock2.dense_block.9.dense_layer.0.weight", "features.denseblock2.dense_block.9.dense_layer.0.bias", "features.denseblock2.dense_block.9.dense_layer.0.running_mean", "features.denseblock2.dense_block.9.dense_layer.0.running_var", "features.denseblock2.dense_block.9.dense_layer.2.weight", "features.denseblock2.dense_block.9.dense_layer.3.weight", "features.denseblock2.dense_block.9.dense_layer.3.bias", "features.denseblock2.dense_block.9.dense_layer.3.running_mean", "features.denseblock2.dense_block.9.dense_layer.3.running_var", "features.denseblock2.dense_block.9.dense_layer.5.weight", "features.denseblock2.dense_block.10.dense_layer.0.weight", "features.denseblock2.dense_block.10.dense_layer.0.bias", "features.denseblock2.dense_block.10.dense_layer.0.running_mean", "features.denseblock2.dense_block.10.dense_layer.0.running_var", "features.denseblock2.dense_block.10.dense_layer.2.weight", "features.denseblock2.dense_block.10.dense_layer.3.weight", "features.denseblock2.dense_block.10.dense_layer.3.bias", "features.denseblock2.dense_block.10.dense_layer.3.running_mean", "features.denseblock2.dense_block.10.dense_layer.3.running_var", "features.denseblock2.dense_block.10.dense_layer.5.weight", "features.denseblock2.dense_block.11.dense_layer.0.weight", "features.denseblock2.dense_block.11.dense_layer.0.bias", "features.denseblock2.dense_block.11.dense_layer.0.running_mean", "features.denseblock2.dense_block.11.dense_layer.0.running_var", "features.denseblock2.dense_block.11.dense_layer.2.weight", "features.denseblock2.dense_block.11.dense_layer.3.weight", "features.denseblock2.dense_block.11.dense_layer.3.bias", "features.denseblock2.dense_block.11.dense_layer.3.running_mean", "features.denseblock2.dense_block.11.dense_layer.3.running_var", "features.denseblock2.dense_block.11.dense_layer.5.weight", "features.transition2.transition_layer.0.weight", "features.transition2.transition_layer.0.bias", "features.transition2.transition_layer.0.running_mean", "features.transition2.transition_layer.0.running_var", "features.transition2.transition_layer.2.weight", "features.denseblock3.dense_block.0.dense_layer.0.weight", "features.denseblock3.dense_block.0.dense_layer.0.bias", "features.denseblock3.dense_block.0.dense_layer.0.running_mean", "features.denseblock3.dense_block.0.dense_layer.0.running_var", "features.denseblock3.dense_block.0.dense_layer.2.weight", "features.denseblock3.dense_block.0.dense_layer.3.weight", "features.denseblock3.dense_block.0.dense_layer.3.bias", "features.denseblock3.dense_block.0.dense_layer.3.running_mean", "features.denseblock3.dense_block.0.dense_layer.3.running_var", "features.denseblock3.dense_block.0.dense_layer.5.weight", "features.denseblock3.dense_block.1.dense_layer.0.weight", "features.denseblock3.dense_block.1.dense_layer.0.bias", "features.denseblock3.dense_block.1.dense_layer.0.running_mean", "features.denseblock3.dense_block.1.dense_layer.0.running_var", "features.denseblock3.dense_block.1.dense_layer.2.weight", "features.denseblock3.dense_block.1.dense_layer.3.weight", "features.denseblock3.dense_block.1.dense_layer.3.bias", "features.denseblock3.dense_block.1.dense_layer.3.running_mean", "features.denseblock3.dense_block.1.dense_layer.3.running_var", "features.denseblock3.dense_block.1.dense_layer.5.weight", "features.denseblock3.dense_block.2.dense_layer.0.weight", "features.denseblock3.dense_block.2.dense_layer.0.bias", "features.denseblock3.dense_block.2.dense_layer.0.running_mean", "features.denseblock3.dense_block.2.dense_layer.0.running_var", "features.denseblock3.dense_block.2.dense_layer.2.weight", "features.denseblock3.dense_block.2.dense_layer.3.weight", "features.denseblock3.dense_block.2.dense_layer.3.bias", "features.denseblock3.dense_block.2.dense_layer.3.running_mean", "features.denseblock3.dense_block.2.dense_layer.3.running_var", "features.denseblock3.dense_block.2.dense_layer.5.weight", "features.denseblock3.dense_block.3.dense_layer.0.weight", "features.denseblock3.dense_block.3.dense_layer.0.bias", "features.denseblock3.dense_block.3.dense_layer.0.running_mean", "features.denseblock3.dense_block.3.dense_layer.0.running_var", "features.denseblock3.dense_block.3.dense_layer.2.weight", "features.denseblock3.dense_block.3.dense_layer.3.weight", "features.denseblock3.dense_block.3.dense_layer.3.bias", "features.denseblock3.dense_block.3.dense_layer.3.running_mean", "features.denseblock3.dense_block.3.dense_layer.3.running_var", "features.denseblock3.dense_block.3.dense_layer.5.weight", "features.denseblock3.dense_block.4.dense_layer.0.weight", "features.denseblock3.dense_block.4.dense_layer.0.bias", "features.denseblock3.dense_block.4.dense_layer.0.running_mean", "features.denseblock3.dense_block.4.dense_layer.0.running_var", "features.denseblock3.dense_block.4.dense_layer.2.weight", "features.denseblock3.dense_block.4.dense_layer.3.weight", "features.denseblock3.dense_block.4.dense_layer.3.bias", "features.denseblock3.dense_block.4.dense_layer.3.running_mean", "features.denseblock3.dense_block.4.dense_layer.3.running_var", "features.denseblock3.dense_block.4.dense_layer.5.weight", "features.denseblock3.dense_block.5.dense_layer.0.weight", "features.denseblock3.dense_block.5.dense_layer.0.bias", "features.denseblock3.dense_block.5.dense_layer.0.running_mean", "features.denseblock3.dense_block.5.dense_layer.0.running_var", "features.denseblock3.dense_block.5.dense_layer.2.weight", "features.denseblock3.dense_block.5.dense_layer.3.weight", "features.denseblock3.dense_block.5.dense_layer.3.bias", "features.denseblock3.dense_block.5.dense_layer.3.running_mean", "features.denseblock3.dense_block.5.dense_layer.3.running_var", "features.denseblock3.dense_block.5.dense_layer.5.weight", "features.denseblock3.dense_block.6.dense_layer.0.weight", "features.denseblock3.dense_block.6.dense_layer.0.bias", "features.denseblock3.dense_block.6.dense_layer.0.running_mean", "features.denseblock3.dense_block.6.dense_layer.0.running_var", "features.denseblock3.dense_block.6.dense_layer.2.weight", "features.denseblock3.dense_block.6.dense_layer.3.weight", "features.denseblock3.dense_block.6.dense_layer.3.bias", "features.denseblock3.dense_block.6.dense_layer.3.running_mean", "features.denseblock3.dense_block.6.dense_layer.3.running_var", "features.denseblock3.dense_block.6.dense_layer.5.weight", "features.denseblock3.dense_block.7.dense_layer.0.weight", "features.denseblock3.dense_block.7.dense_layer.0.bias", "features.denseblock3.dense_block.7.dense_layer.0.running_mean", "features.denseblock3.dense_block.7.dense_layer.0.running_var", "features.denseblock3.dense_block.7.dense_layer.2.weight", "features.denseblock3.dense_block.7.dense_layer.3.weight", "features.denseblock3.dense_block.7.dense_layer.3.bias", "features.denseblock3.dense_block.7.dense_layer.3.running_mean", "features.denseblock3.dense_block.7.dense_layer.3.running_var", "features.denseblock3.dense_block.7.dense_layer.5.weight", "features.denseblock3.dense_block.8.dense_layer.0.weight", "features.denseblock3.dense_block.8.dense_layer.0.bias", "features.denseblock3.dense_block.8.dense_layer.0.running_mean", "features.denseblock3.dense_block.8.dense_layer.0.running_var", "features.denseblock3.dense_block.8.dense_layer.2.weight", "features.denseblock3.dense_block.8.dense_layer.3.weight", "features.denseblock3.dense_block.8.dense_layer.3.bias", "features.denseblock3.dense_block.8.dense_layer.3.running_mean", "features.denseblock3.dense_block.8.dense_layer.3.running_var", "features.denseblock3.dense_block.8.dense_layer.5.weight", "features.denseblock3.dense_block.9.dense_layer.0.weight", "features.denseblock3.dense_block.9.dense_layer.0.bias", "features.denseblock3.dense_block.9.dense_layer.0.running_mean", "features.denseblock3.dense_block.9.dense_layer.0.running_var", "features.denseblock3.dense_block.9.dense_layer.2.weight", "features.denseblock3.dense_block.9.dense_layer.3.weight", "features.denseblock3.dense_block.9.dense_layer.3.bias", "features.denseblock3.dense_block.9.dense_layer.3.running_mean", "features.denseblock3.dense_block.9.dense_layer.3.running_var", "features.denseblock3.dense_block.9.dense_layer.5.weight", "features.denseblock3.dense_block.10.dense_layer.0.weight", "features.denseblock3.dense_block.10.dense_layer.0.bias", "features.denseblock3.dense_block.10.dense_layer.0.running_mean", "features.denseblock3.dense_block.10.dense_layer.0.running_var", "features.denseblock3.dense_block.10.dense_layer.2.weight", "features.denseblock3.dense_block.10.dense_layer.3.weight", "features.denseblock3.dense_block.10.dense_layer.3.bias", "features.denseblock3.dense_block.10.dense_layer.3.running_mean", "features.denseblock3.dense_block.10.dense_layer.3.running_var", "features.denseblock3.dense_block.10.dense_layer.5.weight", "features.denseblock3.dense_block.11.dense_layer.0.weight", "features.denseblock3.dense_block.11.dense_layer.0.bias", "features.denseblock3.dense_block.11.dense_layer.0.running_mean", "features.denseblock3.dense_block.11.dense_layer.0.running_var", "features.denseblock3.dense_block.11.dense_layer.2.weight", "features.denseblock3.dense_block.11.dense_layer.3.weight", "features.denseblock3.dense_block.11.dense_layer.3.bias", "features.denseblock3.dense_block.11.dense_layer.3.running_mean", "features.denseblock3.dense_block.11.dense_layer.3.running_var", "features.denseblock3.dense_block.11.dense_layer.5.weight", "features.denseblock3.dense_block.12.dense_layer.0.weight", "features.denseblock3.dense_block.12.dense_layer.0.bias", "features.denseblock3.dense_block.12.dense_layer.0.running_mean", "features.denseblock3.dense_block.12.dense_layer.0.running_var", "features.denseblock3.dense_block.12.dense_layer.2.weight", "features.denseblock3.dense_block.12.dense_layer.3.weight", "features.denseblock3.dense_block.12.dense_layer.3.bias", "features.denseblock3.dense_block.12.dense_layer.3.running_mean", "features.denseblock3.dense_block.12.dense_layer.3.running_var", "features.denseblock3.dense_block.12.dense_layer.5.weight", "features.denseblock3.dense_block.13.dense_layer.0.weight", "features.denseblock3.dense_block.13.dense_layer.0.bias", "features.denseblock3.dense_block.13.dense_layer.0.running_mean", "features.denseblock3.dense_block.13.dense_layer.0.running_var", "features.denseblock3.dense_block.13.dense_layer.2.weight", "features.denseblock3.dense_block.13.dense_layer.3.weight", "features.denseblock3.dense_block.13.dense_layer.3.bias", "features.denseblock3.dense_block.13.dense_layer.3.running_mean", "features.denseblock3.dense_block.13.dense_layer.3.running_var", "features.denseblock3.dense_block.13.dense_layer.5.weight", "features.denseblock3.dense_block.14.dense_layer.0.weight", "features.denseblock3.dense_block.14.dense_layer.0.bias", "features.denseblock3.dense_block.14.dense_layer.0.running_mean", "features.denseblock3.dense_block.14.dense_layer.0.running_var", "features.denseblock3.dense_block.14.dense_layer.2.weight", "features.denseblock3.dense_block.14.dense_layer.3.weight", "features.denseblock3.dense_block.14.dense_layer.3.bias", "features.denseblock3.dense_block.14.dense_layer.3.running_mean", "features.denseblock3.dense_block.14.dense_layer.3.running_var", "features.denseblock3.dense_block.14.dense_layer.5.weight", "features.denseblock3.dense_block.15.dense_layer.0.weight", "features.denseblock3.dense_block.15.dense_layer.0.bias", "features.denseblock3.dense_block.15.dense_layer.0.running_mean", "features.denseblock3.dense_block.15.dense_layer.0.running_var", "features.denseblock3.dense_block.15.dense_layer.2.weight", "features.denseblock3.dense_block.15.dense_layer.3.weight", "features.denseblock3.dense_block.15.dense_layer.3.bias", "features.denseblock3.dense_block.15.dense_layer.3.running_mean", "features.denseblock3.dense_block.15.dense_layer.3.running_var", "features.denseblock3.dense_block.15.dense_layer.5.weight", "features.denseblock3.dense_block.16.dense_layer.0.weight", "features.denseblock3.dense_block.16.dense_layer.0.bias", "features.denseblock3.dense_block.16.dense_layer.0.running_mean", "features.denseblock3.dense_block.16.dense_layer.0.running_var", "features.denseblock3.dense_block.16.dense_layer.2.weight", "features.denseblock3.dense_block.16.dense_layer.3.weight", "features.denseblock3.dense_block.16.dense_layer.3.bias", "features.denseblock3.dense_block.16.dense_layer.3.running_mean", "features.denseblock3.dense_block.16.dense_layer.3.running_var", "features.denseblock3.dense_block.16.dense_layer.5.weight", "features.denseblock3.dense_block.17.dense_layer.0.weight", "features.denseblock3.dense_block.17.dense_layer.0.bias", "features.denseblock3.dense_block.17.dense_layer.0.running_mean", "features.denseblock3.dense_block.17.dense_layer.0.running_var", "features.denseblock3.dense_block.17.dense_layer.2.weight", "features.denseblock3.dense_block.17.dense_layer.3.weight", "features.denseblock3.dense_block.17.dense_layer.3.bias", "features.denseblock3.dense_block.17.dense_layer.3.running_mean", "features.denseblock3.dense_block.17.dense_layer.3.running_var", "features.denseblock3.dense_block.17.dense_layer.5.weight", "features.denseblock3.dense_block.18.dense_layer.0.weight", "features.denseblock3.dense_block.18.dense_layer.0.bias", "features.denseblock3.dense_block.18.dense_layer.0.running_mean", "features.denseblock3.dense_block.18.dense_layer.0.running_var", "features.denseblock3.dense_block.18.dense_layer.2.weight", "features.denseblock3.dense_block.18.dense_layer.3.weight", "features.denseblock3.dense_block.18.dense_layer.3.bias", "features.denseblock3.dense_block.18.dense_layer.3.running_mean", "features.denseblock3.dense_block.18.dense_layer.3.running_var", "features.denseblock3.dense_block.18.dense_layer.5.weight", "features.denseblock3.dense_block.19.dense_layer.0.weight", "features.denseblock3.dense_block.19.dense_layer.0.bias", "features.denseblock3.dense_block.19.dense_layer.0.running_mean", "features.denseblock3.dense_block.19.dense_layer.0.running_var", "features.denseblock3.dense_block.19.dense_layer.2.weight", "features.denseblock3.dense_block.19.dense_layer.3.weight", "features.denseblock3.dense_block.19.dense_layer.3.bias", "features.denseblock3.dense_block.19.dense_layer.3.running_mean", "features.denseblock3.dense_block.19.dense_layer.3.running_var", "features.denseblock3.dense_block.19.dense_layer.5.weight", "features.denseblock3.dense_block.20.dense_layer.0.weight", "features.denseblock3.dense_block.20.dense_layer.0.bias", "features.denseblock3.dense_block.20.dense_layer.0.running_mean", "features.denseblock3.dense_block.20.dense_layer.0.running_var", "features.denseblock3.dense_block.20.dense_layer.2.weight", "features.denseblock3.dense_block.20.dense_layer.3.weight", "features.denseblock3.dense_block.20.dense_layer.3.bias", "features.denseblock3.dense_block.20.dense_layer.3.running_mean", "features.denseblock3.dense_block.20.dense_layer.3.running_var", "features.denseblock3.dense_block.20.dense_layer.5.weight", "features.denseblock3.dense_block.21.dense_layer.0.weight", "features.denseblock3.dense_block.21.dense_layer.0.bias", "features.denseblock3.dense_block.21.dense_layer.0.running_mean", "features.denseblock3.dense_block.21.dense_layer.0.running_var", "features.denseblock3.dense_block.21.dense_layer.2.weight", "features.denseblock3.dense_block.21.dense_layer.3.weight", "features.denseblock3.dense_block.21.dense_layer.3.bias", "features.denseblock3.dense_block.21.dense_layer.3.running_mean", "features.denseblock3.dense_block.21.dense_layer.3.running_var", "features.denseblock3.dense_block.21.dense_layer.5.weight", "features.denseblock3.dense_block.22.dense_layer.0.weight", "features.denseblock3.dense_block.22.dense_layer.0.bias", "features.denseblock3.dense_block.22.dense_layer.0.running_mean", "features.denseblock3.dense_block.22.dense_layer.0.running_var", "features.denseblock3.dense_block.22.dense_layer.2.weight", "features.denseblock3.dense_block.22.dense_layer.3.weight", "features.denseblock3.dense_block.22.dense_layer.3.bias", "features.denseblock3.dense_block.22.dense_layer.3.running_mean", "features.denseblock3.dense_block.22.dense_layer.3.running_var", "features.denseblock3.dense_block.22.dense_layer.5.weight", "features.denseblock3.dense_block.23.dense_layer.0.weight", "features.denseblock3.dense_block.23.dense_layer.0.bias", "features.denseblock3.dense_block.23.dense_layer.0.running_mean", "features.denseblock3.dense_block.23.dense_layer.0.running_var", "features.denseblock3.dense_block.23.dense_layer.2.weight", "features.denseblock3.dense_block.23.dense_layer.3.weight", "features.denseblock3.dense_block.23.dense_layer.3.bias", "features.denseblock3.dense_block.23.dense_layer.3.running_mean", "features.denseblock3.dense_block.23.dense_layer.3.running_var", "features.denseblock3.dense_block.23.dense_layer.5.weight", "features.transition3.transition_layer.0.weight", "features.transition3.transition_layer.0.bias", "features.transition3.transition_layer.0.running_mean", "features.transition3.transition_layer.0.running_var", "features.transition3.transition_layer.2.weight", "features.denseblock4.dense_block.0.dense_layer.0.weight", "features.denseblock4.dense_block.0.dense_layer.0.bias", "features.denseblock4.dense_block.0.dense_layer.0.running_mean", "features.denseblock4.dense_block.0.dense_layer.0.running_var", "features.denseblock4.dense_block.0.dense_layer.2.weight", "features.denseblock4.dense_block.0.dense_layer.3.weight", "features.denseblock4.dense_block.0.dense_layer.3.bias", "features.denseblock4.dense_block.0.dense_layer.3.running_mean", "features.denseblock4.dense_block.0.dense_layer.3.running_var", "features.denseblock4.dense_block.0.dense_layer.5.weight", "features.denseblock4.dense_block.1.dense_layer.0.weight", "features.denseblock4.dense_block.1.dense_layer.0.bias", "features.denseblock4.dense_block.1.dense_layer.0.running_mean", "features.denseblock4.dense_block.1.dense_layer.0.running_var", "features.denseblock4.dense_block.1.dense_layer.2.weight", "features.denseblock4.dense_block.1.dense_layer.3.weight", "features.denseblock4.dense_block.1.dense_layer.3.bias", "features.denseblock4.dense_block.1.dense_layer.3.running_mean", "features.denseblock4.dense_block.1.dense_layer.3.running_var", "features.denseblock4.dense_block.1.dense_layer.5.weight", "features.denseblock4.dense_block.2.dense_layer.0.weight", "features.denseblock4.dense_block.2.dense_layer.0.bias", "features.denseblock4.dense_block.2.dense_layer.0.running_mean", "features.denseblock4.dense_block.2.dense_layer.0.running_var", "features.denseblock4.dense_block.2.dense_layer.2.weight", "features.denseblock4.dense_block.2.dense_layer.3.weight", "features.denseblock4.dense_block.2.dense_layer.3.bias", "features.denseblock4.dense_block.2.dense_layer.3.running_mean", "features.denseblock4.dense_block.2.dense_layer.3.running_var", "features.denseblock4.dense_block.2.dense_layer.5.weight", "features.denseblock4.dense_block.3.dense_layer.0.weight", "features.denseblock4.dense_block.3.dense_layer.0.bias", "features.denseblock4.dense_block.3.dense_layer.0.running_mean", "features.denseblock4.dense_block.3.dense_layer.0.running_var", "features.denseblock4.dense_block.3.dense_layer.2.weight", "features.denseblock4.dense_block.3.dense_layer.3.weight", "features.denseblock4.dense_block.3.dense_layer.3.bias", "features.denseblock4.dense_block.3.dense_layer.3.running_mean", "features.denseblock4.dense_block.3.dense_layer.3.running_var", "features.denseblock4.dense_block.3.dense_layer.5.weight", "features.denseblock4.dense_block.4.dense_layer.0.weight", "features.denseblock4.dense_block.4.dense_layer.0.bias", "features.denseblock4.dense_block.4.dense_layer.0.running_mean", "features.denseblock4.dense_block.4.dense_layer.0.running_var", "features.denseblock4.dense_block.4.dense_layer.2.weight", "features.denseblock4.dense_block.4.dense_layer.3.weight", "features.denseblock4.dense_block.4.dense_layer.3.bias", "features.denseblock4.dense_block.4.dense_layer.3.running_mean", "features.denseblock4.dense_block.4.dense_layer.3.running_var", "features.denseblock4.dense_block.4.dense_layer.5.weight", "features.denseblock4.dense_block.5.dense_layer.0.weight", "features.denseblock4.dense_block.5.dense_layer.0.bias", "features.denseblock4.dense_block.5.dense_layer.0.running_mean", "features.denseblock4.dense_block.5.dense_layer.0.running_var", "features.denseblock4.dense_block.5.dense_layer.2.weight", "features.denseblock4.dense_block.5.dense_layer.3.weight", "features.denseblock4.dense_block.5.dense_layer.3.bias", "features.denseblock4.dense_block.5.dense_layer.3.running_mean", "features.denseblock4.dense_block.5.dense_layer.3.running_var", "features.denseblock4.dense_block.5.dense_layer.5.weight", "features.denseblock4.dense_block.6.dense_layer.0.weight", "features.denseblock4.dense_block.6.dense_layer.0.bias", "features.denseblock4.dense_block.6.dense_layer.0.running_mean", "features.denseblock4.dense_block.6.dense_layer.0.running_var", "features.denseblock4.dense_block.6.dense_layer.2.weight", "features.denseblock4.dense_block.6.dense_layer.3.weight", "features.denseblock4.dense_block.6.dense_layer.3.bias", "features.denseblock4.dense_block.6.dense_layer.3.running_mean", "features.denseblock4.dense_block.6.dense_layer.3.running_var", "features.denseblock4.dense_block.6.dense_layer.5.weight", "features.denseblock4.dense_block.7.dense_layer.0.weight", "features.denseblock4.dense_block.7.dense_layer.0.bias", "features.denseblock4.dense_block.7.dense_layer.0.running_mean", "features.denseblock4.dense_block.7.dense_layer.0.running_var", "features.denseblock4.dense_block.7.dense_layer.2.weight", "features.denseblock4.dense_block.7.dense_layer.3.weight", "features.denseblock4.dense_block.7.dense_layer.3.bias", "features.denseblock4.dense_block.7.dense_layer.3.running_mean", "features.denseblock4.dense_block.7.dense_layer.3.running_var", "features.denseblock4.dense_block.7.dense_layer.5.weight", "features.denseblock4.dense_block.8.dense_layer.0.weight", "features.denseblock4.dense_block.8.dense_layer.0.bias", "features.denseblock4.dense_block.8.dense_layer.0.running_mean", "features.denseblock4.dense_block.8.dense_layer.0.running_var", "features.denseblock4.dense_block.8.dense_layer.2.weight", "features.denseblock4.dense_block.8.dense_layer.3.weight", "features.denseblock4.dense_block.8.dense_layer.3.bias", "features.denseblock4.dense_block.8.dense_layer.3.running_mean", "features.denseblock4.dense_block.8.dense_layer.3.running_var", "features.denseblock4.dense_block.8.dense_layer.5.weight", "features.denseblock4.dense_block.9.dense_layer.0.weight", "features.denseblock4.dense_block.9.dense_layer.0.bias", "features.denseblock4.dense_block.9.dense_layer.0.running_mean", "features.denseblock4.dense_block.9.dense_layer.0.running_var", "features.denseblock4.dense_block.9.dense_layer.2.weight", "features.denseblock4.dense_block.9.dense_layer.3.weight", "features.denseblock4.dense_block.9.dense_layer.3.bias", "features.denseblock4.dense_block.9.dense_layer.3.running_mean", "features.denseblock4.dense_block.9.dense_layer.3.running_var", "features.denseblock4.dense_block.9.dense_layer.5.weight", "features.denseblock4.dense_block.10.dense_layer.0.weight", "features.denseblock4.dense_block.10.dense_layer.0.bias", "features.denseblock4.dense_block.10.dense_layer.0.running_mean", "features.denseblock4.dense_block.10.dense_layer.0.running_var", "features.denseblock4.dense_block.10.dense_layer.2.weight", "features.denseblock4.dense_block.10.dense_layer.3.weight", "features.denseblock4.dense_block.10.dense_layer.3.bias", "features.denseblock4.dense_block.10.dense_layer.3.running_mean", "features.denseblock4.dense_block.10.dense_layer.3.running_var", "features.denseblock4.dense_block.10.dense_layer.5.weight", "features.denseblock4.dense_block.11.dense_layer.0.weight", "features.denseblock4.dense_block.11.dense_layer.0.bias", "features.denseblock4.dense_block.11.dense_layer.0.running_mean", "features.denseblock4.dense_block.11.dense_layer.0.running_var", "features.denseblock4.dense_block.11.dense_layer.2.weight", "features.denseblock4.dense_block.11.dense_layer.3.weight", "features.denseblock4.dense_block.11.dense_layer.3.bias", "features.denseblock4.dense_block.11.dense_layer.3.running_mean", "features.denseblock4.dense_block.11.dense_layer.3.running_var", "features.denseblock4.dense_block.11.dense_layer.5.weight", "features.denseblock4.dense_block.12.dense_layer.0.weight", "features.denseblock4.dense_block.12.dense_layer.0.bias", "features.denseblock4.dense_block.12.dense_layer.0.running_mean", "features.denseblock4.dense_block.12.dense_layer.0.running_var", "features.denseblock4.dense_block.12.dense_layer.2.weight", "features.denseblock4.dense_block.12.dense_layer.3.weight", "features.denseblock4.dense_block.12.dense_layer.3.bias", "features.denseblock4.dense_block.12.dense_layer.3.running_mean", "features.denseblock4.dense_block.12.dense_layer.3.running_var", "features.denseblock4.dense_block.12.dense_layer.5.weight", "features.denseblock4.dense_block.13.dense_layer.0.weight", "features.denseblock4.dense_block.13.dense_layer.0.bias", "features.denseblock4.dense_block.13.dense_layer.0.running_mean", "features.denseblock4.dense_block.13.dense_layer.0.running_var", "features.denseblock4.dense_block.13.dense_layer.2.weight", "features.denseblock4.dense_block.13.dense_layer.3.weight", "features.denseblock4.dense_block.13.dense_layer.3.bias", "features.denseblock4.dense_block.13.dense_layer.3.running_mean", "features.denseblock4.dense_block.13.dense_layer.3.running_var", "features.denseblock4.dense_block.13.dense_layer.5.weight", "features.denseblock4.dense_block.14.dense_layer.0.weight", "features.denseblock4.dense_block.14.dense_layer.0.bias", "features.denseblock4.dense_block.14.dense_layer.0.running_mean", "features.denseblock4.dense_block.14.dense_layer.0.running_var", "features.denseblock4.dense_block.14.dense_layer.2.weight", "features.denseblock4.dense_block.14.dense_layer.3.weight", "features.denseblock4.dense_block.14.dense_layer.3.bias", "features.denseblock4.dense_block.14.dense_layer.3.running_mean", "features.denseblock4.dense_block.14.dense_layer.3.running_var", "features.denseblock4.dense_block.14.dense_layer.5.weight", "features.denseblock4.dense_block.15.dense_layer.0.weight", "features.denseblock4.dense_block.15.dense_layer.0.bias", "features.denseblock4.dense_block.15.dense_layer.0.running_mean", "features.denseblock4.dense_block.15.dense_layer.0.running_var", "features.denseblock4.dense_block.15.dense_layer.2.weight", "features.denseblock4.dense_block.15.dense_layer.3.weight", "features.denseblock4.dense_block.15.dense_layer.3.bias", "features.denseblock4.dense_block.15.dense_layer.3.running_mean", "features.denseblock4.dense_block.15.dense_layer.3.running_var", "features.denseblock4.dense_block.15.dense_layer.5.weight", "features.norm_final.weight", "features.norm_final.bias", "features.norm_final.running_mean", "features.norm_final.running_var", "classifier.weight", "classifier.bias". 
	Unexpected key(s) in state_dict: "expert.features.0.weight", "expert.features.1.weight", "expert.features.1.bias", "expert.features.1.running_mean", "expert.features.1.running_var", "expert.features.1.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.0.weight", "expert.features.denseblock1.dense_block.0.dense_layer.0.bias", "expert.features.denseblock1.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.2.weight", "expert.features.denseblock1.dense_block.0.dense_layer.3.weight", "expert.features.denseblock1.dense_block.0.dense_layer.3.bias", "expert.features.denseblock1.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.0.dense_layer.5.weight", "expert.features.denseblock1.dense_block.1.dense_layer.0.weight", "expert.features.denseblock1.dense_block.1.dense_layer.0.bias", "expert.features.denseblock1.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.1.dense_layer.2.weight", "expert.features.denseblock1.dense_block.1.dense_layer.3.weight", "expert.features.denseblock1.dense_block.1.dense_layer.3.bias", "expert.features.denseblock1.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.1.dense_layer.5.weight", "expert.features.denseblock1.dense_block.2.dense_layer.0.weight", "expert.features.denseblock1.dense_block.2.dense_layer.0.bias", "expert.features.denseblock1.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.2.dense_layer.2.weight", "expert.features.denseblock1.dense_block.2.dense_layer.3.weight", "expert.features.denseblock1.dense_block.2.dense_layer.3.bias", "expert.features.denseblock1.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.2.dense_layer.5.weight", "expert.features.denseblock1.dense_block.3.dense_layer.0.weight", "expert.features.denseblock1.dense_block.3.dense_layer.0.bias", "expert.features.denseblock1.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.3.dense_layer.2.weight", "expert.features.denseblock1.dense_block.3.dense_layer.3.weight", "expert.features.denseblock1.dense_block.3.dense_layer.3.bias", "expert.features.denseblock1.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.3.dense_layer.5.weight", "expert.features.denseblock1.dense_block.4.dense_layer.0.weight", "expert.features.denseblock1.dense_block.4.dense_layer.0.bias", "expert.features.denseblock1.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.4.dense_layer.2.weight", "expert.features.denseblock1.dense_block.4.dense_layer.3.weight", "expert.features.denseblock1.dense_block.4.dense_layer.3.bias", "expert.features.denseblock1.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.4.dense_layer.5.weight", "expert.features.denseblock1.dense_block.5.dense_layer.0.weight", "expert.features.denseblock1.dense_block.5.dense_layer.0.bias", "expert.features.denseblock1.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock1.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock1.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock1.dense_block.5.dense_layer.2.weight", "expert.features.denseblock1.dense_block.5.dense_layer.3.weight", "expert.features.denseblock1.dense_block.5.dense_layer.3.bias", "expert.features.denseblock1.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock1.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock1.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock1.dense_block.5.dense_layer.5.weight", "expert.features.transition1.transition_layer.0.weight", "expert.features.transition1.transition_layer.0.bias", "expert.features.transition1.transition_layer.0.running_mean", "expert.features.transition1.transition_layer.0.running_var", "expert.features.transition1.transition_layer.0.num_batches_tracked", "expert.features.transition1.transition_layer.2.weight", "expert.features.denseblock2.dense_block.0.dense_layer.0.weight", "expert.features.denseblock2.dense_block.0.dense_layer.0.bias", "expert.features.denseblock2.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.0.dense_layer.2.weight", "expert.features.denseblock2.dense_block.0.dense_layer.3.weight", "expert.features.denseblock2.dense_block.0.dense_layer.3.bias", "expert.features.denseblock2.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.0.dense_layer.5.weight", "expert.features.denseblock2.dense_block.1.dense_layer.0.weight", "expert.features.denseblock2.dense_block.1.dense_layer.0.bias", "expert.features.denseblock2.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.1.dense_layer.2.weight", "expert.features.denseblock2.dense_block.1.dense_layer.3.weight", "expert.features.denseblock2.dense_block.1.dense_layer.3.bias", "expert.features.denseblock2.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.1.dense_layer.5.weight", "expert.features.denseblock2.dense_block.2.dense_layer.0.weight", "expert.features.denseblock2.dense_block.2.dense_layer.0.bias", "expert.features.denseblock2.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.2.dense_layer.2.weight", "expert.features.denseblock2.dense_block.2.dense_layer.3.weight", "expert.features.denseblock2.dense_block.2.dense_layer.3.bias", "expert.features.denseblock2.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.2.dense_layer.5.weight", "expert.features.denseblock2.dense_block.3.dense_layer.0.weight", "expert.features.denseblock2.dense_block.3.dense_layer.0.bias", "expert.features.denseblock2.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.3.dense_layer.2.weight", "expert.features.denseblock2.dense_block.3.dense_layer.3.weight", "expert.features.denseblock2.dense_block.3.dense_layer.3.bias", "expert.features.denseblock2.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.3.dense_layer.5.weight", "expert.features.denseblock2.dense_block.4.dense_layer.0.weight", "expert.features.denseblock2.dense_block.4.dense_layer.0.bias", "expert.features.denseblock2.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.4.dense_layer.2.weight", "expert.features.denseblock2.dense_block.4.dense_layer.3.weight", "expert.features.denseblock2.dense_block.4.dense_layer.3.bias", "expert.features.denseblock2.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.4.dense_layer.5.weight", "expert.features.denseblock2.dense_block.5.dense_layer.0.weight", "expert.features.denseblock2.dense_block.5.dense_layer.0.bias", "expert.features.denseblock2.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.5.dense_layer.2.weight", "expert.features.denseblock2.dense_block.5.dense_layer.3.weight", "expert.features.denseblock2.dense_block.5.dense_layer.3.bias", "expert.features.denseblock2.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.5.dense_layer.5.weight", "expert.features.denseblock2.dense_block.6.dense_layer.0.weight", "expert.features.denseblock2.dense_block.6.dense_layer.0.bias", "expert.features.denseblock2.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.6.dense_layer.2.weight", "expert.features.denseblock2.dense_block.6.dense_layer.3.weight", "expert.features.denseblock2.dense_block.6.dense_layer.3.bias", "expert.features.denseblock2.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.6.dense_layer.5.weight", "expert.features.denseblock2.dense_block.7.dense_layer.0.weight", "expert.features.denseblock2.dense_block.7.dense_layer.0.bias", "expert.features.denseblock2.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.7.dense_layer.2.weight", "expert.features.denseblock2.dense_block.7.dense_layer.3.weight", "expert.features.denseblock2.dense_block.7.dense_layer.3.bias", "expert.features.denseblock2.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.7.dense_layer.5.weight", "expert.features.denseblock2.dense_block.8.dense_layer.0.weight", "expert.features.denseblock2.dense_block.8.dense_layer.0.bias", "expert.features.denseblock2.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.8.dense_layer.2.weight", "expert.features.denseblock2.dense_block.8.dense_layer.3.weight", "expert.features.denseblock2.dense_block.8.dense_layer.3.bias", "expert.features.denseblock2.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.8.dense_layer.5.weight", "expert.features.denseblock2.dense_block.9.dense_layer.0.weight", "expert.features.denseblock2.dense_block.9.dense_layer.0.bias", "expert.features.denseblock2.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.9.dense_layer.2.weight", "expert.features.denseblock2.dense_block.9.dense_layer.3.weight", "expert.features.denseblock2.dense_block.9.dense_layer.3.bias", "expert.features.denseblock2.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.9.dense_layer.5.weight", "expert.features.denseblock2.dense_block.10.dense_layer.0.weight", "expert.features.denseblock2.dense_block.10.dense_layer.0.bias", "expert.features.denseblock2.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.10.dense_layer.2.weight", "expert.features.denseblock2.dense_block.10.dense_layer.3.weight", "expert.features.denseblock2.dense_block.10.dense_layer.3.bias", "expert.features.denseblock2.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.10.dense_layer.5.weight", "expert.features.denseblock2.dense_block.11.dense_layer.0.weight", "expert.features.denseblock2.dense_block.11.dense_layer.0.bias", "expert.features.denseblock2.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock2.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock2.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock2.dense_block.11.dense_layer.2.weight", "expert.features.denseblock2.dense_block.11.dense_layer.3.weight", "expert.features.denseblock2.dense_block.11.dense_layer.3.bias", "expert.features.denseblock2.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock2.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock2.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock2.dense_block.11.dense_layer.5.weight", "expert.features.transition2.transition_layer.0.weight", "expert.features.transition2.transition_layer.0.bias", "expert.features.transition2.transition_layer.0.running_mean", "expert.features.transition2.transition_layer.0.running_var", "expert.features.transition2.transition_layer.0.num_batches_tracked", "expert.features.transition2.transition_layer.2.weight", "expert.features.denseblock3.dense_block.0.dense_layer.0.weight", "expert.features.denseblock3.dense_block.0.dense_layer.0.bias", "expert.features.denseblock3.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.0.dense_layer.2.weight", "expert.features.denseblock3.dense_block.0.dense_layer.3.weight", "expert.features.denseblock3.dense_block.0.dense_layer.3.bias", "expert.features.denseblock3.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.0.dense_layer.5.weight", "expert.features.denseblock3.dense_block.1.dense_layer.0.weight", "expert.features.denseblock3.dense_block.1.dense_layer.0.bias", "expert.features.denseblock3.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.1.dense_layer.2.weight", "expert.features.denseblock3.dense_block.1.dense_layer.3.weight", "expert.features.denseblock3.dense_block.1.dense_layer.3.bias", "expert.features.denseblock3.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.1.dense_layer.5.weight", "expert.features.denseblock3.dense_block.2.dense_layer.0.weight", "expert.features.denseblock3.dense_block.2.dense_layer.0.bias", "expert.features.denseblock3.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.2.dense_layer.2.weight", "expert.features.denseblock3.dense_block.2.dense_layer.3.weight", "expert.features.denseblock3.dense_block.2.dense_layer.3.bias", "expert.features.denseblock3.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.2.dense_layer.5.weight", "expert.features.denseblock3.dense_block.3.dense_layer.0.weight", "expert.features.denseblock3.dense_block.3.dense_layer.0.bias", "expert.features.denseblock3.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.3.dense_layer.2.weight", "expert.features.denseblock3.dense_block.3.dense_layer.3.weight", "expert.features.denseblock3.dense_block.3.dense_layer.3.bias", "expert.features.denseblock3.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.3.dense_layer.5.weight", "expert.features.denseblock3.dense_block.4.dense_layer.0.weight", "expert.features.denseblock3.dense_block.4.dense_layer.0.bias", "expert.features.denseblock3.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.4.dense_layer.2.weight", "expert.features.denseblock3.dense_block.4.dense_layer.3.weight", "expert.features.denseblock3.dense_block.4.dense_layer.3.bias", "expert.features.denseblock3.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.4.dense_layer.5.weight", "expert.features.denseblock3.dense_block.5.dense_layer.0.weight", "expert.features.denseblock3.dense_block.5.dense_layer.0.bias", "expert.features.denseblock3.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.5.dense_layer.2.weight", "expert.features.denseblock3.dense_block.5.dense_layer.3.weight", "expert.features.denseblock3.dense_block.5.dense_layer.3.bias", "expert.features.denseblock3.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.5.dense_layer.5.weight", "expert.features.denseblock3.dense_block.6.dense_layer.0.weight", "expert.features.denseblock3.dense_block.6.dense_layer.0.bias", "expert.features.denseblock3.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.6.dense_layer.2.weight", "expert.features.denseblock3.dense_block.6.dense_layer.3.weight", "expert.features.denseblock3.dense_block.6.dense_layer.3.bias", "expert.features.denseblock3.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.6.dense_layer.5.weight", "expert.features.denseblock3.dense_block.7.dense_layer.0.weight", "expert.features.denseblock3.dense_block.7.dense_layer.0.bias", "expert.features.denseblock3.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.7.dense_layer.2.weight", "expert.features.denseblock3.dense_block.7.dense_layer.3.weight", "expert.features.denseblock3.dense_block.7.dense_layer.3.bias", "expert.features.denseblock3.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.7.dense_layer.5.weight", "expert.features.denseblock3.dense_block.8.dense_layer.0.weight", "expert.features.denseblock3.dense_block.8.dense_layer.0.bias", "expert.features.denseblock3.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.8.dense_layer.2.weight", "expert.features.denseblock3.dense_block.8.dense_layer.3.weight", "expert.features.denseblock3.dense_block.8.dense_layer.3.bias", "expert.features.denseblock3.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.8.dense_layer.5.weight", "expert.features.denseblock3.dense_block.9.dense_layer.0.weight", "expert.features.denseblock3.dense_block.9.dense_layer.0.bias", "expert.features.denseblock3.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.9.dense_layer.2.weight", "expert.features.denseblock3.dense_block.9.dense_layer.3.weight", "expert.features.denseblock3.dense_block.9.dense_layer.3.bias", "expert.features.denseblock3.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.9.dense_layer.5.weight", "expert.features.denseblock3.dense_block.10.dense_layer.0.weight", "expert.features.denseblock3.dense_block.10.dense_layer.0.bias", "expert.features.denseblock3.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.10.dense_layer.2.weight", "expert.features.denseblock3.dense_block.10.dense_layer.3.weight", "expert.features.denseblock3.dense_block.10.dense_layer.3.bias", "expert.features.denseblock3.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.10.dense_layer.5.weight", "expert.features.denseblock3.dense_block.11.dense_layer.0.weight", "expert.features.denseblock3.dense_block.11.dense_layer.0.bias", "expert.features.denseblock3.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.11.dense_layer.2.weight", "expert.features.denseblock3.dense_block.11.dense_layer.3.weight", "expert.features.denseblock3.dense_block.11.dense_layer.3.bias", "expert.features.denseblock3.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.11.dense_layer.5.weight", "expert.features.denseblock3.dense_block.12.dense_layer.0.weight", "expert.features.denseblock3.dense_block.12.dense_layer.0.bias", "expert.features.denseblock3.dense_block.12.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.12.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.12.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.12.dense_layer.2.weight", "expert.features.denseblock3.dense_block.12.dense_layer.3.weight", "expert.features.denseblock3.dense_block.12.dense_layer.3.bias", "expert.features.denseblock3.dense_block.12.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.12.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.12.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.12.dense_layer.5.weight", "expert.features.denseblock3.dense_block.13.dense_layer.0.weight", "expert.features.denseblock3.dense_block.13.dense_layer.0.bias", "expert.features.denseblock3.dense_block.13.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.13.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.13.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.13.dense_layer.2.weight", "expert.features.denseblock3.dense_block.13.dense_layer.3.weight", "expert.features.denseblock3.dense_block.13.dense_layer.3.bias", "expert.features.denseblock3.dense_block.13.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.13.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.13.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.13.dense_layer.5.weight", "expert.features.denseblock3.dense_block.14.dense_layer.0.weight", "expert.features.denseblock3.dense_block.14.dense_layer.0.bias", "expert.features.denseblock3.dense_block.14.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.14.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.14.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.14.dense_layer.2.weight", "expert.features.denseblock3.dense_block.14.dense_layer.3.weight", "expert.features.denseblock3.dense_block.14.dense_layer.3.bias", "expert.features.denseblock3.dense_block.14.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.14.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.14.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.14.dense_layer.5.weight", "expert.features.denseblock3.dense_block.15.dense_layer.0.weight", "expert.features.denseblock3.dense_block.15.dense_layer.0.bias", "expert.features.denseblock3.dense_block.15.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.15.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.15.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.15.dense_layer.2.weight", "expert.features.denseblock3.dense_block.15.dense_layer.3.weight", "expert.features.denseblock3.dense_block.15.dense_layer.3.bias", "expert.features.denseblock3.dense_block.15.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.15.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.15.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.15.dense_layer.5.weight", "expert.features.denseblock3.dense_block.16.dense_layer.0.weight", "expert.features.denseblock3.dense_block.16.dense_layer.0.bias", "expert.features.denseblock3.dense_block.16.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.16.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.16.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.16.dense_layer.2.weight", "expert.features.denseblock3.dense_block.16.dense_layer.3.weight", "expert.features.denseblock3.dense_block.16.dense_layer.3.bias", "expert.features.denseblock3.dense_block.16.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.16.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.16.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.16.dense_layer.5.weight", "expert.features.denseblock3.dense_block.17.dense_layer.0.weight", "expert.features.denseblock3.dense_block.17.dense_layer.0.bias", "expert.features.denseblock3.dense_block.17.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.17.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.17.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.17.dense_layer.2.weight", "expert.features.denseblock3.dense_block.17.dense_layer.3.weight", "expert.features.denseblock3.dense_block.17.dense_layer.3.bias", "expert.features.denseblock3.dense_block.17.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.17.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.17.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.17.dense_layer.5.weight", "expert.features.denseblock3.dense_block.18.dense_layer.0.weight", "expert.features.denseblock3.dense_block.18.dense_layer.0.bias", "expert.features.denseblock3.dense_block.18.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.18.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.18.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.18.dense_layer.2.weight", "expert.features.denseblock3.dense_block.18.dense_layer.3.weight", "expert.features.denseblock3.dense_block.18.dense_layer.3.bias", "expert.features.denseblock3.dense_block.18.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.18.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.18.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.18.dense_layer.5.weight", "expert.features.denseblock3.dense_block.19.dense_layer.0.weight", "expert.features.denseblock3.dense_block.19.dense_layer.0.bias", "expert.features.denseblock3.dense_block.19.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.19.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.19.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.19.dense_layer.2.weight", "expert.features.denseblock3.dense_block.19.dense_layer.3.weight", "expert.features.denseblock3.dense_block.19.dense_layer.3.bias", "expert.features.denseblock3.dense_block.19.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.19.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.19.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.19.dense_layer.5.weight", "expert.features.denseblock3.dense_block.20.dense_layer.0.weight", "expert.features.denseblock3.dense_block.20.dense_layer.0.bias", "expert.features.denseblock3.dense_block.20.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.20.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.20.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.20.dense_layer.2.weight", "expert.features.denseblock3.dense_block.20.dense_layer.3.weight", "expert.features.denseblock3.dense_block.20.dense_layer.3.bias", "expert.features.denseblock3.dense_block.20.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.20.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.20.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.20.dense_layer.5.weight", "expert.features.denseblock3.dense_block.21.dense_layer.0.weight", "expert.features.denseblock3.dense_block.21.dense_layer.0.bias", "expert.features.denseblock3.dense_block.21.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.21.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.21.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.21.dense_layer.2.weight", "expert.features.denseblock3.dense_block.21.dense_layer.3.weight", "expert.features.denseblock3.dense_block.21.dense_layer.3.bias", "expert.features.denseblock3.dense_block.21.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.21.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.21.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.21.dense_layer.5.weight", "expert.features.denseblock3.dense_block.22.dense_layer.0.weight", "expert.features.denseblock3.dense_block.22.dense_layer.0.bias", "expert.features.denseblock3.dense_block.22.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.22.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.22.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.22.dense_layer.2.weight", "expert.features.denseblock3.dense_block.22.dense_layer.3.weight", "expert.features.denseblock3.dense_block.22.dense_layer.3.bias", "expert.features.denseblock3.dense_block.22.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.22.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.22.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.22.dense_layer.5.weight", "expert.features.denseblock3.dense_block.23.dense_layer.0.weight", "expert.features.denseblock3.dense_block.23.dense_layer.0.bias", "expert.features.denseblock3.dense_block.23.dense_layer.0.running_mean", "expert.features.denseblock3.dense_block.23.dense_layer.0.running_var", "expert.features.denseblock3.dense_block.23.dense_layer.0.num_batches_tracked", "expert.features.denseblock3.dense_block.23.dense_layer.2.weight", "expert.features.denseblock3.dense_block.23.dense_layer.3.weight", "expert.features.denseblock3.dense_block.23.dense_layer.3.bias", "expert.features.denseblock3.dense_block.23.dense_layer.3.running_mean", "expert.features.denseblock3.dense_block.23.dense_layer.3.running_var", "expert.features.denseblock3.dense_block.23.dense_layer.3.num_batches_tracked", "expert.features.denseblock3.dense_block.23.dense_layer.5.weight", "expert.features.transition3.transition_layer.0.weight", "expert.features.transition3.transition_layer.0.bias", "expert.features.transition3.transition_layer.0.running_mean", "expert.features.transition3.transition_layer.0.running_var", "expert.features.transition3.transition_layer.0.num_batches_tracked", "expert.features.transition3.transition_layer.2.weight", "expert.features.denseblock4.dense_block.0.dense_layer.0.weight", "expert.features.denseblock4.dense_block.0.dense_layer.0.bias", "expert.features.denseblock4.dense_block.0.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.0.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.0.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.0.dense_layer.2.weight", "expert.features.denseblock4.dense_block.0.dense_layer.3.weight", "expert.features.denseblock4.dense_block.0.dense_layer.3.bias", "expert.features.denseblock4.dense_block.0.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.0.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.0.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.0.dense_layer.5.weight", "expert.features.denseblock4.dense_block.1.dense_layer.0.weight", "expert.features.denseblock4.dense_block.1.dense_layer.0.bias", "expert.features.denseblock4.dense_block.1.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.1.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.1.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.1.dense_layer.2.weight", "expert.features.denseblock4.dense_block.1.dense_layer.3.weight", "expert.features.denseblock4.dense_block.1.dense_layer.3.bias", "expert.features.denseblock4.dense_block.1.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.1.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.1.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.1.dense_layer.5.weight", "expert.features.denseblock4.dense_block.2.dense_layer.0.weight", "expert.features.denseblock4.dense_block.2.dense_layer.0.bias", "expert.features.denseblock4.dense_block.2.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.2.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.2.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.2.dense_layer.2.weight", "expert.features.denseblock4.dense_block.2.dense_layer.3.weight", "expert.features.denseblock4.dense_block.2.dense_layer.3.bias", "expert.features.denseblock4.dense_block.2.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.2.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.2.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.2.dense_layer.5.weight", "expert.features.denseblock4.dense_block.3.dense_layer.0.weight", "expert.features.denseblock4.dense_block.3.dense_layer.0.bias", "expert.features.denseblock4.dense_block.3.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.3.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.3.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.3.dense_layer.2.weight", "expert.features.denseblock4.dense_block.3.dense_layer.3.weight", "expert.features.denseblock4.dense_block.3.dense_layer.3.bias", "expert.features.denseblock4.dense_block.3.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.3.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.3.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.3.dense_layer.5.weight", "expert.features.denseblock4.dense_block.4.dense_layer.0.weight", "expert.features.denseblock4.dense_block.4.dense_layer.0.bias", "expert.features.denseblock4.dense_block.4.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.4.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.4.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.4.dense_layer.2.weight", "expert.features.denseblock4.dense_block.4.dense_layer.3.weight", "expert.features.denseblock4.dense_block.4.dense_layer.3.bias", "expert.features.denseblock4.dense_block.4.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.4.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.4.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.4.dense_layer.5.weight", "expert.features.denseblock4.dense_block.5.dense_layer.0.weight", "expert.features.denseblock4.dense_block.5.dense_layer.0.bias", "expert.features.denseblock4.dense_block.5.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.5.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.5.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.5.dense_layer.2.weight", "expert.features.denseblock4.dense_block.5.dense_layer.3.weight", "expert.features.denseblock4.dense_block.5.dense_layer.3.bias", "expert.features.denseblock4.dense_block.5.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.5.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.5.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.5.dense_layer.5.weight", "expert.features.denseblock4.dense_block.6.dense_layer.0.weight", "expert.features.denseblock4.dense_block.6.dense_layer.0.bias", "expert.features.denseblock4.dense_block.6.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.6.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.6.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.6.dense_layer.2.weight", "expert.features.denseblock4.dense_block.6.dense_layer.3.weight", "expert.features.denseblock4.dense_block.6.dense_layer.3.bias", "expert.features.denseblock4.dense_block.6.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.6.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.6.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.6.dense_layer.5.weight", "expert.features.denseblock4.dense_block.7.dense_layer.0.weight", "expert.features.denseblock4.dense_block.7.dense_layer.0.bias", "expert.features.denseblock4.dense_block.7.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.7.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.7.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.7.dense_layer.2.weight", "expert.features.denseblock4.dense_block.7.dense_layer.3.weight", "expert.features.denseblock4.dense_block.7.dense_layer.3.bias", "expert.features.denseblock4.dense_block.7.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.7.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.7.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.7.dense_layer.5.weight", "expert.features.denseblock4.dense_block.8.dense_layer.0.weight", "expert.features.denseblock4.dense_block.8.dense_layer.0.bias", "expert.features.denseblock4.dense_block.8.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.8.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.8.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.8.dense_layer.2.weight", "expert.features.denseblock4.dense_block.8.dense_layer.3.weight", "expert.features.denseblock4.dense_block.8.dense_layer.3.bias", "expert.features.denseblock4.dense_block.8.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.8.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.8.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.8.dense_layer.5.weight", "expert.features.denseblock4.dense_block.9.dense_layer.0.weight", "expert.features.denseblock4.dense_block.9.dense_layer.0.bias", "expert.features.denseblock4.dense_block.9.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.9.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.9.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.9.dense_layer.2.weight", "expert.features.denseblock4.dense_block.9.dense_layer.3.weight", "expert.features.denseblock4.dense_block.9.dense_layer.3.bias", "expert.features.denseblock4.dense_block.9.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.9.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.9.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.9.dense_layer.5.weight", "expert.features.denseblock4.dense_block.10.dense_layer.0.weight", "expert.features.denseblock4.dense_block.10.dense_layer.0.bias", "expert.features.denseblock4.dense_block.10.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.10.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.10.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.10.dense_layer.2.weight", "expert.features.denseblock4.dense_block.10.dense_layer.3.weight", "expert.features.denseblock4.dense_block.10.dense_layer.3.bias", "expert.features.denseblock4.dense_block.10.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.10.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.10.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.10.dense_layer.5.weight", "expert.features.denseblock4.dense_block.11.dense_layer.0.weight", "expert.features.denseblock4.dense_block.11.dense_layer.0.bias", "expert.features.denseblock4.dense_block.11.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.11.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.11.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.11.dense_layer.2.weight", "expert.features.denseblock4.dense_block.11.dense_layer.3.weight", "expert.features.denseblock4.dense_block.11.dense_layer.3.bias", "expert.features.denseblock4.dense_block.11.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.11.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.11.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.11.dense_layer.5.weight", "expert.features.denseblock4.dense_block.12.dense_layer.0.weight", "expert.features.denseblock4.dense_block.12.dense_layer.0.bias", "expert.features.denseblock4.dense_block.12.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.12.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.12.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.12.dense_layer.2.weight", "expert.features.denseblock4.dense_block.12.dense_layer.3.weight", "expert.features.denseblock4.dense_block.12.dense_layer.3.bias", "expert.features.denseblock4.dense_block.12.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.12.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.12.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.12.dense_layer.5.weight", "expert.features.denseblock4.dense_block.13.dense_layer.0.weight", "expert.features.denseblock4.dense_block.13.dense_layer.0.bias", "expert.features.denseblock4.dense_block.13.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.13.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.13.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.13.dense_layer.2.weight", "expert.features.denseblock4.dense_block.13.dense_layer.3.weight", "expert.features.denseblock4.dense_block.13.dense_layer.3.bias", "expert.features.denseblock4.dense_block.13.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.13.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.13.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.13.dense_layer.5.weight", "expert.features.denseblock4.dense_block.14.dense_layer.0.weight", "expert.features.denseblock4.dense_block.14.dense_layer.0.bias", "expert.features.denseblock4.dense_block.14.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.14.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.14.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.14.dense_layer.2.weight", "expert.features.denseblock4.dense_block.14.dense_layer.3.weight", "expert.features.denseblock4.dense_block.14.dense_layer.3.bias", "expert.features.denseblock4.dense_block.14.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.14.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.14.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.14.dense_layer.5.weight", "expert.features.denseblock4.dense_block.15.dense_layer.0.weight", "expert.features.denseblock4.dense_block.15.dense_layer.0.bias", "expert.features.denseblock4.dense_block.15.dense_layer.0.running_mean", "expert.features.denseblock4.dense_block.15.dense_layer.0.running_var", "expert.features.denseblock4.dense_block.15.dense_layer.0.num_batches_tracked", "expert.features.denseblock4.dense_block.15.dense_layer.2.weight", "expert.features.denseblock4.dense_block.15.dense_layer.3.weight", "expert.features.denseblock4.dense_block.15.dense_layer.3.bias", "expert.features.denseblock4.dense_block.15.dense_layer.3.running_mean", "expert.features.denseblock4.dense_block.15.dense_layer.3.running_var", "expert.features.denseblock4.dense_block.15.dense_layer.3.num_batches_tracked", "expert.features.denseblock4.dense_block.15.dense_layer.5.weight", "expert.features.norm_final.weight", "expert.features.norm_final.bias", "expert.features.norm_final.running_mean", "expert.features.norm_final.running_var", "expert.features.norm_final.num_batches_tracked", "expert.classifier.weight", "expert.classifier.bias". 

============================================================
POST-TRAINING: Gaussian Noise Robustness
============================================================

Testing Expert 0 (POST-TRAINING) under Gaussian noise...

Testing Expert 1 (POST-TRAINING) under Gaussian noise...

Testing Expert 2 (POST-TRAINING) under Gaussian noise...

Testing Expert 3 (POST-TRAINING) under Gaussian noise...

Testing Trained Fusion Model under Gaussian noise...

============================================================
POST-TRAINING: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 30.14% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.27% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.49% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 43.68% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.62% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 63.00% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 55.07% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 42.06% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.40% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.00% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 50.58% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.34% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 45.02% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.49% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 45.09% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 14.86% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.86% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.62% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.92% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.38% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.96% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 76.63% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 76.61% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.20% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 33.27% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 17.22% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 77.02% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.73% accuracy

Testing Expert 1 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 35.30% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 17.88% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.09% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 13.28% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 59.49% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 35.70% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 57.53% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 46.70% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 73.68% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 73.49% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.68% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 21.92% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 49.81% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 21.26% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 49.36% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 19.61% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.37% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.89% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 73.70% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 73.12% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 73.87% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 73.47% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 72.70% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 71.27% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 28.88% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 14.12% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 73.80% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 73.66% accuracy

Testing Expert 2 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 45.31% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 27.40% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 3.56% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 32.53% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 71.33% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 56.18% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 65.54% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 55.76% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 79.55% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 79.08% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.11% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.89% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 57.46% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 27.96% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 58.42% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 28.24% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 10.81% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.16% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 79.43% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 79.16% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 79.29% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 79.16% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 78.72% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 77.96% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 41.76% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.58% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 79.47% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 79.25% accuracy

Testing Expert 3 (POST-TRAINING) on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 54.05% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 36.74% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.34% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 37.49% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.23% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 60.46% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.39% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 61.48% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.82% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.09% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 37.53% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 12.91% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 63.10% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.85% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 63.58% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 38.61% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 14.03% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.82% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 77.70% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.94% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 77.95% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.78% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 77.01% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.21% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 50.36% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 40.00% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 77.73% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 77.63% accuracy

Testing Trained Fusion Model on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 48.54% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 28.22% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.57% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 40.22% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 75.16% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 63.12% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.47% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 58.33% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 80.70% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 80.65% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 48.53% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.17% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 60.79% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 29.95% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 61.51% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 30.03% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 10.23% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.18% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 80.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 79.94% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 80.48% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 80.25% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 80.02% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 79.38% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 44.19% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 26.95% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 80.58% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 80.49% accuracy

============================================================
POST-TRAINING: Out-of-Distribution Detection
============================================================

Testing Expert 0 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 1 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 2 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Expert 3 (POST-TRAINING) on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

Testing Trained Fusion Model on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...

âœ… POST-TRAINING evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicative_alpha_5.0_post_training_evaluation.csv

================================================================================
PHASE 4: COMPREHENSIVE ROBUSTNESS EVALUATION (Î±=5.0)
================================================================================

ðŸ” Running comprehensive robustness evaluation...

================================================================================
Starting Phase 1, 2 & 3 Robustness Evaluation for DenseNet multiplicative (Î±=5.0)
================================================================================
ðŸ“Š OOD evaluation CSV created: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/ood_evaluation_multiplicative_alpha_5.0_20250902_183947.csv

Loading baseline DenseNet model from: ../../expert_training/scripts/checkpoints_expert_full_dataset_benchmark_250/best_full_dataset_densenet121_benchmark_250.pth
/home/ali.rasekh/orm/hos/geom/Fianl_MCN/fusion_training/scripts/train_densenet_fusions.py:95: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path, map_location=device)
Files already downloaded and verified

============================================================
GAUSSIAN NOISE ROBUSTNESS
============================================================
Evaluating sigmas: [0.0, 0.05, 0.1, 0.2, 0.3]

Testing Expert 0 under Gaussian noise...
  Expert 0 noise results: Ïƒ=0.0: 77.17%, Ïƒ=0.05: 69.55%, Ïƒ=0.1: 49.62%, Ïƒ=0.2: 17.51%, Ïƒ=0.3: 7.32%

Testing Expert 1 under Gaussian noise...
  Expert 1 noise results: Ïƒ=0.0: 73.98%, Ïƒ=0.05: 68.38%, Ïƒ=0.1: 52.13%, Ïƒ=0.2: 21.21%, Ïƒ=0.3: 8.26%

Testing Expert 2 under Gaussian noise...
  Expert 2 noise results: Ïƒ=0.0: 79.53%, Ïƒ=0.05: 74.86%, Ïƒ=0.1: 61.57%, Ïƒ=0.2: 31.54%, Ïƒ=0.3: 16.33%

Testing Expert 3 under Gaussian noise...
  Expert 3 noise results: Ïƒ=0.0: 77.98%, Ïƒ=0.05: 73.63%, Ïƒ=0.1: 65.14%, Ïƒ=0.2: 41.91%, Ïƒ=0.3: 22.33%

Testing Baseline DenseNet under Gaussian noise...
  Baseline noise results: Ïƒ=0.0: 83.69%, Ïƒ=0.05: 76.60%, Ïƒ=0.1: 56.68%, Ïƒ=0.2: 28.13%, Ïƒ=0.3: 16.19%

Testing Global Fusion Model under Gaussian noise...
  Fusion noise results: Ïƒ=0.0: 80.45%, Ïƒ=0.05: 76.59%, Ïƒ=0.1: 63.71%, Ïƒ=0.2: 33.93%, Ïƒ=0.3: 16.52%

============================================================
PHASE 1: CIFAR-100-C Corruption Robustness
============================================================

Testing Expert 0 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 30.55% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 14.55% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 5.22% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 44.49% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.26% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 62.36% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 55.26% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 41.97% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.40% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.00% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 50.58% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 19.34% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 45.93% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 16.53% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 44.80% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 14.63% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 4.72% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.66% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 76.92% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.38% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 76.96% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 76.63% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 76.48% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 75.83% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 33.27% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 17.22% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 76.93% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 76.89% accuracy
  Expert 0 Average Corruption Accuracy: 47.96%

Testing Expert 1 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 35.43% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 18.49% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 2.21% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 12.88% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 59.48% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 36.44% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 57.16% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 46.60% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 73.68% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 73.49% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 53.68% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 21.92% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 49.93% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 21.32% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 50.03% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 19.51% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 5.55% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 1.77% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 73.70% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 73.12% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 73.87% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 73.47% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 72.72% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 71.39% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 28.88% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 14.12% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 73.91% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 73.96% accuracy
  Expert 1 Average Corruption Accuracy: 45.31%

Testing Expert 2 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 45.71% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 26.94% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 3.35% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 32.72% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 70.85% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 55.67% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 64.93% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 55.89% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 79.55% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 79.08% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 49.11% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.89% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 57.88% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 27.72% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 58.41% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 28.52% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 10.49% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.30% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 79.43% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 79.16% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 79.29% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 79.16% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 78.65% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 77.68% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 41.76% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.58% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 79.37% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 79.25% accuracy
  Expert 2 Average Corruption Accuracy: 52.30%

Testing Expert 3 on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 54.34% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 36.97% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.37% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 38.02% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 72.21% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 60.53% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.49% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 61.73% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 77.82% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 77.09% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 37.53% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 12.91% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 63.23% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 37.74% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 63.66% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 38.69% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 14.13% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.96% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 77.70% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 76.94% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 77.95% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 77.78% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 77.25% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 76.21% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 50.36% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 40.00% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 78.07% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 77.71% accuracy
  Expert 3 Average Corruption Accuracy: 54.69%

Testing Baseline DenseNet on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 39.55% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 24.39% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 10.21% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 51.89% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 78.72% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 69.04% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 61.51% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 50.04% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 83.25% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 82.94% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 60.76% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 25.22% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 51.94% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 24.15% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 52.47% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 24.28% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 11.41% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 3.49% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 83.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 83.18% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 83.41% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 83.32% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 83.19% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 82.54% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 43.60% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 21.61% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 83.55% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 83.61% accuracy
  Baseline DenseNet Average Corruption Accuracy: 54.88%

Testing Global Fusion Model on corruptions...
  Testing gaussian_noise at severity 1...
Files already downloaded and verified
    gaussian_noise severity 1: 48.81% accuracy
  Testing gaussian_noise at severity 2...
Files already downloaded and verified
    gaussian_noise severity 2: 28.97% accuracy
  Testing shot_noise at severity 1...
Files already downloaded and verified
    shot_noise severity 1: 4.35% accuracy
  Testing shot_noise at severity 2...
Files already downloaded and verified
    shot_noise severity 2: 40.53% accuracy
  Testing impulse_noise at severity 1...
Files already downloaded and verified
    impulse_noise severity 1: 74.79% accuracy
  Testing impulse_noise at severity 2...
Files already downloaded and verified
    impulse_noise severity 2: 63.64% accuracy
  Testing defocus_blur at severity 1...
Files already downloaded and verified
    defocus_blur severity 1: 67.10% accuracy
  Testing defocus_blur at severity 2...
Files already downloaded and verified
    defocus_blur severity 2: 58.63% accuracy
  Testing motion_blur at severity 1...
Files already downloaded and verified
    motion_blur severity 1: 80.70% accuracy
  Testing motion_blur at severity 2...
Files already downloaded and verified
    motion_blur severity 2: 80.65% accuracy
  Testing zoom_blur at severity 1...
Files already downloaded and verified
    zoom_blur severity 1: 48.53% accuracy
  Testing zoom_blur at severity 2...
Files already downloaded and verified
    zoom_blur severity 2: 18.17% accuracy
  Testing snow at severity 1...
Files already downloaded and verified
    snow severity 1: 60.78% accuracy
  Testing snow at severity 2...
Files already downloaded and verified
    snow severity 2: 29.88% accuracy
  Testing frost at severity 1...
Files already downloaded and verified
    frost severity 1: 61.32% accuracy
  Testing frost at severity 2...
Files already downloaded and verified
    frost severity 2: 30.76% accuracy
  Testing fog at severity 1...
Files already downloaded and verified
    fog severity 1: 10.08% accuracy
  Testing fog at severity 2...
Files already downloaded and verified
    fog severity 2: 2.99% accuracy
  Testing brightness at severity 1...
Files already downloaded and verified
    brightness severity 1: 80.44% accuracy
  Testing brightness at severity 2...
Files already downloaded and verified
    brightness severity 2: 79.94% accuracy
  Testing contrast at severity 1...
Files already downloaded and verified
    contrast severity 1: 80.48% accuracy
  Testing contrast at severity 2...
Files already downloaded and verified
    contrast severity 2: 80.25% accuracy
  Testing elastic_transform at severity 1...
Files already downloaded and verified
    elastic_transform severity 1: 80.08% accuracy
  Testing elastic_transform at severity 2...
Files already downloaded and verified
    elastic_transform severity 2: 79.44% accuracy
  Testing pixelate at severity 1...
Files already downloaded and verified
    pixelate severity 1: 44.19% accuracy
  Testing pixelate at severity 2...
Files already downloaded and verified
    pixelate severity 2: 26.95% accuracy
  Testing jpeg_compression at severity 1...
Files already downloaded and verified
    jpeg_compression severity 1: 80.82% accuracy
  Testing jpeg_compression at severity 2...
Files already downloaded and verified
    jpeg_compression severity 2: 80.48% accuracy
  Global Fusion Model Average Corruption Accuracy: 54.42%

============================================================
PHASE 3: Out-of-Distribution Detection
============================================================

4. OOD Detection Evaluation
------------------------------------------------------------

Testing Expert 0 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 0 OOD Results:
    Expert 0 OOD (cifar10): AUROC=0.7076, AUPR=0.6924, FPR95=0.8656
    Expert 0 OOD (svhn): AUROC=0.7939, AUPR=0.8970, FPR95=0.7264
    Expert 0 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 0 OOD (synthetic_gaussian): AUROC=0.8942, AUPR=0.8884, FPR95=0.4960
    Expert 0 OOD (synthetic_uniform): AUROC=0.8732, AUPR=0.8479, FPR95=0.4747

Testing Expert 1 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 1 OOD Results:
    Expert 1 OOD (cifar10): AUROC=0.7046, AUPR=0.6808, FPR95=0.8271
    Expert 1 OOD (svhn): AUROC=0.7767, AUPR=0.8846, FPR95=0.6384
    Expert 1 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 1 OOD (synthetic_gaussian): AUROC=0.9923, AUPR=0.9909, FPR95=0.0318
    Expert 1 OOD (synthetic_uniform): AUROC=0.9944, AUPR=0.9935, FPR95=0.0236

Testing Expert 2 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 2 OOD Results:
    Expert 2 OOD (cifar10): AUROC=0.6836, AUPR=0.6869, FPR95=0.9014
    Expert 2 OOD (svhn): AUROC=0.6301, AUPR=0.8234, FPR95=0.9273
    Expert 2 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 2 OOD (synthetic_gaussian): AUROC=0.6751, AUPR=0.6002, FPR95=0.7671
    Expert 2 OOD (synthetic_uniform): AUROC=0.6643, AUPR=0.5892, FPR95=0.7809

Testing Expert 3 on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Expert 3 OOD Results:
    Expert 3 OOD (cifar10): AUROC=0.7733, AUPR=0.7359, FPR95=0.6708
    Expert 3 OOD (svhn): AUROC=0.8077, AUPR=0.8898, FPR95=0.5801
    Expert 3 OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Expert 3 OOD (synthetic_gaussian): AUROC=0.7841, AUPR=0.6770, FPR95=0.4738
    Expert 3 OOD (synthetic_uniform): AUROC=0.5774, AUPR=0.4939, FPR95=0.6946

Testing Baseline DenseNet on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Baseline DenseNet OOD Results:
    Baseline DenseNet OOD (cifar10): AUROC=0.6751, AUPR=0.7001, FPR95=0.9430
    Baseline DenseNet OOD (svhn): AUROC=0.8385, AUPR=0.9338, FPR95=0.7609
    Baseline DenseNet OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Baseline DenseNet OOD (synthetic_gaussian): AUROC=0.8120, AUPR=0.7160, FPR95=0.4964
    Baseline DenseNet OOD (synthetic_uniform): AUROC=0.6909, AUPR=0.6073, FPR95=0.7263

Testing Global Fusion Model on OOD detection...
    Computing in-distribution scores...
    Testing on CIFAR-10...
Files already downloaded and verified
    Testing on SVHN...
Using downloaded and verified file: ../data/test_32x32.mat
    Testing on TinyImageNet...
    Testing on synthetic Gaussian noise...
    Testing on synthetic uniform noise...
  Global Fusion Model OOD Results:
    Fusion Model OOD (cifar10): AUROC=0.6106, AUPR=0.6206, FPR95=0.9205
    Fusion Model OOD (svhn): AUROC=0.7052, AUPR=0.8502, FPR95=0.8623
    Fusion Model OOD (tinyimagenet): AUROC=0.7500, AUPR=0.7000, FPR95=0.2500
    Fusion Model OOD (synthetic_gaussian): AUROC=0.9865, AUPR=0.9769, FPR95=0.0444
    Fusion Model OOD (synthetic_uniform): AUROC=0.9952, AUPR=0.9914, FPR95=0.0151

âœ… Robustness evaluation completed!
   Results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/csv_logs/densenet_fusions/densenet_multiplicative_alpha_5.0_robustness_evaluation.csv
   OOD results saved to: ../fusion_checkpoints_mixed_alpha_ablation_full_eval/dn1_rn0_wrn0_rx0/ood_evaluation_multiplicative_alpha_5.0_20250902_183947.csv
   Model types tested: Experts, Baseline, Global Fusion Model
   Test types: CIFAR-100-C corruptions + OOD detection + Gaussian noise
âœ… Experiment 3 completed: MIXED multiplicative fusion, alpha=5.0 (Alpha Ablation Full Eval)
